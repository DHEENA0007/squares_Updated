import{y as t,t as e}from"./index-CV77Hym3.js";const r=new class{baseUrl="https://api.buildhomemartsquares.com/api";async makeRequest(e,r={}){const s=`${this.baseUrl}${e}`,i={headers:{"Content-Type":"application/json",...r.headers},...r},c=t.getToken();c&&(i.headers={...i.headers,Authorization:`Bearer ${c}`});try{const e=await fetch(s,i);if(!e.ok){if(401===e.status)throw t.logout(),window.location.href="/v2/login",new Error("Authentication required");if(403===e.status)throw new Error("Admin access required");const r=await e.json().catch(()=>({success:!1,message:`HTTP ${e.status}: ${e.statusText}`}));throw new Error(r.message||"An error occurred")}return await e.json()}catch(n){throw n}}async getSubscriptions(t={}){try{const e=new URLSearchParams;Object.entries(t).forEach(([t,r])=>{null!=r&&""!==r&&e.append(t,String(r))});const r="/subscriptions"+(e.toString()?`?${e.toString()}`:"");return await this.makeRequest(r)}catch(r){const t=r instanceof Error?r.message:"Failed to fetch subscriptions";throw e({title:"Error",description:t,variant:"destructive"}),r}}async getSubscription(t){try{return await this.makeRequest(`/subscriptions/${t}`)}catch(r){const t=r instanceof Error?r.message:"Failed to fetch subscription";throw e({title:"Error",description:t,variant:"destructive"}),r}}async createSubscription(t){try{const r=await this.makeRequest("/subscriptions",{method:"POST",body:JSON.stringify(t)});return e({title:"Success",description:"Subscription created successfully!"}),r}catch(r){const t=r instanceof Error?r.message:"Failed to create subscription";throw e({title:"Error",description:t,variant:"destructive"}),r}}async updateSubscription(t,r){try{const s=await this.makeRequest(`/subscriptions/${t}`,{method:"PUT",body:JSON.stringify(r)});return e({title:"Success",description:"Subscription updated successfully!"}),s}catch(s){const t=s instanceof Error?s.message:"Failed to update subscription";throw e({title:"Error",description:t,variant:"destructive"}),s}}async cancelSubscription(t){try{const r=await this.makeRequest(`/subscriptions/${t}/cancel`,{method:"PATCH"});return e({title:"Success",description:"Subscription cancelled successfully!"}),r}catch(r){const t=r instanceof Error?r.message:"Failed to cancel subscription";throw e({title:"Error",description:t,variant:"destructive"}),r}}async renewSubscription(t){try{const r=await this.makeRequest(`/subscriptions/${t}/renew`,{method:"PATCH"});return e({title:"Success",description:"Subscription renewed successfully!"}),r}catch(r){const t=r instanceof Error?r.message:"Failed to renew subscription";throw e({title:"Error",description:t,variant:"destructive"}),r}}async getSubscriptionStats(){try{return await this.makeRequest("/subscriptions/stats")}catch(t){const r=t instanceof Error?t.message:"Failed to fetch subscription statistics";throw e({title:"Error",description:r,variant:"destructive"}),t}}formatSubscriptionStatus(t){return{active:{label:"Active",color:"green"},cancelled:{label:"Cancelled",color:"red"},expired:{label:"Expired",color:"orange"},pending:{label:"Pending",color:"blue"}}[t]||{label:t,color:"gray"}}formatAmount(t){return`${"INR"===t.currency?"₹":"USD"===t.currency?"$":"€"}${t.amount.toLocaleString()}`}isSubscriptionExpiringSoon(t,e=7){const r=new Date(t.endDate),s=new Date,i=Math.ceil((r.getTime()-s.getTime())/864e5);return i<=e&&i>0}getDaysUntilExpiry(t){const e=new Date(t.endDate),r=new Date;return Math.ceil((e.getTime()-r.getTime())/864e5)}};export{r as s};
