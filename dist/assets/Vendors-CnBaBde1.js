import{j as e}from"./ui-s1SEoZIF.js";import{u as s,a5 as t,D as a,J as l,a as n,b as i,c as r,R as d,e as c,o,U as x,C as m,a1 as p,d as h,f as j,E as u,B as f,a0 as N}from"./index-l5vY_naC.js";import{d as v,r as w}from"./router-D8v2YSKU.js";import"./vendor-BxThA0WO.js";const g="https://app.buildhomemartsquares.com/api",b=()=>{const{user:b}=s(),y=v(),{toast:A}=t(),V=b?.rolePermissions||[],[R,E]=w.useState(!0),[S,D]=w.useState({total:0,pending:0,approved:0,rejected:0,underReview:0}),[P,C]=w.useState([]),_=e=>V.includes(e);w.useEffect(()=>{_(N.VENDORS_VIEW)?B():y("/rolebased")},[V]);const B=async()=>{try{E(!0);await a.getCurrentUser();const e=localStorage.getItem("token"),s=await fetch(`${g}/admin/vendor-approval-stats`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(s.ok){const e=(await s.json()).data.overview;D({total:e.totalApplications||0,pending:e.pendingApplications||0,approved:e.approvedApplications||0,rejected:e.rejectedApplications||0,underReview:e.underReviewApplications||0})}const t=await fetch(`${g}/admin/vendor-approvals?limit=50&status=all`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(t.ok){const e=await t.json();C(e.data.vendors||[])}}catch(e){A({title:"Error",description:"Failed to load vendor data",variant:"destructive"})}finally{E(!1)}},I=s=>{const t={pending:{variant:"outline",label:"Pending"},under_review:{variant:"secondary",label:"Under Review"},approved:{variant:"default",label:"Approved"},rejected:{variant:"destructive",label:"Rejected"}},a=t[s]||t.pending;return e.jsx(f,{variant:a.variant,children:a.label})};return _(N.VENDORS_VIEW)?R?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(l,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2 text-lg",children:"Loading vendor data..."})]}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Vendor Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage vendor applications and approvals"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs(n,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(r,{className:"text-sm font-medium",children:"Total Applications"}),e.jsx(d,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:S.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total vendor applications"})]})]}),e.jsxs(n,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(r,{className:"text-sm font-medium",children:"Pending Approvals"}),e.jsx(o,{className:"h-4 w-4 text-yellow-600"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:S.pending}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting review"})]})]}),e.jsxs(n,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(r,{className:"text-sm font-medium",children:"Under Review"}),e.jsx(x,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:S.underReview}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Being reviewed"})]})]}),e.jsxs(n,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(r,{className:"text-sm font-medium",children:"Approved Vendors"}),e.jsx(m,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:S.approved}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active vendors"})]})]}),e.jsxs(n,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(r,{className:"text-sm font-medium",children:"Rejected"}),e.jsx(p,{className:"h-4 w-4 text-red-600"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:S.rejected}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Declined applications"})]})]})]}),e.jsxs(n,{children:[e.jsxs(i,{children:[e.jsx(r,{children:"Vendor Applications"}),e.jsx(h,{children:"View and manage vendor applications"})]}),e.jsx(c,{children:0===P.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(d,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"No Vendor Applications"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"There are no vendor applications at the moment"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-4",children:["Your permissions: ",_(N.VENDORS_APPROVE)?"View & Approve":"View Only"]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-4 font-medium",children:"Business Name"}),e.jsx("th",{className:"text-left p-4 font-medium",children:"Contact Person"}),e.jsx("th",{className:"text-left p-4 font-medium",children:"Email"}),e.jsx("th",{className:"text-left p-4 font-medium",children:"Phone"}),e.jsx("th",{className:"text-left p-4 font-medium",children:"Status"}),e.jsx("th",{className:"text-left p-4 font-medium",children:"Submitted"}),e.jsx("th",{className:"text-left p-4 font-medium",children:"Action"})]})}),e.jsx("tbody",{children:P.map(s=>e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"p-4",children:s.businessInfo?.companyName||"N/A"}),e.jsxs("td",{className:"p-4",children:[s.user?.profile?.firstName," ",s.user?.profile?.lastName]}),e.jsx("td",{className:"p-4",children:s.user?.email}),e.jsx("td",{className:"p-4",children:s.user?.profile?.phone||"N/A"}),e.jsx("td",{className:"p-4",children:I(s.approval?.status)}),e.jsx("td",{className:"p-4",children:new Date(s.approval?.submittedAt).toLocaleDateString()}),e.jsx("td",{className:"p-4",children:e.jsxs(j,{variant:"ghost",size:"sm",onClick:()=>y(`/rolebased/vendor-details?vendorId=${s._id}`),children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"View Details"]})})]},s._id))})]})})})]})]}):null};export{b as default};
