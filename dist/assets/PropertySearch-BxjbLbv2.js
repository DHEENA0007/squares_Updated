import{b as be,j as e,c as Ne,a as we,e as A,P as L,u as K,F as ye,a1 as Pe}from"./ui-BHyUY8Z8.js";import{r as l,d as Ce,h as Re}from"./router-2SVJvIbS.js";import{aF as ne,aE as Ee,g as ke,W as De,az as _e,a as O,e as U,Y as Te,I as Be,s as Y,v as G,w as W,x as q,y as w,f as M,H as Fe,aB as se,aK as Me,B as re,h as Ae,ax as Ke,ay as Ve}from"./index-Bd1eLXM_.js";import{C as He}from"./checkbox-CFGICxZb.js";import{f as X}from"./favoriteService-B3PEnQsM.js";import{S as Ie}from"./square-CHtLIP04.js";import"./vendor-Dazix4UH.js";var ae=["PageUp","PageDown"],oe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ie={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},V="Slider",[Q,Le,ze]=we(V),[le]=Ne(V,[ze]),[$e,z]=le(V),ce=l.forwardRef((s,r)=>{const{name:n,min:a=0,max:c=100,step:u=1,orientation:i="horizontal",disabled:d=!1,minStepsBetweenThumbs:h=0,defaultValue:b=[a],value:N,onValueChange:o=()=>{},onValueCommit:p=()=>{},inverted:v=!1,form:C,...f}=s,j=l.useRef(new Set),m=l.useRef(0),S=i==="horizontal"?Oe:Ue,[g=[],E]=be({prop:N,defaultProp:b,onChange:y=>{[...j.current][m.current]?.focus(),o(y)}}),H=l.useRef(g);function T(y){const k=Xe(g,y);D(y,k)}function I(y){D(y,m.current)}function $(){const y=H.current[m.current];g[m.current]!==y&&p(g)}function D(y,k,{commit:B}={commit:!1}){const F=et(u),t=tt(Math.round((y-a)/u)*u+a,F),x=ne(t,[a,c]);E((P=[])=>{const _=We(P,x,k);if(Ze(_,h*u)){m.current=_.indexOf(x);const te=String(_)!==String(P);return te&&B&&p(_),te?_:P}else return P})}return e.jsx($e,{scope:s.__scopeSlider,name:n,disabled:d,min:a,max:c,valueIndexToChangeRef:m,thumbs:j.current,values:g,orientation:i,form:C,children:e.jsx(Q.Provider,{scope:s.__scopeSlider,children:e.jsx(Q.Slot,{scope:s.__scopeSlider,children:e.jsx(S,{"aria-disabled":d,"data-disabled":d?"":void 0,...f,ref:r,onPointerDown:A(f.onPointerDown,()=>{d||(H.current=g)}),min:a,max:c,inverted:v,onSlideStart:d?void 0:T,onSlideMove:d?void 0:I,onSlideEnd:d?void 0:$,onHomeKeyDown:()=>!d&&D(a,0,{commit:!0}),onEndKeyDown:()=>!d&&D(c,g.length-1,{commit:!0}),onStepKeyDown:({event:y,direction:k})=>{if(!d){const t=ae.includes(y.key)||y.shiftKey&&oe.includes(y.key)?10:1,x=m.current,P=g[x],_=u*t*k;D(P+_,x,{commit:!0})}}})})})})});ce.displayName=V;var[de,ue]=le(V,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Oe=l.forwardRef((s,r)=>{const{min:n,max:a,dir:c,inverted:u,onSlideStart:i,onSlideMove:d,onSlideEnd:h,onStepKeyDown:b,...N}=s,[o,p]=l.useState(null),v=K(r,S=>p(S)),C=l.useRef(void 0),f=ye(c),j=f==="ltr",m=j&&!u||!j&&u;function R(S){const g=C.current||o.getBoundingClientRect(),E=[0,g.width],T=ee(E,m?[n,a]:[a,n]);return C.current=g,T(S-g.left)}return e.jsx(de,{scope:s.__scopeSlider,startEdge:m?"left":"right",endEdge:m?"right":"left",direction:m?1:-1,size:"width",children:e.jsx(me,{dir:f,"data-orientation":"horizontal",...N,ref:v,style:{...N.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:S=>{const g=R(S.clientX);i?.(g)},onSlideMove:S=>{const g=R(S.clientX);d?.(g)},onSlideEnd:()=>{C.current=void 0,h?.()},onStepKeyDown:S=>{const E=ie[m?"from-left":"from-right"].includes(S.key);b?.({event:S,direction:E?-1:1})}})})}),Ue=l.forwardRef((s,r)=>{const{min:n,max:a,inverted:c,onSlideStart:u,onSlideMove:i,onSlideEnd:d,onStepKeyDown:h,...b}=s,N=l.useRef(null),o=K(r,N),p=l.useRef(void 0),v=!c;function C(f){const j=p.current||N.current.getBoundingClientRect(),m=[0,j.height],S=ee(m,v?[a,n]:[n,a]);return p.current=j,S(f-j.top)}return e.jsx(de,{scope:s.__scopeSlider,startEdge:v?"bottom":"top",endEdge:v?"top":"bottom",size:"height",direction:v?1:-1,children:e.jsx(me,{"data-orientation":"vertical",...b,ref:o,style:{...b.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:f=>{const j=C(f.clientY);u?.(j)},onSlideMove:f=>{const j=C(f.clientY);i?.(j)},onSlideEnd:()=>{p.current=void 0,d?.()},onStepKeyDown:f=>{const m=ie[v?"from-bottom":"from-top"].includes(f.key);h?.({event:f,direction:m?-1:1})}})})}),me=l.forwardRef((s,r)=>{const{__scopeSlider:n,onSlideStart:a,onSlideMove:c,onSlideEnd:u,onHomeKeyDown:i,onEndKeyDown:d,onStepKeyDown:h,...b}=s,N=z(V,n);return e.jsx(L.span,{...b,ref:r,onKeyDown:A(s.onKeyDown,o=>{o.key==="Home"?(i(o),o.preventDefault()):o.key==="End"?(d(o),o.preventDefault()):ae.concat(oe).includes(o.key)&&(h(o),o.preventDefault())}),onPointerDown:A(s.onPointerDown,o=>{const p=o.target;p.setPointerCapture(o.pointerId),o.preventDefault(),N.thumbs.has(p)?p.focus():a(o)}),onPointerMove:A(s.onPointerMove,o=>{o.target.hasPointerCapture(o.pointerId)&&c(o)}),onPointerUp:A(s.onPointerUp,o=>{const p=o.target;p.hasPointerCapture(o.pointerId)&&(p.releasePointerCapture(o.pointerId),u(o))})})}),fe="SliderTrack",xe=l.forwardRef((s,r)=>{const{__scopeSlider:n,...a}=s,c=z(fe,n);return e.jsx(L.span,{"data-disabled":c.disabled?"":void 0,"data-orientation":c.orientation,...a,ref:r})});xe.displayName=fe;var J="SliderRange",he=l.forwardRef((s,r)=>{const{__scopeSlider:n,...a}=s,c=z(J,n),u=ue(J,n),i=l.useRef(null),d=K(r,i),h=c.values.length,b=c.values.map(p=>ve(p,c.min,c.max)),N=h>1?Math.min(...b):0,o=100-Math.max(...b);return e.jsx(L.span,{"data-orientation":c.orientation,"data-disabled":c.disabled?"":void 0,...a,ref:d,style:{...s.style,[u.startEdge]:N+"%",[u.endEdge]:o+"%"}})});he.displayName=J;var Z="SliderThumb",pe=l.forwardRef((s,r)=>{const n=Le(s.__scopeSlider),[a,c]=l.useState(null),u=K(r,d=>c(d)),i=l.useMemo(()=>a?n().findIndex(d=>d.ref.current===a):-1,[n,a]);return e.jsx(Ye,{...s,ref:u,index:i})}),Ye=l.forwardRef((s,r)=>{const{__scopeSlider:n,index:a,name:c,...u}=s,i=z(Z,n),d=ue(Z,n),[h,b]=l.useState(null),N=K(r,R=>b(R)),o=h?i.form||!!h.closest("form"):!0,p=Pe(h),v=i.values[a],C=v===void 0?0:ve(v,i.min,i.max),f=qe(a,i.values.length),j=p?.[d.size],m=j?Qe(j,C,d.direction):0;return l.useEffect(()=>{if(h)return i.thumbs.add(h),()=>{i.thumbs.delete(h)}},[h,i.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[d.startEdge]:`calc(${C}% + ${m}px)`},children:[e.jsx(Q.ItemSlot,{scope:s.__scopeSlider,children:e.jsx(L.span,{role:"slider","aria-label":s["aria-label"]||f,"aria-valuemin":i.min,"aria-valuenow":v,"aria-valuemax":i.max,"aria-orientation":i.orientation,"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,tabIndex:i.disabled?void 0:0,...u,ref:N,style:v===void 0?{display:"none"}:s.style,onFocus:A(s.onFocus,()=>{i.valueIndexToChangeRef.current=a})})}),o&&e.jsx(ge,{name:c??(i.name?i.name+(i.values.length>1?"[]":""):void 0),form:i.form,value:v},a)]})});pe.displayName=Z;var Ge="RadioBubbleInput",ge=l.forwardRef(({__scopeSlider:s,value:r,...n},a)=>{const c=l.useRef(null),u=K(c,a),i=Ee(r);return l.useEffect(()=>{const d=c.current;if(!d)return;const h=window.HTMLInputElement.prototype,N=Object.getOwnPropertyDescriptor(h,"value").set;if(i!==r&&N){const o=new Event("input",{bubbles:!0});N.call(d,r),d.dispatchEvent(o)}},[i,r]),e.jsx(L.input,{style:{display:"none"},...n,ref:u,defaultValue:r})});ge.displayName=Ge;function We(s=[],r,n){const a=[...s];return a[n]=r,a.sort((c,u)=>c-u)}function ve(s,r,n){const u=100/(n-r)*(s-r);return ne(u,[0,100])}function qe(s,r){return r>2?`Value ${s+1} of ${r}`:r===2?["Minimum","Maximum"][s]:void 0}function Xe(s,r){if(s.length===1)return 0;const n=s.map(c=>Math.abs(c-r)),a=Math.min(...n);return n.indexOf(a)}function Qe(s,r,n){const a=s/2,u=ee([0,50],[0,a]);return(a-u(r)*n)*n}function Je(s){return s.slice(0,-1).map((r,n)=>s[n+1]-r)}function Ze(s,r){if(r>0){const n=Je(s);return Math.min(...n)>=r}return!0}function ee(s,r){return n=>{if(s[0]===s[1]||r[0]===r[1])return r[0];const a=(r[1]-r[0])/(s[1]-s[0]);return r[0]+a*(n-s[0])}}function et(s){return(String(s).split(".")[1]||"").length}function tt(s,r){const n=Math.pow(10,r);return Math.round(s*n)/n}var je=ce,st=xe,rt=he,nt=pe;const Se=l.forwardRef(({className:s,...r},n)=>e.jsxs(je,{ref:n,className:ke("relative flex w-full touch-none select-none items-center",s),...r,children:[e.jsx(st,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(rt,{className:"absolute h-full bg-primary"})}),e.jsx(nt,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Se.displayName=je.displayName;const mt=()=>{const s=Ce(),{toast:r}=De(),[n]=Re(),[a,c]=l.useState([]),[u,i]=l.useState(!0),[d,h]=l.useState(""),[b,N]=l.useState("all"),[o,p]=l.useState("all"),[v,C]=l.useState("any"),[f,j]=l.useState([0,2e7]),[m,R]=l.useState([]),[S,g]=l.useState(1),[E,H]=l.useState(1),[T,I]=l.useState(new Set),$=["Swimming Pool","Gym/Fitness Center","Parking","Security","Garden/Park","Playground","Clubhouse","Power Backup","Elevator","WiFi","CCTV Surveillance","Water Supply","Fire Safety"];l.useEffect(()=>{const t=n.get("q");t&&h(t)},[n]),l.useEffect(()=>{D()},[d,b,o,v,f,m,S]);const D=async()=>{i(!0);try{const t={page:S,limit:12};d.trim()&&(t.search=d),b!=="all"&&(t.listingType=b),o!=="all"&&(t.propertyType=o),v!=="any"&&(t.bedrooms=v),f[0]>0&&(t.minPrice=f[0]),f[1]<2e7&&(t.maxPrice=f[1]),m.length>0&&(t.amenities=m);const x=await _e.getProperties(t);x.success&&(c(x.data.properties),H(x.data.pagination.totalPages))}catch(t){console.error("Error loading properties:",t),r({title:"Error",description:"Failed to load properties",variant:"destructive"})}finally{i(!1)}};l.useEffect(()=>{y()},[]);const y=async()=>{try{const t=await X.getFavorites();if(t.success){const x=new Set(t.data.favorites.map(P=>P.property?._id).filter(Boolean));I(x)}}catch(t){console.error("Error loading favorites:",t)}},k=async t=>{try{T.has(t)?(await X.removeFromFavorites(t),I(x=>{const P=new Set(x);return P.delete(t),P}),r({title:"Removed from favorites",description:"Property removed from your favorites"})):(await X.addToFavorites(t),I(x=>new Set(x).add(t)),r({title:"Added to favorites",description:"Property added to your favorites"}))}catch(x){console.error("Error toggling favorite:",x),r({title:"Error",description:"Failed to update favorite",variant:"destructive"})}},B=()=>{h(""),N("all"),p("all"),C("any"),j([0,2e7]),R([]),g(1)},F=t=>t>=1e7?`₹${(t/1e7).toFixed(2)} Cr`:t>=1e5?`₹${(t/1e5).toFixed(2)} L`:`₹${t.toLocaleString()}`;return e.jsxs("div",{className:"min-h-screen",children:[e.jsx("div",{className:"bg-gradient-to-r from-primary/10 to-primary/5 border-b",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Search Properties"}),e.jsx("p",{className:"text-muted-foreground",children:"Find your dream property from our verified listings"})]})}),e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsx("aside",{className:"lg:w-80 flex-shrink-0",children:e.jsx(O,{className:"sticky top-20",children:e.jsxs(U,{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Filters"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(Te,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(Be,{placeholder:"Location, property name...",value:d,onChange:t=>h(t.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Listing Type"}),e.jsxs(Y,{value:b,onValueChange:N,children:[e.jsx(G,{children:e.jsx(W,{placeholder:"Type"})}),e.jsxs(q,{children:[e.jsx(w,{value:"all",children:"All Types"}),e.jsx(w,{value:"sale",children:"For Sale"}),e.jsx(w,{value:"rent",children:"For Rent"}),e.jsx(w,{value:"lease",children:"For Lease"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Property Type"}),e.jsxs(Y,{value:o,onValueChange:p,children:[e.jsx(G,{children:e.jsx(W,{placeholder:"Property"})}),e.jsxs(q,{children:[e.jsx(w,{value:"all",children:"All Properties"}),e.jsx(w,{value:"apartment",children:"Apartment"}),e.jsx(w,{value:"villa",children:"Villa"}),e.jsx(w,{value:"house",children:"House"}),e.jsx(w,{value:"plot",children:"Plot"}),e.jsx(w,{value:"land",children:"Land"}),e.jsx(w,{value:"commercial",children:"Commercial"}),e.jsx(w,{value:"office",children:"Office"}),e.jsx(w,{value:"pg",children:"PG"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Bedrooms"}),e.jsxs(Y,{value:v,onValueChange:C,children:[e.jsx(G,{children:e.jsx(W,{placeholder:"BHK"})}),e.jsxs(q,{children:[e.jsx(w,{value:"any",children:"Any BHK"}),e.jsx(w,{value:"1",children:"1 BHK"}),e.jsx(w,{value:"2",children:"2 BHK"}),e.jsx(w,{value:"3",children:"3 BHK"}),e.jsx(w,{value:"4",children:"4+ BHK"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Price Range"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Se,{value:f,onValueChange:j,min:0,max:2e7,step:1e5,className:"w-full"}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Min Price"}),e.jsx("span",{className:"font-semibold text-primary",children:F(f[0])})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Max Price"}),e.jsx("span",{className:"font-semibold text-primary",children:F(f[1])})]})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Amenities"}),e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2 border rounded-md p-3",children:$.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(He,{id:t,checked:m.includes(t),onCheckedChange:x=>{R(x?[...m,t]:m.filter(P=>P!==t))}}),e.jsx("label",{htmlFor:t,className:"text-sm font-normal cursor-pointer leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:t})]},t))}),m.length>0&&e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[m.length," selected"]})]}),e.jsx(M,{variant:"outline",onClick:B,className:"w-full",children:"Reset Filters"})]})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Available Properties"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:u?"Loading...":`${a.length} properties found`})]}),u?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(Fe,{className:"h-8 w-8 animate-spin text-primary"})}):a.length===0?e.jsx(O,{children:e.jsxs(U,{className:"p-12 text-center",children:[e.jsx(se,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No properties found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Try adjusting your filters or search criteria"}),e.jsx(M,{onClick:B,children:"Clear Filters"})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:a.map(t=>e.jsxs(O,{className:"overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",children:[e.jsxs("div",{className:"relative h-48 bg-muted",onClick:()=>s(`/property/${t._id}`),children:[t.images&&t.images.length>0?e.jsx("img",{src:typeof t.images[0]=="string"?t.images[0]:t.images[0]?.url,alt:t.title,className:"w-full h-full object-cover",onError:x=>{const P=x.target;P.src="/placeholder-property.jpg"}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(se,{className:"h-12 w-12 text-muted-foreground"})}),e.jsx(M,{size:"icon",variant:"secondary",className:"absolute top-2 right-2",onClick:x=>{x.stopPropagation(),k(t._id)},children:e.jsx(Me,{className:`h-4 w-4 ${T.has(t._id)?"fill-red-500 text-red-500":""}`})}),e.jsx(re,{className:"absolute top-2 left-2 capitalize",children:t.listingType})]}),e.jsxs(U,{className:"p-4",onClick:()=>s(`/customer/property/${t._id}`),children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg line-clamp-1",children:t.title}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mt-1",children:[e.jsx(Ae,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{className:"line-clamp-1",children:[t.address.city,", ",t.address.state]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:F(t.price)}),t.listingType==="rent"&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"/month"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[t.bedrooms>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx("span",{children:t.bedrooms})]}),t.bathrooms>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ve,{className:"h-4 w-4"}),e.jsx("span",{children:t.bathrooms})]}),t.area?.builtUp&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ie,{className:"h-4 w-4"}),e.jsxs("span",{children:[t.area.builtUp," sqft"]})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t",children:e.jsx(re,{variant:"outline",className:"capitalize",children:t.type})})]})]},t._id))}),E>1&&e.jsxs("div",{className:"flex justify-center gap-2 mt-8",children:[e.jsx(M,{variant:"outline",disabled:S===1,onClick:()=>g(t=>t-1),children:"Previous"}),e.jsx("div",{className:"flex items-center gap-2",children:Array.from({length:E},(t,x)=>x+1).map(t=>e.jsx(M,{variant:S===t?"default":"outline",onClick:()=>g(t),className:"w-10",children:t},t))}),e.jsx(M,{variant:"outline",disabled:S===E,onClick:()=>g(t=>t+1),children:"Next"})]})]})]})]})})]})};export{mt as default};
