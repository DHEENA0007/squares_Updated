import{j as e}from"./ui-CEFKCYQo.js";import{r as s}from"./router-Bi51YGN-.js";import{W as a,aE as r,Q as t,I as i,a as l,e as n,C as c,b as d,aF as o,c as m,d as p,h as x,x as h,B as j,f as u,E as f,O as v,a2 as g,a3 as N,a4 as b,a5 as y,a6 as w,L as C,T as k,a7 as F,at as S,au as P,av as $}from"./index-Ds-LUfCl.js";import{C as R}from"./checkbox-DscVYI3N.js";import{f as V,h as A}from"./apiUtils-Bbv9G39a.js";import{V as _}from"./VirtualTourViewer-CwB8DaER.js";import{S as E}from"./separator-ppO9nLCy.js";import{C as T}from"./calendar-CC4c2MNn.js";import{I as O}from"./indian-rupee-Bxz217zj.js";import"./vendor-eVk5PToZ.js";import"./external-link-CxTCu2LW.js";const D=e=>{if(!e)return o;const s="object"==typeof e?e.url:e;if(!s||"string"!=typeof s)return o;if(s.startsWith("http://")||s.startsWith("https://"))return s;const a=s.startsWith("/api")?s.substring(4):s;return`${"https://app.buildhomemartsquares.com/api".replace("/api","")}${a}`},I=()=>{const[I,Q]=s.useState([]),[z,q]=s.useState(!0),[W,B]=s.useState(""),[L,U]=s.useState(1),[J,M]=s.useState(1),[G,H]=s.useState(null),[K,X]=s.useState(!1),[Y,Z]=s.useState(!1),[ee,se]=s.useState(!1),[ae,re]=s.useState(""),[te,ie]=s.useState({}),{toast:le}=a(),[ne,ce]=s.useState(""),[de,oe]=s.useState({documentsVerified:!1,locationVerified:!1,priceReasonable:!1,imagesQuality:!1,descriptionComplete:!1,ownershipConfirmed:!1}),[me,pe]=s.useState("");s.useEffect(()=>{xe()},[L,W]);const xe=async()=>{try{q(!0);const e=await V(`/subadmin/properties/pending?page=${L}&search=${W}`),s=await A(e);Q(s.data.properties||[]),M(s.data.totalPages||1)}catch(e){le({title:"Error",description:e.message||"Error fetching properties",variant:"destructive"}),Q([])}finally{q(!1)}};r("property_created",e=>{le({title:"New Property",description:"A new property has been submitted for review"}),xe()}),r("property_updated",e=>{xe()});const he=()=>{oe({documentsVerified:!1,locationVerified:!1,priceReasonable:!1,imagesQuality:!1,descriptionComplete:!1,ownershipConfirmed:!1}),pe(""),ce(""),re("")},je=e=>`₹${e.toLocaleString("en-IN")}`;return z&&0===I.length?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Property Reviews"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Review and approve property listings"})]}),e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-32 bg-gray-200 rounded-lg"},s))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Property Reviews"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Review and approve property listings"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(t,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(i,{placeholder:"Search properties by title or city...",value:W,onChange:e=>B(e.target.value),className:"pl-10"})]}),e.jsx("div",{className:"space-y-4",children:0===I.length?e.jsx(l,{children:e.jsxs(n,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(c,{className:"h-12 w-12 text-green-500 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"No Pending Properties"}),e.jsx("p",{className:"text-muted-foreground text-center",children:"All properties have been reviewed. Great job!"})]})}):I.map(s=>e.jsxs(l,{className:"overflow-hidden",children:[e.jsx(d,{className:"pb-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[s.images&&s.images.length>0&&e.jsx("div",{className:"flex-shrink-0 mx-auto sm:mx-0",children:e.jsx("img",{src:D(s.images[0]),alt:s.title,className:"w-20 h-20 sm:w-24 sm:h-24 object-cover rounded-lg shadow-sm",onError:e=>{e.target.src=o}})}),e.jsxs("div",{className:"flex-1 space-y-2 text-center sm:text-left",children:[e.jsx(m,{className:"text-lg sm:text-xl leading-tight",children:s.title}),e.jsx(p,{className:"space-y-1",children:e.jsxs("div",{className:"flex flex-wrap justify-center sm:justify-start items-center gap-2 sm:gap-4 text-xs sm:text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(x,{className:"h-3 w-3 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.address.district?`${s.address.city}, ${s.address.district}, ${s.address.state}`:`${s.address.city}, ${s.address.state}`})]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"h-3 w-3 flex-shrink-0"}),new Date(s.createdAt).toLocaleDateString()]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(h,{className:"h-3 w-3 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.owner.email})]})]})})]}),e.jsxs("div",{className:"text-center sm:text-right flex-shrink-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-primary",children:je(s.price)}),e.jsxs(j,{variant:"outline",className:"mt-1 text-xs",children:[s.type," • ",s.listingType]})]})]})}),e.jsx(n,{className:"pt-0",children:e.jsxs("div",{className:"flex flex-wrap justify-center sm:justify-start gap-2",children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>{H(s),se(!0)},className:"flex-1 min-w-[120px] touch-manipulation",children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"View Details"]}),e.jsxs(u,{size:"sm",onClick:()=>(e=>{H(e),he(),X(!0)})(s),disabled:te[s._id],className:"flex-1 min-w-[120px] bg-green-600 hover:bg-green-700 touch-manipulation",children:[e.jsx(c,{className:"h-4 w-4 mr-2"}),"Approve"]}),e.jsxs(u,{variant:"destructive",size:"sm",onClick:()=>(e=>{H(e),he(),Z(!0)})(s),disabled:te[s._id],className:"flex-1 min-w-[120px] touch-manipulation",children:[e.jsx(v,{className:"h-4 w-4 mr-2"}),"Reject"]})]})})]},s._id))}),J>1&&e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(u,{variant:"outline",disabled:1===L,onClick:()=>U(L-1),children:"Previous"}),e.jsxs("span",{className:"px-3 py-2 text-sm",children:["Page ",L," of ",J]}),e.jsx(u,{variant:"outline",disabled:L===J,onClick:()=>U(L+1),children:"Next"})]}),e.jsx(g,{open:K,onOpenChange:X,children:e.jsxs(N,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(b,{children:[e.jsx(y,{children:"Approve Property"}),e.jsxs(w,{children:['Complete the verification checklist and provide your approval for "',G?.title,'".']})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"approver-name-approve",children:"Moderator Name *"}),e.jsx(i,{id:"approver-name-approve",placeholder:"Enter your full name",value:ne,onChange:e=>ce(e.target.value),className:"mt-1"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(C,{className:"text-base font-semibold",children:"Verification Checklist"}),e.jsxs("div",{className:"space-y-3 border rounded-lg p-4 bg-muted/30",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(R,{id:"documents-approve",checked:de.documentsVerified,onCheckedChange:e=>oe({...de,documentsVerified:e})}),e.jsx("label",{htmlFor:"documents-approve",className:"text-sm font-medium cursor-pointer",children:"All required documents are verified"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(R,{id:"location-approve",checked:de.locationVerified,onCheckedChange:e=>oe({...de,locationVerified:e})}),e.jsx("label",{htmlFor:"location-approve",className:"text-sm font-medium cursor-pointer",children:"Property location is verified and accurate"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(R,{id:"price-approve",checked:de.priceReasonable,onCheckedChange:e=>oe({...de,priceReasonable:e})}),e.jsx("label",{htmlFor:"price-approve",className:"text-sm font-medium cursor-pointer",children:"Price is reasonable and competitive"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(R,{id:"images-approve",checked:de.imagesQuality,onCheckedChange:e=>oe({...de,imagesQuality:e})}),e.jsx("label",{htmlFor:"images-approve",className:"text-sm font-medium cursor-pointer",children:"Images are of good quality and relevant"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(R,{id:"description-approve",checked:de.descriptionComplete,onCheckedChange:e=>oe({...de,descriptionComplete:e})}),e.jsx("label",{htmlFor:"description-approve",className:"text-sm font-medium cursor-pointer",children:"Description is complete and accurate"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(R,{id:"ownership-approve",checked:de.ownershipConfirmed,onCheckedChange:e=>oe({...de,ownershipConfirmed:e})}),e.jsx("label",{htmlFor:"ownership-approve",className:"text-sm font-medium cursor-pointer",children:"Ownership is confirmed and legitimate"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"handwritten-comments-approve",children:"Approval Notes & Comments"}),e.jsx(k,{id:"handwritten-comments-approve",placeholder:"Type your handwritten comments or notes here...",value:me,onChange:e=>pe(e.target.value),className:"mt-1 min-h-[120px] font-handwriting",rows:6}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Add any additional observations, recommendations, or special notes"})]})]}),e.jsxs(F,{children:[e.jsx(u,{variant:"outline",onClick:()=>X(!1),children:"Cancel"}),e.jsx(u,{className:"bg-green-600 hover:bg-green-700",onClick:async()=>{if(G&&ne.trim())try{ie({...te,[G._id]:!0});const e=await V(`/subadmin/properties/${G._id}/approve`,{method:"POST",body:JSON.stringify({approver:ne,notes:me})});await A(e),le({title:"Success",description:"Property approved successfully"}),X(!1),he(),H(null),xe()}catch(e){le({title:"Error",description:e.message||"Failed to approve property",variant:"destructive"})}finally{ie({...te,[G._id]:!1})}else le({title:"Error",description:"Approver name is required",variant:"destructive"})},disabled:!ne.trim()||te[G?._id||""],children:te[G?._id||""]?"Approving...":"Approve Property"})]})]})}),e.jsx(g,{open:Y,onOpenChange:Z,children:e.jsxs(N,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(b,{children:[e.jsx(y,{children:"Reject Property"}),e.jsxs(w,{children:['Complete the form and provide a reason for rejecting "',G?.title,'". The vendor will be notified.']})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"approver-name-reject",children:"Moderator Name *"}),e.jsx(i,{id:"approver-name-reject",placeholder:"Enter your full name",value:ne,onChange:e=>ce(e.target.value),className:"mt-1"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(C,{className:"text-base font-semibold",children:"Issues Found (Check applicable items)"}),e.jsxs("div",{className:"space-y-3 border rounded-lg p-4 bg-muted/30",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(R,{id:"documents-reject",checked:de.documentsVerified,onCheckedChange:e=>oe({...de,documentsVerified:e})}),e.jsx("label",{htmlFor:"documents-reject",className:"text-sm font-medium cursor-pointer",children:"Documents are incomplete or invalid"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(R,{id:"location-reject",checked:de.locationVerified,onCheckedChange:e=>oe({...de,locationVerified:e})}),e.jsx("label",{htmlFor:"location-reject",className:"text-sm font-medium cursor-pointer",children:"Property location is incorrect or unclear"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(R,{id:"price-reject",checked:de.priceReasonable,onCheckedChange:e=>oe({...de,priceReasonable:e})}),e.jsx("label",{htmlFor:"price-reject",className:"text-sm font-medium cursor-pointer",children:"Price is unreasonable or suspicious"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(R,{id:"images-reject",checked:de.imagesQuality,onCheckedChange:e=>oe({...de,imagesQuality:e})}),e.jsx("label",{htmlFor:"images-reject",className:"text-sm font-medium cursor-pointer",children:"Images are poor quality or irrelevant"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(R,{id:"description-reject",checked:de.descriptionComplete,onCheckedChange:e=>oe({...de,descriptionComplete:e})}),e.jsx("label",{htmlFor:"description-reject",className:"text-sm font-medium cursor-pointer",children:"Description is incomplete or misleading"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(R,{id:"ownership-reject",checked:de.ownershipConfirmed,onCheckedChange:e=>oe({...de,ownershipConfirmed:e})}),e.jsx("label",{htmlFor:"ownership-reject",className:"text-sm font-medium cursor-pointer",children:"Ownership cannot be confirmed"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"rejection-reason",children:"Rejection Reason *"}),e.jsx(k,{id:"rejection-reason",placeholder:"Enter the detailed reason for rejection...",value:ae,onChange:e=>re(e.target.value),className:"mt-1",rows:4})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"handwritten-comments-reject",children:"Additional Comments"}),e.jsx(k,{id:"handwritten-comments-reject",placeholder:"Type your handwritten comments or notes here...",value:me,onChange:e=>pe(e.target.value),className:"mt-1 min-h-[120px] font-handwriting",rows:6}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Add any additional feedback or suggestions for the vendor"})]})]}),e.jsxs(F,{children:[e.jsx(u,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),e.jsx(u,{variant:"destructive",onClick:async()=>{if(G&&ae.trim()&&ne.trim())try{ie({...te,[G._id]:!0});const e=await V(`/subadmin/properties/${G._id}/reject`,{method:"POST",body:JSON.stringify({reason:ae,approver:ne,notes:me})});await A(e),le({title:"Success",description:"Property rejected successfully"}),Z(!1),he(),H(null),xe()}catch(e){le({title:"Error",description:"Failed to reject property",variant:"destructive"})}finally{ie({...te,[G._id]:!1})}else le({title:"Error",description:"Approver name and rejection reason are required",variant:"destructive"})},disabled:!ae.trim()||!ne.trim()||te[G?._id||""],children:te[G?._id||""]?"Rejecting...":"Reject Property"})]})]})}),e.jsx(g,{open:ee,onOpenChange:se,children:e.jsxs(N,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(b,{children:[e.jsx(y,{className:"text-2xl",children:G?.title}),e.jsx(w,{children:e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(x,{className:"w-4 h-4"}),G?.address.street,", ",G?.address.city,", ",G?.address.state," - ",G?.address.pincode||G?.address.zipCode]})})]}),G&&e.jsxs("div",{className:"space-y-6 mt-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(j,{variant:"available"===G.status?"default":"pending"===G.status?"outline":"destructive",children:["Status: ",G.status]}),e.jsx(j,{variant:"secondary",className:"capitalize",children:G.type?G.type.replace("_"," "):"property"}),e.jsxs(j,{variant:"sale"===G.listingType?"default":"outline",children:["For ","sale"===G.listingType?"Sale":"Rent"]}),G.featured&&e.jsx(j,{variant:"default",children:"Featured"}),G.verified&&e.jsx(j,{variant:"default",children:"Verified"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Price"}),e.jsx("p",{className:"font-semibold",children:je(G.price)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Area"}),e.jsx("p",{className:"font-semibold",children:(ue=G.area,ue.builtUp?`${ue.builtUp} ${ue.unit}`:ue.plot?`${ue.plot} ${ue.unit}`:ue.carpet?`${ue.carpet} ${ue.unit}`:"N/A")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Bedrooms"}),e.jsx("p",{className:"font-semibold",children:G.bedrooms||"N/A"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Bathrooms"}),e.jsx("p",{className:"font-semibold",children:G.bathrooms||"N/A"})]})]})]}),e.jsx(E,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:G.description})]}),G.amenities&&G.amenities.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(E,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Amenities"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:G.amenities.map((s,a)=>e.jsx(j,{variant:"outline",className:"capitalize",children:s.replace("_"," ")},a))})]})]}),e.jsx(E,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Owner Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Name"}),e.jsx("p",{className:"font-medium",children:G.owner?.profile?.firstName&&G.owner?.profile?.lastName?`${G.owner.profile.firstName} ${G.owner.profile.lastName}`:G.owner.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Email"}),e.jsx("p",{className:"font-medium",children:G.owner?.email})]}),G.owner?.profile?.phone&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Phone"}),e.jsx("p",{className:"font-medium",children:G.owner.profile.phone})]})]})]}),G.images&&G.images.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(E,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Images"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:G.images.map((s,a)=>{const r="object"==typeof s?s:{};return e.jsxs("div",{className:"relative aspect-video rounded-lg overflow-hidden border",children:[e.jsx("img",{src:D(s),alt:r.caption||`Property ${a+1}`,className:"w-full h-full object-cover",onError:e=>{e.target.src=o}}),r.isPrimary&&e.jsx(j,{className:"absolute top-2 left-2",variant:"default",children:"Primary"})]},a)})})]})]}),G.videos&&G.videos.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(E,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Videos"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:G.videos.map((s,a)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"relative aspect-video rounded-lg overflow-hidden border bg-black",children:s.url&&(s.url.includes("youtube.com")||s.url.includes("youtu.be"))?e.jsx("iframe",{src:s.url.replace("watch?v=","embed/").replace("youtu.be/","youtube.com/embed/"),className:"w-full h-full",allowFullScreen:!0,title:s.caption||`Video ${a+1}`}):e.jsx("video",{src:s.url,controls:!0,className:"w-full h-full object-contain",poster:s.thumbnail})}),s.caption&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.caption})]},a))})]})]}),G.virtualTour&&e.jsxs(e.Fragment,{children:[e.jsx(E,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Virtual Tour"}),e.jsx(_,{url:G.virtualTour})]})]}),"rejected"===G.status&&G.rejectionReason&&e.jsxs(e.Fragment,{children:[e.jsx(E,{}),e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-red-700 mb-2",children:"Rejection Reason"}),e.jsx("p",{className:"text-sm text-red-600",children:G.rejectionReason})]})]})]})]})})]});var ue};export{I as default};
