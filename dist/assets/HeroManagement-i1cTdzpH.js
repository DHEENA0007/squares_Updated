import{j as e}from"./ui-BNZSgpjP.js";import{r as s}from"./router-D8v2YSKU.js";import{D as a,bC as i,a3 as l,bD as t,G as r,f as c,al as n,af as d,ag as o,ah as h,by as x,Y as m,a9 as u,aj as p,ai as j,a as g,b as v,c as f,B as y,e as b,bE as N,d as w,L as S,ac as C,I as k,ao as A,bF as O,bG as F,J as I,p as V,k as U,$ as D,ad as B,q,r as P,s as _,v as z,w as T,a4 as L,a5 as M,a6 as E,a7 as H,a8 as K,T as $,j as Q,ae as R,bH as W,bI as G,bJ as J,bK as Y}from"./index-CM8T-gRV.js";import"./vendor-BxThA0WO.js";const Z=a("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),X=a("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),ee=[{value:"Plus",label:"Plus",icon:u},{value:"Calculator",label:"Calculator",icon:O},{value:"List",label:"List",icon:F},{value:"Settings",label:"Settings",icon:m},{value:"Home",label:"Home",icon:I},{value:"Building",label:"Building",icon:V},{value:"MapPin",label:"Map Pin",icon:U},{value:"Filter",label:"Filter",icon:p},{value:"Search",label:"Search",icon:D}],se=[{value:"post-property",label:"Post Property"},{value:"property-valuation",label:"Property Valuation"},{value:"quick-listing",label:"Quick Listing"},{value:"manage-properties",label:"Manage Properties"},{value:"contact",label:"Contact Page"}],ae=()=>{const[a,O]=s.useState("slides"),[F,I]=s.useState(!0),[V,U]=s.useState(!1),[D,ae]=s.useState([]),[ie,le]=s.useState(null),[te,re]=s.useState(!1),[ce,ne]=s.useState(null),[de,oe]=s.useState([]),[he,xe]=s.useState(null),[me,ue]=s.useState(!1),[pe,je]=s.useState([]),[ge,ve]=s.useState([]),[fe,ye]=s.useState([]),[be,Ne]=s.useState(""),we=e=>{if(!e)return"";return e.replace(/([A-Z])/g," $1").replace(/[_-]/g," ").split(/\s+/).filter(Boolean).map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ")},Se=e=>{if(!e)return"";if(e.startsWith("http"))return e;if(e.startsWith("/uploads")){return`${"https://app.buildhomemartsquares.com/api".replace(/\/api\/?$/,"")}${e}`}return e.includes("Buy.jpg")?W:e.includes("Rent.jpg")?G:e.includes("Lease.jpg")?J:e.includes("commercial.jpg")?Y:e.includes("hero-property.jpg")?"/assets/hero-property.B7TUyTVw.jpg":e},Ce=s.useCallback(async()=>{I(!0);try{const[e,s,a,t,r,c]=await Promise.all([i.getSlides(!0),i.getSettings(),i.getSellingOptions(!0),l.getFilterConfigurationsByType("listing_type",!1),l.getConfigurationMetadata("home_quick_filters"),l.getAllFilterConfigurations(!1)]);ae(e),ne(s),oe(a),je(t);const n=Array.from(new Set(c.map(e=>e.filterType))).sort();ye(n);const d=r?.configValue||[];if(0===d.length){const e=["propertyType","bedrooms","budget"].filter(e=>n.includes(e)||"budget"===e).filter(e=>n.includes(e)||"budget"===e).map((e,s)=>({id:e,label:we(e),isVisible:!0,displayOrder:s}));ve(e)}else ve(d.sort((e,s)=>e.displayOrder-s.displayOrder))}catch(e){t.error("Failed to load hero content")}finally{I(!1)}},[]);s.useEffect(()=>{Ce()},[Ce]);const ke=(e,s)=>{if("up"===s&&0===e||"down"===s&&e===ge.length-1)return;const a=[...ge],i="up"===s?e-1:e+1;[a[e],a[i]]=[a[i],a[e]];const l=a.map((e,s)=>({...e,displayOrder:s}));ve(l)};return F?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(r,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Hero Section Management"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage the hero section content displayed on the homepage"})]}),e.jsxs(c,{variant:"outline",onClick:Ce,children:[e.jsx(n,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),e.jsxs(d,{value:a,onValueChange:O,children:[e.jsxs(o,{className:"grid w-full grid-cols-4",children:[e.jsxs(h,{value:"slides",className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-4 h-4"}),"Slides"]}),e.jsxs(h,{value:"settings",className:"flex items-center gap-2",children:[e.jsx(m,{className:"w-4 h-4"}),"Settings"]}),e.jsxs(h,{value:"selling",className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-4 h-4"}),"Selling Options"]}),e.jsxs(h,{value:"filters",className:"flex items-center gap-2",children:[e.jsx(p,{className:"w-4 h-4"}),"Quick Filters"]})]}),e.jsxs(j,{value:"slides",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Hero Slides"}),e.jsxs(c,{variant:"destructive",size:"sm",onClick:async()=>{if(confirm("Are you sure you want to reset all slides to defaults?"))try{await i.resetSlides(),t.success("Slides reset to defaults"),Ce()}catch(e){t.error("Failed to reset slides")}},children:[e.jsx(n,{className:"w-4 h-4 mr-2"}),"Reset to Defaults"]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:[...pe.map(e=>({key:e.value,label:e.displayLabel||e.name})),{key:"commercial",label:"Commercial"}].filter((e,s,a)=>s===a.findIndex(s=>s.key===e.key)).map(s=>{const a=D.find(e=>e.tabKey===s.key)||{_id:`temp-${s.key}`,tabKey:s.key,title:"",description:"",imageUrl:"",badge:{text:"",isVisible:!0},isActive:!1,displayOrder:0,createdAt:"",updatedAt:""},i=a._id.startsWith("temp-");return e.jsxs(g,{className:a.isActive||i?"":"opacity-60",children:[e.jsx(v,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(f,{className:"text-lg capitalize flex items-center gap-2",children:[s.label,!a.isActive&&!i&&e.jsx(y,{variant:"secondary",children:"Inactive"}),i&&e.jsx(y,{variant:"outline",className:"border-dashed",children:"Not Configured"})]}),e.jsx(c,{size:"sm",onClick:()=>{le(a),re(!0)},children:i?"Create":"Edit"})]})}),e.jsx(b,{children:e.jsxs("div",{className:"aspect-video relative rounded-lg overflow-hidden mb-3 bg-muted",children:[a.imageUrl?e.jsx("img",{src:Se(a.imageUrl),alt:a.tabKey,className:"w-full h-full object-cover",onError:e=>{const s=e.target;s.src.includes("hero-property.jpg")||(s.src="/src/assets/hero-property.jpg")}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-muted text-muted-foreground",children:e.jsx(x,{className:"w-8 h-8 opacity-50"})}),e.jsxs("div",{className:"absolute inset-0 bg-black/50 flex flex-col justify-center items-center text-white p-4",children:[a.badge?.isVisible&&a.badge.text&&e.jsxs("span",{className:"bg-primary/20 text-primary-foreground px-3 py-1 rounded-full text-xs mb-2",children:[e.jsx(N,{className:"inline w-3 h-3 mr-1"}),a.badge.text]}),e.jsx("h3",{className:"text-lg font-bold text-center",children:a.title||"No Title"}),e.jsx("p",{className:"text-sm text-center mt-1 line-clamp-2",children:a.description||"No Description"})]})]})})]},a.tabKey)})})]}),e.jsx(j,{value:"settings",className:"space-y-4",children:e.jsxs(g,{children:[e.jsxs(v,{children:[e.jsx(f,{children:"Hero Section Settings"}),e.jsx(w,{children:"Configure the behavior and visibility of hero section elements"})]}),e.jsx(b,{className:"space-y-6",children:ce&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{className:"text-base",children:"Auto Slide"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically switch between tabs"})]}),e.jsx(C,{checked:ce.autoSlide,onCheckedChange:e=>ne({...ce,autoSlide:e})})]}),ce.autoSlide&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:"Auto Slide Interval (ms)"}),e.jsx(k,{type:"number",min:1e3,max:3e4,step:500,value:ce.autoSlideInterval,onChange:e=>ne({...ce,autoSlideInterval:parseInt(e.target.value)||5e3})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{className:"text-base",children:"Show Search Box"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Display the property search box"})]}),e.jsx(C,{checked:ce.showSearchBox,onCheckedChange:e=>ne({...ce,showSearchBox:e})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{className:"text-base",children:"Show Sell Dropdown"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Display the sell dropdown menu"})]}),e.jsx(C,{checked:ce.showSellDropdown,onCheckedChange:e=>ne({...ce,showSellDropdown:e})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{className:"text-base",children:"Show Filters"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Display the filter button in search"})]}),e.jsx(C,{checked:ce.showFilters,onCheckedChange:e=>ne({...ce,showFilters:e})})]}),e.jsxs(c,{onClick:async()=>{if(ce){U(!0);try{await i.updateSettings({autoSlide:ce.autoSlide,autoSlideInterval:ce.autoSlideInterval,showSearchBox:ce.showSearchBox,showSellDropdown:ce.showSellDropdown,showFilters:ce.showFilters}),t.success("Settings saved successfully")}catch(e){t.error("Failed to save settings")}finally{U(!1)}}},disabled:V,children:[V?e.jsx(r,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(A,{className:"w-4 h-4 mr-2"}),"Save Settings"]})]})})]})}),e.jsxs(j,{value:"selling",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Selling Options"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>{xe({_id:"",optionId:`option-${Date.now()}`,label:"New Option",description:"Description",icon:"Plus",action:"post-property",isActive:!0,displayOrder:de.length,createdAt:"",updatedAt:""}),ue(!0)},children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"Add Option"]}),e.jsxs(c,{variant:"destructive",size:"sm",onClick:async()=>{if(confirm("Are you sure you want to reset all selling options to defaults?"))try{await i.resetSellingOptions(),t.success("Selling options reset to defaults"),Ce()}catch(e){t.error("Failed to reset options")}},children:[e.jsx(n,{className:"w-4 h-4 mr-2"}),"Reset"]})]})]}),e.jsx("div",{className:"grid gap-4",children:de.map(s=>{const a=ee.find(e=>e.value===s.icon)?.icon||u;return e.jsx(g,{className:s.isActive?"":"opacity-60",children:e.jsxs(b,{className:"flex items-center justify-between p-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(a,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[s.label,!s.isActive&&e.jsx(y,{variant:"secondary",children:"Inactive"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>{xe(s),ue(!0)},children:"Edit"}),e.jsx(c,{variant:"ghost",size:"sm",className:"text-destructive",onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this option?"))try{await i.deleteSellingOption(e),t.success("Option deleted successfully"),Ce()}catch(s){t.error("Failed to delete option")}})(s.optionId),children:e.jsx(B,{className:"w-4 h-4"})})]})]})},s._id)})})]}),e.jsx(j,{value:"filters",className:"space-y-4",children:e.jsxs(g,{children:[e.jsxs(v,{children:[e.jsx(f,{children:"Quick Filters Configuration"}),e.jsx(w,{children:"Configure which filters appear in the quick search popup on the home page"})]}),e.jsxs(b,{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-4 items-end",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(S,{children:"Add Filter"}),e.jsxs(q,{value:be,onValueChange:Ne,children:[e.jsx(P,{children:e.jsx(_,{placeholder:"Select a filter to add"})}),e.jsx(z,{children:fe.filter(e=>!ge.some(s=>s.id===e)).map(s=>e.jsx(T,{value:s,children:we(s)},s))})]})]}),e.jsxs(c,{onClick:()=>{if(!be)return;if(ge.some(e=>e.id===be))return void t.error("Filter already added");const e={id:be,label:we(be),isVisible:!0,displayOrder:ge.length};ve([...ge,e]),Ne("")},disabled:!be,children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"Add"]})]}),e.jsx("div",{className:"space-y-4",children:0===ge.length?e.jsx("div",{className:"text-center py-8 text-muted-foreground border rounded-lg border-dashed",children:"No quick filters configured. Add filters to display them on the home page."}):ge.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(c,{variant:"ghost",size:"icon",className:"h-6 w-6",disabled:0===a,onClick:()=>ke(a,"up"),children:e.jsx(X,{className:"h-4 w-4"})}),e.jsx(c,{variant:"ghost",size:"icon",className:"h-6 w-6",disabled:a===ge.length-1,onClick:()=>ke(a,"down"),children:e.jsx(Z,{className:"h-4 w-4"})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:s.label}),e.jsx(y,{variant:"outline",className:"text-xs font-normal",children:s.id})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.isVisible?"Visible":"Hidden"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(C,{checked:s.isVisible,onCheckedChange:e=>((e,s)=>{ve(a=>a.map(a=>a.id===e?{...a,isVisible:s}:a))})(s.id,e)}),e.jsx(c,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",onClick:()=>{return e=s.id,void ve(s=>s.filter(s=>s.id!==e));var e},children:e.jsx(B,{className:"h-4 w-4"})})]})]},s.id))}),e.jsxs(c,{onClick:async()=>{U(!0);try{await l.setConfigurationMetadata("home_quick_filters",ge,"Home Page Quick Filters Configuration"),t.success("Quick filters saved successfully")}catch(e){t.error("Failed to save quick filters")}finally{U(!1)}},disabled:V,children:[V?e.jsx(r,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(A,{className:"w-4 h-4 mr-2"}),"Save Configuration"]})]})]})})]}),e.jsx(L,{open:te,onOpenChange:re,children:e.jsxs(M,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(E,{children:[e.jsxs(H,{children:["Edit Slide - ",ie?.tabKey]}),e.jsx(K,{children:"Update the content for this hero slide"})]}),ie&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:"Title"}),e.jsx(k,{value:ie.title,onChange:e=>le({...ie,title:e.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:"Description"}),e.jsx($,{value:ie.description,onChange:e=>le({...ie,description:e.target.value}),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:"Image URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{value:ie.imageUrl,onChange:e=>le({...ie,imageUrl:e.target.value}),placeholder:"/assets/Buy.jpg or upload"}),e.jsxs(S,{className:"cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-center px-4 py-2 border rounded-md hover:bg-muted",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Upload"]}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:async e=>{const s=e.target.files?.[0];if(s)try{const e=await i.uploadSlideImage(s);ie&&le({...ie,imageUrl:e.imageUrl}),t.success("Image uploaded successfully")}catch(a){t.error("Failed to upload image")}}})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:"Badge Text"}),e.jsx(k,{value:ie.badge?.text||"",onChange:e=>le({...ie,badge:{...ie.badge,text:e.target.value}})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(S,{children:"Show Badge"}),e.jsx(C,{checked:ie.badge?.isVisible??!0,onCheckedChange:e=>le({...ie,badge:{...ie.badge,isVisible:e}})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(S,{children:"Active"}),e.jsx(C,{checked:ie.isActive,onCheckedChange:e=>le({...ie,isActive:e})})]})]}),e.jsxs(R,{children:[e.jsx(c,{variant:"outline",onClick:()=>re(!1),children:"Cancel"}),e.jsxs(c,{onClick:async()=>{if(ie)if(ie.title?.trim())if(ie.imageUrl?.trim()){U(!0);try{const e={tabKey:ie.tabKey,title:ie.title,description:ie.description||"",imageUrl:ie.imageUrl,isActive:ie.isActive,displayOrder:ie.displayOrder||0};ie.badge&&(e.badge={text:ie.badge.text||"",isVisible:ie.badge.isVisible}),await i.createOrUpdateSlide(e),t.success("Slide saved successfully"),re(!1),Ce()}catch(e){const s=e.response?.data?.message||e.message||"Failed to save slide";t.error(`Error: ${s}`)}finally{U(!1)}}else t.error("Image is required");else t.error("Title is required")},disabled:V,children:[V?e.jsx(r,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(A,{className:"w-4 h-4 mr-2"}),"Save"]})]})]})}),e.jsx(L,{open:me,onOpenChange:ue,children:e.jsxs(M,{children:[e.jsx(E,{children:e.jsxs(H,{children:[he?._id?"Edit":"Add"," Selling Option"]})}),he&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:"Label"}),e.jsx(k,{value:he.label,onChange:e=>xe({...he,label:e.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:"Description"}),e.jsx($,{value:he.description,onChange:e=>xe({...he,description:e.target.value}),rows:2})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:"Icon"}),e.jsxs(q,{value:he.icon,onValueChange:e=>xe({...he,icon:e}),children:[e.jsx(P,{children:e.jsx(_,{})}),e.jsx(z,{children:ee.map(s=>{const a=s.icon;return e.jsx(T,{value:s.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a,{className:"w-4 h-4"}),s.label]})},s.value)})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:"Action"}),e.jsxs(q,{value:he.action,onValueChange:e=>xe({...he,action:e}),children:[e.jsx(P,{children:e.jsx(_,{})}),e.jsx(z,{children:se.map(s=>e.jsx(T,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(S,{children:"Active"}),e.jsx(C,{checked:he.isActive,onCheckedChange:e=>xe({...he,isActive:e})})]})]}),e.jsxs(R,{children:[e.jsx(c,{variant:"outline",onClick:()=>ue(!1),children:"Cancel"}),e.jsxs(c,{onClick:async()=>{if(he){U(!0);try{await i.createOrUpdateSellingOption({optionId:he.optionId,label:he.label,description:he.description,icon:he.icon,action:he.action,isActive:he.isActive,displayOrder:he.displayOrder}),t.success("Option saved successfully"),ue(!1),Ce()}catch(e){t.error("Failed to save option")}finally{U(!1)}}},disabled:V,children:[V?e.jsx(r,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(A,{className:"w-4 h-4 mr-2"}),"Save"]})]})]})})]})};export{ae as default};
