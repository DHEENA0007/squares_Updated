import{j as e}from"./ui-DHQhougw.js";import{d as s,r as a}from"./router-Bi51YGN-.js";import{O as n,f as r,$ as i,a as t,b as l,c,d as o,e as d,B as m}from"./index-D7KzNfIb.js";import{u as p}from"./usePagination-B0D_bLcL.js";import{P as x,a as h,b as j,c as u,d as g,e as f}from"./pagination-CgrKFRZ6.js";import{p as v}from"./planService-CJ3hpiob.js";import{D as b}from"./DataTable-S_GhewXE.js";import{S as N}from"./SearchFilter-K-cvD7fk.js";import"./vendor-eVk5PToZ.js";import"./ellipsis-BjXLGPaY.js";import"./table-4TCBvi1K.js";import"./square-pen-CJbmpsoN.js";const y=()=>{const y=s(),[P,C]=a.useState(""),[S,k]=a.useState("all"),[w,A]=a.useState([]),[F,M]=a.useState(!0);a.useEffect(()=>{(async()=>{try{const e=await v.getPlans({limit:1e3});e.success&&A(e.data.plans)}catch(e){}finally{M(!1)}})()},[]);const L=a.useMemo(()=>w.filter(e=>{const s=e.name.toLowerCase().includes(P.toLowerCase()),a="all"===S||e.billingPeriod===S;return s&&a}),[w,P,S]),{paginatedItems:T,currentPage:V,totalPages:$,goToPage:_,nextPage:B,previousPage:D}=p(L,10),I=[{key:"name",label:"Plan Name",render:s=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.description.substring(0,50),"..."]})]})},{key:"price",label:"Price",render:s=>e.jsx("span",{className:"font-semibold",children:v.formatPrice(s)})},{key:"features",label:"Features",render:s=>{const a=Array.isArray(s.features)?s.features.map(e=>"string"==typeof e?e:e.name):[];return e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.slice(0,2).map((s,a)=>e.jsx(m,{variant:"secondary",className:"text-xs",children:s},a)),a.length>2&&e.jsxs(m,{variant:"secondary",className:"text-xs",children:["+",a.length-2]})]})}},{key:"subscriberCount",label:"Subscribers",render:s=>e.jsx("span",{className:"font-medium",children:s.subscriberCount||0})},{key:"isActive",label:"Status",render:s=>e.jsx(m,{variant:v.getPlanBadgeVariant(s),children:s.isActive?"Active":"Inactive"})}];return F?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(n,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2 text-lg",children:"Loading plans..."})]}):e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"dashboard-header-responsive",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"dashboard-title-responsive",children:"Plan Management"}),e.jsx("p",{className:"text-muted-foreground mt-1 md:mt-2 text-sm md:text-base",children:"Manage subscription plans and pricing"})]}),e.jsxs(r,{onClick:()=>y("/admin/plans/create"),className:"w-full sm:w-auto",children:[e.jsx(i,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Create Plan"}),e.jsx("span",{className:"sm:hidden",children:"Create"})]})]}),e.jsxs(t,{children:[e.jsxs(l,{children:[e.jsx(c,{className:"text-lg md:text-xl",children:"All Plans"}),e.jsxs(o,{className:"text-sm md:text-base",children:[L.length," plan",1!==L.length?"s":""," found"]})]}),e.jsx(d,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{searchTerm:P,onSearchChange:C,filterValue:S,onFilterChange:k,filterOptions:[{label:"Monthly",value:"monthly"},{label:"Yearly",value:"yearly"}],filterPlaceholder:"Filter by billing"}),e.jsx("div",{className:"table-responsive-wrapper",children:e.jsx(b,{columns:I,data:T.map(e=>({...e,id:e._id})),editPath:e=>`/admin/plans/edit/${e._id}`})}),$>1&&e.jsx("div",{className:"mt-4 md:mt-6",children:e.jsx(x,{children:e.jsxs(h,{className:"pagination-responsive",children:[e.jsx(j,{children:e.jsx(u,{onClick:D,className:"pagination-button-responsive "+(1===V?"pointer-events-none opacity-50":"cursor-pointer")})}),Array.from({length:$},(e,s)=>s+1).map(s=>e.jsx(j,{children:e.jsx(g,{onClick:()=>_(s),isActive:V===s,className:"pagination-button-responsive cursor-pointer",children:s})},s)),e.jsx(j,{children:e.jsx(f,{onClick:B,className:"pagination-button-responsive "+(V===$?"pointer-events-none opacity-50":"cursor-pointer")})})]})})})]})})]})]})};export{y as default};
