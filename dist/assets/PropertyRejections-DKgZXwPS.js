import{j as e}from"./ui-BHyUY8Z8.js";import{r}from"./router-2SVJvIbS.js";import{W as A,aC as B,Y as E,I as $,a as v,e as y,b as z,c as F,d as I,h as L,z as O,B as b,f as c,E as _,J as V,K as U,O as H,Q as J,R as K,ap as M}from"./index-Bd1eLXM_.js";import{C as j}from"./circle-alert--1esrBFY.js";import{C as Q}from"./calendar-5Rt0tQ5m.js";import{R as w}from"./rotate-ccw-CKSQ4vff.js";import"./vendor-Dazix4UH.js";const se=()=>{const[d,R]=r.useState([]),[C,p]=r.useState(!0),[o,P]=r.useState(""),[a,g]=r.useState(1),[m,k]=r.useState(1),[t,S]=r.useState(null),[D,n]=r.useState(!1),[x,u]=r.useState({}),{toast:l}=A();r.useEffect(()=>{h()},[a,o]);const h=async()=>{try{p(!0);const s=await fetch(`/api/subadmin/properties/rejected?page=${a}&search=${o}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(s.ok){const i=await s.json();R(i.data.properties),k(i.data.totalPages)}else l({title:"Error",description:"Failed to fetch rejected properties",variant:"destructive"})}catch{l({title:"Error",description:"Error fetching rejected properties",variant:"destructive"})}finally{p(!1)}};B("property_rejected",s=>{l({title:"Property Rejected",description:"A property has been rejected"}),h()});const f=async s=>{try{u({...x,[s]:!0}),(await fetch(`/api/subadmin/properties/${s}/reactivate`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}})).ok?(l({title:"Success",description:"Property reactivated and moved to pending review"}),h()):l({title:"Error",description:"Failed to reactivate property",variant:"destructive"})}catch{l({title:"Error",description:"Failed to reactivate property",variant:"destructive"})}finally{u({...x,[s]:!1})}},N=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(s),T=s=>s.builtUp?`${s.builtUp} ${s.unit}`:s.plot?`${s.plot} ${s.unit}`:s.carpet?`${s.carpet} ${s.unit}`:"N/A";return C&&d.length===0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Property Rejections"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"View and manage rejected property listings"})]}),e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-32 bg-gray-200 rounded-lg"},s))})]}):e.jsxs("div",{className:"p-6 space-y-6 mt-16",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Property Rejections"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"View and manage rejected property listings"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx($,{placeholder:"Search rejected properties by title or city...",value:o,onChange:s=>P(s.target.value),className:"pl-10"})]}),e.jsx("div",{className:"space-y-4",children:d.length===0?e.jsx(v,{children:e.jsxs(y,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(j,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"No Rejected Properties"}),e.jsx("p",{className:"text-muted-foreground text-center",children:"There are no rejected properties at the moment"})]})}):d.map(s=>e.jsxs(v,{className:"border-l-4 border-l-red-500",children:[e.jsx(z,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(F,{className:"text-xl",children:s.title}),e.jsx(I,{className:"space-y-1",children:e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"h-3 w-3"}),s.address.city,", ",s.address.state]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"h-3 w-3"}),"Rejected: ",s.rejectedAt?new Date(s.rejectedAt).toLocaleDateString():"N/A"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(O,{className:"h-3 w-3"}),s.owner.email]})]})}),s.rejectionReason&&e.jsx("div",{className:"bg-red-50 dark:bg-red-950 border border-red-200 dark:border-red-800 rounded-lg p-3 mt-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-900 dark:text-red-100",children:"Rejection Reason:"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:s.rejectionReason}),s.rejectedBy&&e.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:["Rejected by: ",s.rejectedBy.name]})]})]})})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:N(s.price)}),e.jsx(b,{variant:"destructive",className:"mt-1",children:"Rejected"}),e.jsxs(b,{variant:"outline",className:"mt-1 ml-1",children:[s.type," â€¢ ",s.listingType]})]})]})}),e.jsx(y,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>{S(s),n(!0)},children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"View Details"]}),e.jsxs(c,{size:"sm",variant:"secondary",onClick:()=>f(s._id),disabled:x[s._id],children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Reactivate for Review"]})]})})]},s._id))}),m>1&&e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(c,{variant:"outline",disabled:a===1,onClick:()=>g(a-1),children:"Previous"}),e.jsxs("span",{className:"px-3 py-2 text-sm",children:["Page ",a," of ",m]}),e.jsx(c,{variant:"outline",disabled:a===m,onClick:()=>g(a+1),children:"Next"})]}),e.jsx(V,{open:D,onOpenChange:n,children:e.jsxs(U,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(H,{children:[e.jsx(J,{children:t?.title}),e.jsx(K,{children:"Rejected property details and information"})]}),t&&e.jsxs("div",{className:"space-y-4",children:[t.rejectionReason&&e.jsx("div",{className:"bg-red-50 dark:bg-red-950 border border-red-200 dark:border-red-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(j,{className:"h-5 w-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-red-900 dark:text-red-100",children:"Rejection Reason:"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:t.rejectionReason}),t.rejectedBy&&e.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 mt-2",children:["Rejected by: ",t.rejectedBy.name," (",t.rejectedBy.email,")"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Property Details"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Type:"})," ",t.type]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Listing Type:"})," ",t.listingType]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Price:"})," ",N(t.price)]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Area:"})," ",T(t.area)]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Bedrooms:"})," ",t.bedrooms]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Bathrooms:"})," ",t.bathrooms]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Location & Contact"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Address:"})," ",t.address.street]}),e.jsxs("li",{children:[e.jsx("strong",{children:"City:"})," ",t.address.city]}),e.jsxs("li",{children:[e.jsx("strong",{children:"State:"})," ",t.address.state]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Zip Code:"})," ",t.address.zipCode]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Owner:"})," ",t.owner.name]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Email:"})," ",t.owner.email]})]})]})]}),t.description&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Description"}),e.jsx("p",{className:"text-sm",children:t.description})]}),t.images&&t.images.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Images"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:t.images.map((s,i)=>e.jsx("img",{src:s,alt:`Property ${i+1}`,className:"w-full h-32 object-cover rounded"},i))})]})]}),e.jsxs(M,{children:[e.jsx(c,{variant:"outline",onClick:()=>n(!1),children:"Close"}),t&&e.jsxs(c,{variant:"secondary",onClick:()=>{f(t._id),n(!1)},children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Reactivate for Review"]})]})]})})]})};export{se as default};
