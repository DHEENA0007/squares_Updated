import{j as e}from"./ui-CEt46o3G.js";import{r,L as c}from"./router-2SVJvIbS.js";import{C as i,d as n}from"./card-YvDMUmzt.js";import{a as d,P as D,Z as T,U as g,z as F,S as K,I as W,B as N,M as X,D as ee,l as se,m as te,n as u,t as L}from"./index-CiYV0Sy0.js";import{S as V,a as A,b as E,c as U,d as a}from"./select-BHWxeluH.js";import{P as ae}from"./PropertyStatusDialog-42XiT2oq.js";import{p as l}from"./propertyService-vaYzuoi1.js";import{E as f}from"./eye-CDS1ofgA.js";import{C as re}from"./camera-2k-Wb9vt.js";import{E as le}from"./ellipsis-vertical-CarBFatF.js";import{P as k}from"./pen-line-hrB0mI2q.js";import{T as M}from"./trending-up-BLutZFyR.js";import{T as ie}from"./trash-2-Dj_If1Zn.js";import{C as ne}from"./calendar-DWj9NFdt.js";import"./vendor-Dazix4UH.js";import"./index-BdQq_4o_.js";import"./index-DHzxUTm5.js";import"./chevron-down-DeDu0PPf.js";import"./dialog-B2oiH0OC.js";import"./label-BV_cIshD.js";import"./textarea-BbecYreM.js";const Le=()=>{const[o,_]=r.useState(""),[m,z]=r.useState("all"),[x,B]=r.useState("all"),[v,w]=r.useState(!0),[b,I]=r.useState([]),[$,S]=r.useState(!1),[R,O]=r.useState(null),[j,G]=r.useState({totalProperties:0,totalViews:0,totalLeads:0,averageRating:0}),[de,Q]=r.useState({currentPage:1,totalPages:1,totalProperties:0,hasNextPage:!1,hasPrevPage:!1});r.useEffect(()=>{h(),p()},[]),r.useEffect(()=>{h()},[o,m,x]);const h=async()=>{try{w(!0);const s={page:1,limit:10,...o&&{search:o},...m!=="all"&&{status:m},...x!=="all"&&{propertyType:x}},t=await l.getVendorProperties(s);I(t.data.properties),Q(t.data.pagination)}catch(s){console.error("Failed to load properties:",s)}finally{w(!1)}},p=async()=>{try{const s=await l.getVendorPropertyStats();G(s)}catch(s){console.error("Failed to load stats:",s)}},Y=async s=>{if(window.confirm("Are you sure you want to delete this property?"))try{await l.deleteProperty(s),h(),p()}catch(t){console.error("Failed to delete property:",t)}},P=async(s,t)=>{try{await l.togglePropertyFeatured(s,!t),h()}catch(C){console.error("Failed to toggle featured status:",C)}},H=async(s,t,C)=>{try{await l.togglePropertyStatus(s,t),h(),p(),L({title:"Success",description:`Property status updated to ${t}!`})}catch(J){console.error("Failed to update property status:",J),L({title:"Error",description:"Failed to update property status",variant:"destructive"})}},y=s=>{O(s),S(!0)},Z=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),q=s=>{const t=[];return s.address.locationName&&t.push(s.address.locationName),s.address.city&&t.push(s.address.city),s.address.state&&t.push(s.address.state),t.join(", ")||"Location not specified"};return v?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading properties..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"My Properties"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage and track your property listings"})]}),e.jsx(c,{to:"/vendor/properties/add",children:e.jsxs(d,{children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Add Property"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Properties"}),e.jsx("p",{className:"text-2xl font-bold",children:j.totalProperties})]}),e.jsx(T,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Views"}),e.jsx("p",{className:"text-2xl font-bold",children:j.totalViews.toLocaleString()})]}),e.jsx(f,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Leads"}),e.jsx("p",{className:"text-2xl font-bold",children:j.totalLeads})]}),e.jsx(g,{className:"h-8 w-8 text-purple-600"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Avg. Rating"}),e.jsx("p",{className:"text-2xl font-bold",children:j.averageRating.toFixed(1)})]}),e.jsx(F,{className:"h-8 w-8 text-orange-600"})]})})})]}),e.jsx(i,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(K,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(W,{placeholder:"Search properties...",value:o,onChange:s=>_(s.target.value),className:"pl-10"})]}),e.jsxs(V,{value:m,onValueChange:z,children:[e.jsx(A,{className:"w-full sm:w-40",children:e.jsx(E,{placeholder:"Status"})}),e.jsxs(U,{children:[e.jsx(a,{value:"all",children:"All Status"}),e.jsx(a,{value:"available",children:"Available"}),e.jsx(a,{value:"pending",children:"Pending"}),e.jsx(a,{value:"sold",children:"Sold"}),e.jsx(a,{value:"rented",children:"Rented"})]})]}),e.jsxs(V,{value:x,onValueChange:B,children:[e.jsx(A,{className:"w-full sm:w-40",children:e.jsx(E,{placeholder:"Type"})}),e.jsxs(U,{children:[e.jsx(a,{value:"all",children:"All Types"}),e.jsx(a,{value:"apartment",children:"Apartment"}),e.jsx(a,{value:"house",children:"House"}),e.jsx(a,{value:"villa",children:"Villa"}),e.jsx(a,{value:"plot",children:"Plot"}),e.jsx(a,{value:"land",children:"Land"}),e.jsx(a,{value:"commercial",children:"Commercial"}),e.jsx(a,{value:"office",children:"Office"}),e.jsx(a,{value:"pg",children:"PG (Paying Guest)"})]})]})]})})}),e.jsx("div",{className:"space-y-4",children:b.map(s=>e.jsx(i,{className:"overflow-hidden",children:e.jsx(n,{className:"p-0",children:e.jsxs("div",{className:"flex flex-col lg:flex-row",children:[e.jsxs("div",{className:"lg:w-64 h-48 lg:h-auto bg-muted relative",children:[e.jsx("img",{src:l.getPrimaryImage(s),alt:s.title,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/20 to-transparent flex items-center justify-center",children:e.jsx(re,{className:"w-12 h-12 text-muted-foreground"})}),e.jsxs("div",{className:"absolute top-3 left-3 flex gap-2",children:[e.jsx(N,{className:`${l.getStatusColor(s.status)} text-white`,children:l.getStatusText(s.status)}),s.featured&&e.jsx(N,{variant:"secondary",children:"Featured"}),s.verified&&e.jsx(N,{className:"bg-green-600 text-white",children:"Verified"})]}),e.jsxs("div",{className:"absolute bottom-3 left-3 bg-black/70 text-white px-2 py-1 rounded text-sm",children:[s.images.length," photos"]})]}),e.jsxs("div",{className:"flex-1 p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-1",children:s.title}),e.jsxs("p",{className:"text-muted-foreground flex items-center mb-2",children:[e.jsx(X,{className:"w-4 h-4 mr-1"}),q(s)]}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:l.formatPrice(s.price,s.listingType)})]}),e.jsxs(ee,{children:[e.jsx(se,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"icon",children:e.jsx(le,{className:"w-4 h-4"})})}),e.jsxs(te,{align:"end",children:[e.jsx(u,{asChild:!0,children:e.jsxs(c,{to:`/vendor/properties/details/${s._id}`,children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"View Details"]})}),e.jsx(u,{asChild:!0,children:e.jsxs(c,{to:`/vendor/properties/edit/${s._id}`,children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Edit Property"]})}),e.jsxs(u,{onClick:()=>P(s._id,s.featured),children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),s.featured?"Unfeature":"Promote"]}),e.jsxs(u,{onClick:()=>y(s),children:[e.jsx(g,{className:"w-4 h-4 mr-2"}),"Update Status"]}),e.jsxs(u,{className:"text-red-600",onClick:()=>Y(s._id),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[s.bedrooms>0&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bedrooms"}),e.jsx("p",{className:"font-semibold",children:s.bedrooms})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bathrooms"}),e.jsx("p",{className:"font-semibold",children:s.bathrooms})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Area"}),e.jsx("p",{className:"font-semibold",children:l.formatArea(s.area)})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Type"}),e.jsx("p",{className:"font-semibold capitalize",children:s.type})]})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm text-muted-foreground mb-4",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(f,{className:"w-4 h-4 mr-1"}),s.views," views"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(g,{className:"w-4 h-4 mr-1"}),"0 leads"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(F,{className:"w-4 h-4 mr-1"}),"0 favorites"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(ne,{className:"w-4 h-4 mr-1"}),"Listed ",Z(s.createdAt)]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{to:`/vendor/properties/details/${s._id}`,children:e.jsxs(d,{size:"sm",variant:"outline",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"View Details"]})}),e.jsx(c,{to:`/vendor/properties/edit/${s._id}`,children:e.jsxs(d,{size:"sm",variant:"outline",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Edit"]})}),e.jsxs(d,{size:"sm",onClick:()=>P(s._id,s.featured),children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),s.featured?"Unfeature":"Promote"]}),e.jsx(d,{size:"sm",variant:"outline",onClick:()=>y(s),children:"Update Status"})]})]})]})})},s._id))}),b.length===0&&!v&&e.jsx(i,{children:e.jsxs(n,{className:"p-12 text-center",children:[e.jsx(T,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No properties found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:o||m!=="all"||x!=="all"?"No properties match your search criteria":"You haven't added any properties yet"}),e.jsx(c,{to:"/vendor/properties/add",children:e.jsxs(d,{children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Add Your First Property"]})})]})}),e.jsx(ae,{property:R,open:$,onOpenChange:S,onUpdateStatus:H})]})};export{Le as default};
