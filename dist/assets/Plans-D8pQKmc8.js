import{j as e}from"./ui-BHyUY8Z8.js";import{d as k,r}from"./router-2SVJvIbS.js";import{H as A,f as w,V as F,a as B,b as L,c as T,d as M,e as D,B as d}from"./index-Bd1eLXM_.js";import{u as E}from"./usePagination-DI7D6ysW.js";import{P as I,a as V,b as m,c as _,d as H,e as O}from"./pagination-Rt-SIkt9.js";import{p as x}from"./planService-CRX5BtDQ.js";import{D as R}from"./DataTable-CTGqJfvj.js";import{S as Y}from"./SearchFilter-CUuDsF9n.js";import"./vendor-Dazix4UH.js";import"./ellipsis-CXpaKV_5.js";import"./table-DaOINtos.js";import"./square-pen-B2xeg6m_.js";const se=()=>{const u=k(),[i,p]=r.useState(""),[n,g]=r.useState("all"),[h,f]=r.useState([]),[j,P]=r.useState(!0);r.useEffect(()=>{(async()=>{try{const a=await x.getPlans({limit:1e3});a.success&&f(a.data.plans)}catch(a){console.error("Failed to fetch plans:",a)}finally{P(!1)}})()},[]);const l=r.useMemo(()=>h.filter(s=>{const a=s.name.toLowerCase().includes(i.toLowerCase()),t=n==="all"||s.billingPeriod===n;return a&&t}),[h,i,n]),{paginatedItems:v,currentPage:c,totalPages:o,goToPage:y,nextPage:b,previousPage:N}=E(l,10),C=[{key:"name",label:"Plan Name",render:s=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.description.substring(0,50),"..."]})]})},{key:"price",label:"Price",render:s=>e.jsx("span",{className:"font-semibold",children:x.formatPrice(s)})},{key:"features",label:"Features",render:s=>{const a=Array.isArray(s.features)?s.features.map(t=>typeof t=="string"?t:t.name):[];return e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.slice(0,2).map((t,S)=>e.jsx(d,{variant:"secondary",className:"text-xs",children:t},S)),a.length>2&&e.jsxs(d,{variant:"secondary",className:"text-xs",children:["+",a.length-2]})]})}},{key:"subscriberCount",label:"Subscribers",render:s=>e.jsx("span",{className:"font-medium",children:s.subscriberCount||0})},{key:"isActive",label:"Status",render:s=>e.jsx(d,{variant:x.getPlanBadgeVariant(s),children:s.isActive?"Active":"Inactive"})}];return j?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(A,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2 text-lg",children:"Loading plans..."})]}):e.jsxs("div",{className:"space-y-6 relative top-[60px]",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Plan Management"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage subscription plans and pricing"})]}),e.jsxs(w,{onClick:()=>u("/admin/plans/create"),children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Create Plan"]})]}),e.jsxs(B,{children:[e.jsxs(L,{children:[e.jsx(T,{children:"All Plans"}),e.jsxs(M,{children:[l.length," plan",l.length!==1?"s":""," found"]})]}),e.jsxs(D,{children:[e.jsx(Y,{searchTerm:i,onSearchChange:p,filterValue:n,onFilterChange:g,filterOptions:[{label:"Monthly",value:"monthly"},{label:"Yearly",value:"yearly"}],filterPlaceholder:"Filter by billing"}),e.jsx(R,{columns:C,data:v.map(s=>({...s,id:s._id})),editPath:s=>`/admin/plans/edit/${s._id}`}),o>1&&e.jsx("div",{className:"mt-6",children:e.jsx(I,{children:e.jsxs(V,{children:[e.jsx(m,{children:e.jsx(_,{onClick:N,className:c===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:o},(s,a)=>a+1).map(s=>e.jsx(m,{children:e.jsx(H,{onClick:()=>y(s),isActive:c===s,className:"cursor-pointer",children:s})},s)),e.jsx(m,{children:e.jsx(O,{onClick:b,className:c===o?"pointer-events-none opacity-50":"cursor-pointer"})})]})})})]})]})]})};export{se as default};
