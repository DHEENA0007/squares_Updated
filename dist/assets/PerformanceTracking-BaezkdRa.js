import{j as e}from"./ui-DYmpZ3pJ.js";import{r as c}from"./router-2SVJvIbS.js";import{a as l,e as i,p as u,q as f,r as p,s as N,v as a,f as d,U as y,au as C,a9 as b,E as S,B as R,w as k,Y as E}from"./index-BbgqWuYN.js";import{P as U}from"./progress-DsTiBTsG.js";import{T as x}from"./trending-up-CE6F-QOW.js";import{T as m}from"./trending-down-Dn582NAf.js";import"./vendor-Dazix4UH.js";const _=()=>{const[n,M]=c.useState([]),[T,v]=c.useState(!0),[o,P]=c.useState("totalProperties"),[h,$]=c.useState("all"),[j,V]=c.useState("30d"),w=async()=>{v(!0);try{const s=new URLSearchParams({sortBy:o,status:h,timeRange:j}),t=await fetch(`/api/admin/vendors/performance?${s}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(t.ok){const g=await t.json();M(g.vendors)}}catch(s){console.error("Failed to fetch vendor performance:",s)}finally{v(!1)}};c.useEffect(()=>{w()},[o,h,j]);const L=s=>{const{metrics:t}=s,g=Math.min(t.averageRating/5,1)*25+Math.min(t.responseRate/100,1)*25+Math.min(t.conversionRate/10,1)*25+Math.max(0,Math.min((100-t.responseTime)/100,1))*25;return Math.round(g)},B=s=>s>=80?"text-green-600":s>=60?"text-yellow-600":"text-red-600",A=s=>s>=80?"bg-green-100 text-green-800":s>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",r=s=>s>=0?"text-green-600":"text-red-600",F=s=>s<1?`${Math.round(s*60)} min`:s<24?`${Math.round(s)} hr`:`${Math.round(s/24)} day`;return T?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Performance Tracking"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Monitor vendor and builder performance metrics"})]})}),e.jsx(l,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"w-full sm:w-48",children:e.jsxs(u,{value:o,onValueChange:P,children:[e.jsx(f,{children:e.jsx(p,{})}),e.jsxs(N,{children:[e.jsx(a,{value:"totalProperties",children:"Total Properties"}),e.jsx(a,{value:"viewsThisMonth",children:"Monthly Views"}),e.jsx(a,{value:"leadsThisMonth",children:"Monthly Leads"}),e.jsx(a,{value:"averageRating",children:"Rating"}),e.jsx(a,{value:"responseRate",children:"Response Rate"}),e.jsx(a,{value:"performanceScore",children:"Performance Score"})]})]})}),e.jsx("div",{className:"w-full sm:w-48",children:e.jsxs(u,{value:h,onValueChange:$,children:[e.jsx(f,{children:e.jsx(p,{})}),e.jsxs(N,{children:[e.jsx(a,{value:"all",children:"All Status"}),e.jsx(a,{value:"active",children:"Active"}),e.jsx(a,{value:"inactive",children:"Inactive"}),e.jsx(a,{value:"suspended",children:"Suspended"})]})]})}),e.jsx("div",{className:"w-full sm:w-48",children:e.jsxs(u,{value:j,onValueChange:V,children:[e.jsx(f,{children:e.jsx(p,{})}),e.jsxs(N,{children:[e.jsx(a,{value:"7d",children:"Last 7 days"}),e.jsx(a,{value:"30d",children:"Last 30 days"}),e.jsx(a,{value:"90d",children:"Last 90 days"}),e.jsx(a,{value:"1y",children:"Last year"})]})]})}),e.jsx(d,{onClick:w,variant:"outline",children:"Refresh Data"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(l,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Vendors"})]})]})})}),e.jsx(l,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.reduce((s,t)=>s+t.metrics.totalProperties,0)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Properties"})]})]})})}),e.jsx(l,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-8 h-8 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.length>0?(n.reduce((s,t)=>s+t.metrics.averageRating,0)/n.length).toFixed(1):"0.0"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Rating"})]})]})})}),e.jsx(l,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.reduce((s,t)=>s+t.metrics.viewsThisMonth,0).toLocaleString()}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Monthly Views"})]})]})})})]}),e.jsx("div",{className:"space-y-4",children:n.map(s=>{const t=L(s);return e.jsx(l,{className:"hover:shadow-md transition-shadow",children:e.jsx(i,{className:"pt-6",children:e.jsx("div",{className:"flex flex-col lg:flex-row gap-6",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:s.vendor.name}),e.jsx("p",{className:"text-muted-foreground",children:s.vendor.company}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.vendor.email})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(R,{className:A(t),children:["Score: ",t,"/100"]}),e.jsx(R,{variant:"outline",children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Overall Performance"}),e.jsxs("span",{className:B(t),children:[t,"%"]})]}),e.jsx(U,{value:t,className:"h-2"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(C,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-lg font-bold",children:s.metrics.totalProperties})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Properties"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(S,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-lg font-bold",children:s.metrics.viewsThisMonth.toLocaleString()})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Monthly Views"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(k,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-lg font-bold",children:s.metrics.leadsThisMonth})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Monthly Leads"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(b,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-lg font-bold",children:s.metrics.averageRating.toFixed(1)})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Avg Rating"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Response Rate:"}),e.jsxs("span",{className:"font-medium",children:[s.metrics.responseRate,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Response Time:"}),e.jsx("span",{className:"font-medium",children:F(s.metrics.responseTime)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Conversion Rate:"}),e.jsxs("span",{className:"font-medium",children:[s.metrics.conversionRate,"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.trends.propertiesChange>=0?e.jsx(x,{className:`w-4 h-4 ${r(s.trends.propertiesChange)}`}):e.jsx(m,{className:`w-4 h-4 ${r(s.trends.propertiesChange)}`}),e.jsxs("span",{className:`text-sm ${r(s.trends.propertiesChange)}`,children:[s.trends.propertiesChange>=0?"+":"",s.trends.propertiesChange," properties"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.trends.viewsChange>=0?e.jsx(x,{className:`w-4 h-4 ${r(s.trends.viewsChange)}`}):e.jsx(m,{className:`w-4 h-4 ${r(s.trends.viewsChange)}`}),e.jsxs("span",{className:`text-sm ${r(s.trends.viewsChange)}`,children:[s.trends.viewsChange>=0?"+":"",s.trends.viewsChange,"% views"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.trends.leadsChange>=0?e.jsx(x,{className:`w-4 h-4 ${r(s.trends.leadsChange)}`}):e.jsx(m,{className:`w-4 h-4 ${r(s.trends.leadsChange)}`}),e.jsxs("span",{className:`text-sm ${r(s.trends.leadsChange)}`,children:[s.trends.leadsChange>=0?"+":"",s.trends.leadsChange,"% leads"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.trends.ratingChange>=0?e.jsx(x,{className:`w-4 h-4 ${r(s.trends.ratingChange)}`}):e.jsx(m,{className:`w-4 h-4 ${r(s.trends.ratingChange)}`}),e.jsxs("span",{className:`text-sm ${r(s.trends.ratingChange)}`,children:[s.trends.ratingChange>=0?"+":"",s.trends.ratingChange.toFixed(1)," rating"]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(d,{variant:"outline",size:"sm",children:"View Details"}),e.jsxs(d,{variant:"outline",size:"sm",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Contact Vendor"]}),s.status==="active"&&t<50&&e.jsx(d,{variant:"outline",size:"sm",className:"text-orange-600",children:"Send Warning"})]})]})})})},s._id)})}),n.length===0&&e.jsx(l,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(y,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Vendors Found"}),e.jsx("p",{className:"text-muted-foreground",children:"No vendors match your current filters."})]})})})]})};export{_ as default};
