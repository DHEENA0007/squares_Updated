import{j as e}from"./ui-BNZSgpjP.js";import{r as s}from"./router-D8v2YSKU.js";import{a2 as t,G as a,a3 as r,L as i,ac as l,q as d,r as c,s as m,v as n,w as o,I as x}from"./index-CWpkTP43.js";import{C as f}from"./checkbox-D5xGP9Cy.js";import{A as h,a as u}from"./alert-BhasSlDe.js";const p=({propertyTypeId:p,values:N,onChange:j,errors:g={},onValidationChange:y})=>{const[b,v]=s.useState([]),[L,C]=s.useState(!0),{toast:$}=t();s.useEffect(()=>{if(!y||0===b.length)return;const e={};b.forEach(s=>{if(s.isRequired){const t=N[s.fieldName];(!t||"string"==typeof t&&""===t.trim())&&(e[s.fieldName]=`${s.fieldLabel} is required`)}});const s=0===Object.keys(e).length;y(s,e)},[N,b,y]),s.useEffect(()=>{(async()=>{if(!p)return v([]),void C(!1);try{C(!0);const e=(await r.getPropertyTypeFields(p,!1)).sort((e,s)=>e.displayOrder-s.displayOrder);v(e)}catch(e){$({title:"Error",description:"Failed to load property fields",variant:"destructive"}),v([])}finally{C(!1)}})()},[p,$]);if(L)return e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(a,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"Loading property fields..."})]});if(0===b.length)return e.jsx(h,{children:e.jsx(u,{children:"No custom fields configured for this property type. The property type may be using default fields."})});const q=[];for(let e=0;e<b.length;e+=3)q.push(b.slice(e,e+3));return e.jsx("div",{className:"space-y-6",children:q.map((s,t)=>e.jsx("div",{className:`grid grid-cols-1 ${1===s.length?"md:grid-cols-1":2===s.length?"md:grid-cols-2":"sm:grid-cols-2 lg:grid-cols-3"} gap-4 md:gap-6`,children:s.map(s=>(s=>{const t=N[s.fieldName]??"",a=!!g[s.fieldName];switch(s.fieldType){case"text":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:s.fieldName,className:"text-sm md:text-base",children:[s.fieldLabel," ",s.isRequired&&"*"]}),e.jsx(x,{id:s.fieldName,value:t,onChange:e=>j(s.fieldName,e.target.value),placeholder:`Enter ${s.fieldLabel.toLowerCase()}`,className:"text-sm md:text-base "+(a?"border-destructive":"")}),a&&e.jsx("p",{className:"text-sm text-destructive",children:g[s.fieldName]})]},s._id);case"number":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:s.fieldName,className:"text-sm md:text-base",children:[s.fieldLabel," ",s.isRequired&&"*"]}),e.jsx(x,{id:s.fieldName,type:"number",value:t,onChange:e=>j(s.fieldName,e.target.value),placeholder:`Enter ${s.fieldLabel.toLowerCase()}`,className:"text-sm md:text-base "+(a?"border-destructive":"")}),a&&e.jsx("p",{className:"text-sm text-destructive",children:g[s.fieldName]})]},s._id);case"select":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:s.fieldName,className:"text-sm md:text-base",children:[s.fieldLabel," ",s.isRequired&&"*"]}),e.jsxs(d,{value:t,onValueChange:e=>j(s.fieldName,e),children:[e.jsx(c,{className:"text-sm md:text-base "+(a?"border-destructive":""),children:e.jsx(m,{placeholder:`Select ${s.fieldLabel.toLowerCase()}`})}),e.jsx(n,{children:s.fieldOptions?.map(s=>e.jsx(o,{value:s,className:"text-sm md:text-base",children:s},s))})]}),a&&e.jsx("p",{className:"text-sm text-destructive",children:g[s.fieldName]})]},s._id);case"multiselect":const r=Array.isArray(t)?t:[];return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{className:"text-sm md:text-base",children:[s.fieldLabel," ",s.isRequired&&"*"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 p-4 border rounded-lg",children:s.fieldOptions?.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{id:`${s.fieldName}-${t}`,checked:r.includes(t),onCheckedChange:e=>{const a=e?[...r,t]:r.filter(e=>e!==t);j(s.fieldName,a)}}),e.jsx(i,{htmlFor:`${s.fieldName}-${t}`,className:"text-sm font-normal cursor-pointer",children:t})]},t))}),a&&e.jsx("p",{className:"text-sm text-destructive",children:g[s.fieldName]})]},s._id);case"boolean":return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs(i,{htmlFor:s.fieldName,className:"text-sm md:text-base",children:[s.fieldLabel," ",s.isRequired&&"*"]}),e.jsx(l,{id:s.fieldName,checked:!0===t||"true"===t,onCheckedChange:e=>j(s.fieldName,e)}),a&&e.jsx("p",{className:"text-sm text-destructive",children:g[s.fieldName]})]},s._id);default:return null}})(s))},t))})};export{p as D};
