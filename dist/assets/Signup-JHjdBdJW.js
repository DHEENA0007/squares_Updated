import{j as e}from"./ui-DHQhougw.js";import{d as s,r as a}from"./router-Bi51YGN-.js";import{N as t,L as l,I as r,f as i,F as n,t as c,y as o}from"./index-BElMMwCt.js";import{I as d,a as m,b as h}from"./input-otp-CVcNmOnY.js";import"./vendor-eVk5PToZ.js";const u=()=>e.jsx("div",{className:"w-full h-auto flex items-center justify-center",children:e.jsx("img",{src:"/v2/assets/reg-pg.2zN6ULKb.png",alt:"Signup Illustration",className:"w-full h-auto max-w-4xl"})}),x=()=>{const x=s(),[p,g]=a.useState("form"),[f,j]=a.useState(""),[v,N]=a.useState(!1),[b,w]=a.useState(0),[y,P]=a.useState(!0),[k,C]=a.useState({firstName:"",lastName:"",email:"",phone:"",password:"",confirmPassword:""}),[S,T]=a.useState({checking:!1,available:null,message:""});return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(t,{}),e.jsx("main",{className:"flex-1 flex items-center justify-center px-4 py-12 bg-gradient-to-br from-background to-accent/10",children:e.jsxs("div",{className:"w-full max-w-6xl grid lg:grid-cols-2 gap-8 items-center",children:[e.jsx("div",{className:"hidden lg:block",children:e.jsx("div",{className:"w-full h-auto rounded-2xl shadow-2xl bg-gradient-to-br from-blue-50 to-indigo-100 overflow-hidden",children:e.jsx(u,{})})}),e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsxs("div",{className:"bg-card rounded-2xl shadow-xl p-8 border",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Create Account"}),e.jsx("p",{className:"text-muted-foreground",children:"form"===p?"Sign up to get started with BuildHomeMart":"Enter the OTP sent to your email"})]}),"form"===p?e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),k.firstName&&k.lastName&&k.email&&k.phone&&k.password&&k.confirmPassword)if(k.password===k.confirmPassword)if(k.password.length<6)c({title:"Error",description:"Password must be at least 6 characters",variant:"destructive"});else if(/^\d{10}$/.test(k.phone))if(!1!==S.available){N(!0);try{const e=await o.sendOTP(k.email,k.firstName,k.phone);e.success&&(g("otp"),w(e.expiryMinutes||10))}catch(s){}finally{N(!1)}}else c({title:"Error",description:S.message||"Phone number is not available",variant:"destructive"});else c({title:"Error",description:"Please enter a valid 10-digit phone number",variant:"destructive"});else c({title:"Error",description:"Passwords do not match",variant:"destructive"});else c({title:"Error",description:"Please fill in all fields",variant:"destructive"})},className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"firstName",children:"First Name *"}),e.jsx(r,{id:"firstName",type:"text",placeholder:"First name",value:k.firstName,onChange:e=>C({...k,firstName:e.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"lastName",children:"Last Name *"}),e.jsx(r,{id:"lastName",type:"text",placeholder:"Last name",value:k.lastName,onChange:e=>C({...k,lastName:e.target.value}),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"email",children:"Email *"}),e.jsx(r,{id:"email",type:"email",placeholder:"Enter your email",value:k.email,onChange:e=>C({...k,email:e.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"phone",children:"Phone Number *"}),e.jsx(r,{id:"phone",type:"tel",placeholder:"10-digit phone number",value:k.phone,onChange:e=>{const s=e.target.value.replace(/\D/g,"").slice(0,10);C({...k,phone:s}),10===s.length?setTimeout(()=>(async e=>{if(10===e.length){T({checking:!0,available:null,message:""});try{const s=await o.checkPhoneAvailability(e);T({checking:!1,available:s.available,message:s.message})}catch(s){T({checking:!1,available:!1,message:"Unable to validate phone number"})}}else T({checking:!1,available:null,message:""})})(s),500):T({checking:!1,available:null,message:""})},required:!0,className:!1===S.available?"border-red-500":!0===S.available?"border-green-500":""}),S.checking&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Checking availability..."}),!1===S.available&&e.jsx("p",{className:"text-xs text-red-500",children:S.message}),!0===S.available&&e.jsx("p",{className:"text-xs text-green-600",children:S.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"password",children:"Password *"}),e.jsx(r,{id:"password",type:"password",placeholder:"Create a password",value:k.password,onChange:e=>C({...k,password:e.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"confirmPassword",children:"Confirm Password *"}),e.jsx(r,{id:"confirmPassword",type:"password",placeholder:"Re-enter your password",value:k.confirmPassword,onChange:e=>C({...k,confirmPassword:e.target.value}),required:!0})]}),e.jsx(i,{type:"submit",className:"w-full",size:"lg",disabled:v,children:v?"Creating Account...":"Create Account"}),e.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:["Already have an account?"," ",e.jsx("a",{href:"/login",className:"text-primary font-medium hover:underline",children:"Sign in"})]})]}):"otp"===p?e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),6===f.length){N(!0);try{(await o.register({email:k.email,password:k.password,firstName:k.firstName,lastName:k.lastName,phone:k.phone,role:"customer",agreeToTerms:!0,otp:f})).success&&(g("success"),c({title:"Registration Successful!",description:"Your account has been created successfully. Redirecting to login..."}),setTimeout(()=>{x("/login")},3e3))}catch(s){j("")}finally{N(!1)}}else c({title:"Error",description:"Please enter the 6-digit OTP",variant:"destructive"})},className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(l,{className:"text-center block",children:"Enter 6-Digit OTP"}),e.jsx("div",{className:"flex justify-center",children:e.jsx(d,{maxLength:6,value:f,onChange:e=>j(e),children:e.jsxs(m,{children:[e.jsx(h,{index:0}),e.jsx(h,{index:1}),e.jsx(h,{index:2}),e.jsx(h,{index:3}),e.jsx(h,{index:4}),e.jsx(h,{index:5})]})})}),e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["OTP sent to ",k.email]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(i,{type:"submit",className:"w-full",size:"lg",disabled:v,children:v?"Verifying...":"Register"}),e.jsx(i,{type:"button",variant:"outline",className:"w-full",onClick:async()=>{try{N(!0),await o.sendOTP(k.email,k.firstName,k.phone),j("")}catch(e){}finally{N(!1)}},disabled:v,children:"Resend OTP"}),e.jsx(i,{type:"button",variant:"ghost",className:"w-full",onClick:()=>g("form"),children:"Back to Form"})]})]}):"success"===p?e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-green-600 mb-2",children:"Account Created Successfully!"}),e.jsx("p",{className:"text-muted-foreground",children:"Your account has been created and email verified. Redirecting to login page..."})]}),e.jsx(i,{onClick:()=>x("/login"),className:"w-full",children:"Continue to Login"})]}):null]})})]})}),e.jsx(n,{})]})};export{x as default};
