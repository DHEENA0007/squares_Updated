import{j as e}from"./ui-CEFKCYQo.js";import{d as s,r as a,L as t}from"./router-Bi51YGN-.js";import{D as r,aR as l,t as i,aE as c,f as d,aQ as n,I as o,S as m,r as x,s as h,v as p,w as u,a as f,e as j,V as v,aH as g,Q as N,h as b,B as w}from"./index-Ds-LUfCl.js";import{C as y}from"./checkbox-DscVYI3N.js";import{f as k}from"./favoriteService-BQ5QkAl-.js";import{a as C}from"./propertyUtils-41DuwCMc.js";import{u as S}from"./use-mobile-WsBtvUz6.js";import{T as $}from"./trash-2-lrlF_EY_.js";import{C as P}from"./calendar-CC4c2MNn.js";import{S as F}from"./share-Cc0OZPI3.js";import"./vendor-eVk5PToZ.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=r("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]),_=()=>{const{isConnected:r}=l(),_=s(),L=S(),[D,M]=a.useState([]),[q,z]=a.useState(null),[E,R]=a.useState(!0),[T,U]=a.useState(""),[V,B]=a.useState("all"),[Q,H]=a.useState([]),I=a.useCallback(async()=>{try{const e=await k.getFavorites();M(e.data.favorites)}catch(e){i({title:"Error",description:"Failed to load favorites",variant:"destructive"})}finally{R(!1)}},[]),W=a.useCallback(async()=>{try{const e=await k.getFavoriteStats();z(e.data)}catch(e){}},[]);c("favorite_added",a.useCallback(e=>{I(),W()},[I,W])),c("favorite_removed",a.useCallback(e=>{I(),W()},[I,W])),a.useEffect(()=>{I(),W()},[]);const G=D.filter(e=>{const s=e.property;if(!s)return!1;const a="string"==typeof s.address?s.address:s.address.district?`${s.address.street||""} ${s.address.city||""} ${s.address.district||""} ${s.address.state||""}`.trim():`${s.address.street||""} ${s.address.city||""} ${s.address.state||""}`.trim(),t="string"==typeof s.city?s.city:s.address?.city||"",r=!T||s.title.toLowerCase().includes(T.toLowerCase())||a.toLowerCase().includes(T.toLowerCase())||t.toLowerCase().includes(T.toLowerCase()),l=!V||"all"===V||"available"===V&&"available"===s.status||"sold"===V&&"sold"===s.status||"rented"===V&&"rented"===s.status||"recent"===V&&new Date(e.createdAt)>new Date(Date.now()-6048e5);return r&&l});return E?e.jsx("div",{className:"min-h-screen bg-background p-6 pt-24",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-lg",children:"Loading favorites..."})})})}):e.jsx("div",{className:"min-h-screen bg-background p-6 pt-24",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"My Favorites"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your saved properties and track your preferences"})]}),Q.length>0&&e.jsxs("div",{className:"flex gap-2 "+(L?"flex-col":"flex-row"),children:[e.jsxs(d,{variant:"outline",onClick:()=>{Q.length<1?i({title:"Select Properties",description:"Please select at least 1 property to compare",variant:"destructive"}):_(`/customer/compare?properties=${Q.join(",")}`)},disabled:Q.length<1,className:"w-full sm:w-fit",children:[e.jsx(n,{className:"w-4 h-4 mr-2"}),"Compare (",Q.length,")"]}),e.jsxs(d,{variant:"destructive",onClick:async()=>{try{await Promise.all(Q.map(e=>k.removeFromFavorites(e))),H([]),await I(),await W(),i({title:"Success",description:`${Q.length} properties removed from favorites`})}catch(e){i({title:"Error",description:"Failed to remove selected favorites",variant:"destructive"})}},className:"w-full sm:w-fit",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Remove Selected (",Q.length,")"]})]})]}),e.jsxs("div",{className:"flex gap-4 "+(L?"flex-col":"flex-row"),children:[e.jsx("div",{className:"flex-1",children:e.jsx(o,{placeholder:"Search favorites...",value:T,onChange:e=>U(e.target.value),className:"w-full"})}),e.jsxs("div",{className:"flex gap-2 "+(L?"flex-col":"flex-row"),children:[G.length>0&&e.jsx(d,{variant:"outline",size:"sm",onClick:()=>{Q.length===G.length?H([]):H(G.map(e=>e.property._id))},className:"w-full sm:w-auto",children:Q.length===G.length?"Deselect All":"Select All"}),e.jsxs(m,{value:V,onValueChange:B,children:[e.jsx(x,{className:"w-full sm:w-auto md:w-48",children:e.jsx(h,{placeholder:"Filter by status"})}),e.jsxs(p,{children:[e.jsx(u,{value:"all",children:"All Properties"}),e.jsx(u,{value:"available",children:"Available"}),e.jsx(u,{value:"sold",children:"Sold"}),e.jsx(u,{value:"rented",children:"Rented"}),e.jsx(u,{value:"recent",children:"Recently Added"})]})]})]})]}),q&&e.jsxs("div",{className:"grid gap-4 "+(L?"grid-cols-1":"grid-cols-1 md:grid-cols-3"),children:[e.jsx(f,{children:e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-500/10 rounded-lg",children:e.jsx(v,{className:"w-5 h-5 text-red-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:q.totalFavorites}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Favorites"})]})]})})}),e.jsx(f,{children:e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(A,{className:"w-5 h-5 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:q?.avgPrice?k.formatPrice(q.avgPrice):"₹0"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Price"})]})]})})}),e.jsx(f,{children:e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(g,{className:"w-5 h-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:q?.availableProperties||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Still Available"})]})]})})})]}),G.length>0&&0===Q.length&&e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{className:"w-5 h-5 text-blue-600"}),e.jsxs("span",{className:"text-sm text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Tip:"})," Select properties using the checkboxes to compare them side-by-side (unlimited selection)"]})]})}),e.jsx("div",{className:"space-y-4",children:0===G.length?e.jsx(f,{children:e.jsxs(j,{className:"p-12 text-center",children:[e.jsx(v,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No favorites found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:T||V&&"all"!==V?"No properties match your search criteria":"Start adding properties to your favorites to see them here"}),e.jsx(t,{to:"/customer/search",children:e.jsxs(d,{children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Search Properties"]})})]})}):G.map(s=>{const a=s.property;if(!a)return null;const r=k.getPropertyStatusBadge(a),l=a.images&&a.images.length>0?"string"==typeof a.images[0]?a.images[0]:a.images[0].url:null;return e.jsx(f,{className:"hover:shadow-lg transition-all "+(Q.includes(a._id)?"ring-2 ring-primary bg-primary/5":""),children:e.jsx(j,{className:"p-0",children:e.jsxs("div",{className:"flex "+(L?"flex-col":"flex-col md:flex-row"),children:[e.jsxs("div",{className:(L?"w-full h-64":"md:w-80 h-64 md:h-48")+" bg-muted flex items-center justify-center relative",children:[l?e.jsx("img",{src:l,alt:a.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-12 h-12 bg-primary/20 rounded-lg flex items-center justify-center",children:e.jsx(b,{className:"w-6 h-6 text-primary"})}),e.jsx("div",{className:"absolute top-2 left-2 flex flex-col gap-1",children:e.jsx(w,{variant:r.variant,children:r.label})}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(y,{checked:Q.includes(a._id),onCheckedChange:()=>{return e=a._id,void H(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e]);var e},className:"bg-white"})})]}),e.jsxs("div",{className:"flex-1 p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4 "+(L?"flex-col gap-2":"items-start"),children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold mb-2 "+(L?"text-lg":"text-xl"),children:a.title}),e.jsxs("div",{className:"flex items-center text-muted-foreground mb-2",children:[e.jsx(b,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"text-sm",children:"string"==typeof a.address?a.address:a.address.district?`${a.address.street||""}, ${a.address.city||""}, ${a.address.district||""}, ${a.address.state||""}`:`${a.address.street||""}, ${a.address.city||""}, ${a.address.state||""}`})]})]}),e.jsxs("div",{className:"text-right "+(L?"text-left":""),children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:k.formatPrice(a.price)}),(()=>{const s=a?.area;if(!s)return null;if("object"==typeof s&&null!==s){const t=s.builtUp||s.carpet||s.plot||1;return e.jsxs("p",{className:"text-sm text-muted-foreground",children:["₹",Math.round(a.price/t),"/sq ft"]})}return"number"==typeof s?e.jsxs("p",{className:"text-sm text-muted-foreground",children:["₹",Math.round(a.price/s),"/sq ft"]}):null})()]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 text-sm text-muted-foreground",children:[(()=>{const s=a?.area;if(!s)return null;if("object"==typeof s&&null!==s){const a=s.builtUp||s.carpet||s.plot||0,t=s.unit||"sq ft";return e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:[a," ",t]})})}return"number"==typeof s?e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:[s," sq ft"]})}):null})(),a.bedrooms&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:[a.bedrooms," bed"]})}),a.bathrooms&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:[a.bathrooms," bath"]})})]}),a.amenities&&a.amenities.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-4",children:[a.amenities.slice(0,3).map((s,a)=>e.jsx(w,{variant:"outline",className:"text-xs",children:s},a)),a.amenities.length>3&&e.jsxs(w,{variant:"outline",className:"text-xs",children:["+",a.amenities.length-3," more"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground mb-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(P,{className:"w-3 h-3"}),e.jsxs("span",{children:["Added ",new Date(s.createdAt).toLocaleDateString()]})]}),a.owner&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("span",{children:C(a)})})]}),e.jsxs("div",{className:"flex justify-between items-center "+(L?"flex-col gap-3":""),children:[e.jsxs("div",{className:"flex gap-2 "+(L?"flex-wrap":""),children:[e.jsxs(d,{size:"sm",variant:"outline",onClick:()=>{const e=`${window.location.origin}/v3/property/${a._id}`;navigator.share?navigator.share({title:a.title,text:`Check out this property: ${a.title}`,url:e}):(navigator.clipboard.writeText(e),i({title:"Link copied",description:"Property link has been copied to clipboard"}))},className:"flex-1 sm:flex-none",children:[e.jsx(F,{className:"w-4 h-4"}),!L&&e.jsx("span",{className:"ml-1",children:"Share"})]}),e.jsxs(d,{size:"sm",variant:"outline",onClick:()=>{const e=[a._id];_(`/customer/compare?properties=${e.join(",")}`)},className:"flex-1 sm:flex-none",children:[e.jsx(n,{className:"w-4 h-4 mr-1"}),"Compare"]}),e.jsx(t,{to:`/property/${a._id}`,className:"flex-1 sm:flex-none",children:e.jsx(d,{size:"sm",variant:"outline",className:"w-full",children:"View Details"})})]}),e.jsxs(d,{size:"sm",variant:"destructive",onClick:()=>(async e=>{try{await k.removeFromFavorites(e),await I(),await W(),i({title:"Success",description:"Property removed from favorites"})}catch(s){i({title:"Error",description:"Failed to remove from favorites",variant:"destructive"})}})(a._id),className:"w-full sm:w-auto "+(L?"mt-2":""),children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Remove"]})]})]})]})})},s._id)})})]})})};export{_ as default};
