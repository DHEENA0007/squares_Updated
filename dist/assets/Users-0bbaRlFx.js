import{j as e}from"./ui-CEt46o3G.js";import{r as l,d as L}from"./router-2SVJvIbS.js";import{B as n,a as v,e as _,M as B,P as H,I as M}from"./index-CiYV0Sy0.js";import{T as R,a as z,b as y,c as o,d as O,e as c}from"./table-DKpHrBMs.js";import{D as Q,a as q,b as G,c as J,d as K}from"./dialog-B2oiH0OC.js";import{P as W,a as X,b as N,c as Y,d as Z,e as $}from"./pagination-o12Qjq_y.js";import{C as m,a as x,b as h,d as j}from"./card-YvDMUmzt.js";import{u as d}from"./userService-BPsaMP6Y.js";import{A as ee,a as se,b as ae,c as te,d as ie,e as re,f as le,g as ne,h as de}from"./alert-dialog-DuMuwcab.js";import{L as T}from"./loader-circle-Cj-dvH02.js";import{E as ce}from"./eye-CDS1ofgA.js";import{T as oe}from"./trash-2-Dj_If1Zn.js";import{S as me}from"./shield-CFIF9xqz.js";import{A as xe}from"./activity-C0RoF-dL.js";import{C as he}from"./calendar-DWj9NFdt.js";import"./vendor-Dazix4UH.js";import"./ellipsis-9xIsGA7b.js";const je=({searchQuery:u})=>{const[i,f]=l.useState(1),[g,C]=l.useState([]),[V,D]=l.useState(!0),[p,w]=l.useState(0),[ue,A]=l.useState(0),[P,U]=l.useState(null),[s,E]=l.useState(null),[k,b]=l.useState(!1),S=10;l.useEffect(()=>{(async()=>{D(!0);try{const t=await d.getUsers({page:i,limit:S,search:u||void 0});t.success&&(C(t.data.users),w(t.data.pagination.totalPages),A(t.data.pagination.totalUsers))}catch(t){console.error("Failed to fetch users:",t)}finally{D(!1)}})()},[i,u]);const F=async a=>{U(a);try{await d.deleteUser(a);const t=await d.getUsers({page:i,limit:S,search:u||void 0});t.success&&(C(t.data.users),w(t.data.pagination.totalPages),A(t.data.pagination.totalUsers))}catch(t){console.error("Failed to delete user:",t)}finally{U(null)}},I=a=>{E(a),b(!0)};return V?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(T,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2 text-lg",children:"Loading users..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md border overflow-x-auto",children:e.jsxs(R,{children:[e.jsx(z,{children:e.jsxs(y,{children:[e.jsx(o,{children:"Name"}),e.jsx(o,{children:"Email"}),e.jsx(o,{className:"hidden md:table-cell",children:"Phone"}),e.jsx(o,{className:"hidden sm:table-cell",children:"Role"}),e.jsx(o,{className:"hidden lg:table-cell",children:"Status"}),e.jsx(o,{className:"hidden lg:table-cell",children:"Created"}),e.jsx(o,{className:"text-right",children:"Actions"})]})}),e.jsx(O,{children:g.length===0?e.jsx(y,{children:e.jsx(c,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No users found."})}):g.map(a=>e.jsxs(y,{children:[e.jsx(c,{className:"font-medium",children:d.getFullName(a)}),e.jsx(c,{children:a.email}),e.jsx(c,{className:"hidden md:table-cell",children:a.profile.phone||"-"}),e.jsx(c,{className:"hidden sm:table-cell",children:e.jsx(n,{variant:a.role==="admin"?"default":"secondary",children:a.role})}),e.jsx(c,{className:"hidden lg:table-cell",children:e.jsx(n,{variant:a.status==="active"?"default":a.status==="pending"?"secondary":"destructive",children:a.status})}),e.jsx(c,{className:"hidden lg:table-cell",children:d.formatCreationDate(a.createdAt)}),e.jsx(c,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>I(a),title:"View User Details",children:e.jsx(ce,{className:"h-4 w-4"})}),e.jsxs(ee,{children:[e.jsx(se,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"icon",children:e.jsx(oe,{className:"h-4 w-4"})})}),e.jsxs(ae,{children:[e.jsxs(te,{children:[e.jsx(ie,{children:"Are you absolutely sure?"}),e.jsx(re,{children:"This action cannot be undone. This will permanently delete the user account and remove their data from our servers."})]}),e.jsxs(le,{children:[e.jsx(ne,{children:"Cancel"}),e.jsxs(de,{onClick:()=>F(a._id),disabled:P===a._id,children:[P===a._id?e.jsx(T,{className:"h-4 w-4 animate-spin mr-2"}):null,"Delete"]})]})]})]})]})})]},a._id))})]})}),p>1&&e.jsx(W,{className:"mt-4",children:e.jsxs(X,{children:[e.jsx(N,{children:e.jsx(Y,{onClick:()=>f(a=>Math.max(1,a-1)),className:i===1?"pointer-events-none opacity-50":"cursor-pointer"})}),[...Array(p)].map((a,t)=>{const r=t+1;return r===1||r===p||r>=i-1&&r<=i+1?e.jsx(N,{children:e.jsx(Z,{onClick:()=>f(r),isActive:i===r,className:"cursor-pointer",children:r})},r):r===i-2||r===i+2?e.jsx(N,{children:"..."},r):null}),e.jsx(N,{children:e.jsx($,{onClick:()=>f(a=>Math.min(p,a+1)),className:i===p?"pointer-events-none opacity-50":"cursor-pointer"})})]})}),e.jsx(Q,{open:k,onOpenChange:b,children:e.jsxs(q,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(G,{children:[e.jsx(J,{children:"User Details"}),e.jsxs(K,{children:["Complete information about ",s?d.getFullName(s):"user"]})]}),s&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5"}),"Basic Information"]})}),e.jsx(j,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Full Name"}),e.jsx("p",{className:"text-base",children:d.getFullName(s)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),e.jsx("p",{className:"text-base",children:s.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Phone"}),e.jsx("p",{className:"text-base",children:s.profile?.phone||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"User ID"}),e.jsx("p",{className:"text-base font-mono text-sm",children:s._id})]})]})})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-5 h-5"}),"Account Status"]})}),e.jsx(j,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Role"}),e.jsx(n,{variant:s.role==="admin"?"default":"secondary",className:"mt-1",children:s.role})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsx(n,{variant:s.status==="active"?"default":s.status==="pending"?"secondary":"destructive",className:"mt-1",children:s.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Email Verified"}),e.jsx(n,{variant:s.emailVerified?"default":"destructive",className:"mt-1",children:s.emailVerified?"Verified":"Not Verified"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Phone Verified"}),e.jsx(n,{variant:s.phoneVerified?"default":"destructive",className:"mt-1",children:s.phoneVerified?"Verified":"Not Verified"})]})]})})]}),s.profile?.address&&e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5"}),"Address Information"]})}),e.jsx(j,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.profile?.address?.street&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Street"}),e.jsx("p",{className:"text-base",children:s.profile.address.street})]}),s.profile?.address?.city&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"City"}),e.jsx("p",{className:"text-base",children:s.profile.address.city})]}),s.profile?.address?.state&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"State"}),e.jsx("p",{className:"text-base",children:s.profile.address.state})]}),s.profile?.address?.pincode&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Pincode"}),e.jsx("p",{className:"text-base",children:s.profile.address.pincode})]})]})})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5"}),"User Preferences"]})}),e.jsxs(j,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Language"}),e.jsx("p",{className:"text-base",children:s.preferences?.language||"Not set"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Currency"}),e.jsx("p",{className:"text-base",children:s.preferences?.currency||"Not set"})]})]}),s.preferences?.notifications&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Notification Preferences"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(n,{variant:s.preferences.notifications.email?"default":"secondary",children:["Email: ",s.preferences.notifications.email?"Enabled":"Disabled"]}),e.jsxs(n,{variant:s.preferences.notifications.sms?"default":"secondary",children:["SMS: ",s.preferences.notifications.sms?"Enabled":"Disabled"]}),e.jsxs(n,{variant:s.preferences.notifications.push?"default":"secondary",children:["Push: ",s.preferences.notifications.push?"Enabled":"Disabled"]})]})]})]})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5"}),"Account Timeline"]})}),e.jsx(j,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Created At"}),e.jsx("p",{className:"text-base",children:d.formatCreationDate(s.createdAt)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Last Updated"}),e.jsx("p",{className:"text-base",children:d.formatCreationDate(s.updatedAt)})]})]})})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsx(h,{children:"Quick Actions"})}),e.jsx(j,{children:e.jsx("div",{className:"flex gap-2 flex-wrap",children:e.jsx(v,{variant:"outline",size:"sm",onClick:()=>b(!1),children:"Close"})})})]})]})]})})]})},ke=()=>{const u=L(),[i,f]=l.useState("");return e.jsxs("div",{className:"space-y-6 relative top-[60px]",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Users"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"View and manage system users"})]}),e.jsxs(v,{onClick:()=>u("/admin/users/add"),children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Add User"]})]}),e.jsxs("div",{className:"bg-card rounded-lg border p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx(M,{placeholder:"Search users...",value:i,onChange:g=>f(g.target.value),className:"max-w-md"})}),e.jsx(je,{searchQuery:i})]})]})};export{ke as default};
