import{j as e}from"./ui-s1SEoZIF.js";import{d as s,r as a}from"./router-D8v2YSKU.js";import{a2 as i,f as r,A as t,a as n,b as l,c,d,e as o,L as p,I as m,T as h,q as x,r as u,s as j,v as g,w as f,a9 as b,aO as v,G as y}from"./index-DvBXyKtT.js";import{C as N}from"./checkbox-XS8tCCHA.js";import{A as C,a as w}from"./alert-Cbv3ShML.js";import{p as k}from"./planService-BDwsJXuj.js";import{I as P}from"./info-BKFYLDRV.js";import{C as F}from"./circle-alert-B6eCZAbs.js";import"./vendor-BxThA0WO.js";const S=()=>{const S=s(),{toast:I}=i(),[A,E]=a.useState(!1),[L,D]=a.useState({name:"",description:""}),[M,O]=a.useState({name:"",description:"",icon:""}),[q,U]=a.useState({identifier:"",name:"",description:"",price:0,currency:"INR",billingPeriod:"monthly",billingCycleMonths:1,features:[],limits:{properties:5,featuredListings:0,photos:10,videoTours:0,leads:0,videos:0,posters:0,messages:0,leadManagement:"basic"},benefits:[],whatsappSupport:{enabled:!1,number:""},isActive:!0,isPopular:!1,sortOrder:0}),z=()=>{L.name.trim()&&(U({...q,features:[...q.features,{...L,enabled:!0}]}),D({name:"",description:""}))},R=()=>{if(!M.name.trim())return;const e=M.name.toLowerCase().replace(/\s+/g,"").replace(/[^a-z0-9]/g,"");U({...q,benefits:[...q.benefits,{key:e,name:M.name,description:M.description,enabled:!0,icon:M.icon||"star"}]}),O({name:"",description:"",icon:""})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>S("/admin/plans"),children:e.jsx(t,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Create New Plan"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Add a new subscription plan for your users"})]})]}),e.jsxs(C,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950/20",children:[e.jsx(P,{className:"h-4 w-4 text-blue-600"}),e.jsxs(w,{className:"text-blue-900 dark:text-blue-100",children:[e.jsx("strong",{children:"Plan Snapshot Protection:"})," Once users subscribe to this plan, they will keep these exact features and pricing even if you update the plan later. Only new subscribers will get the updated plan."]})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),q.identifier.trim())if(0!==q.features.length)try{E(!0),await k.createPlan(q),S("/admin/plans")}catch(s){}finally{E(!1)}else I({title:"Error",description:"Please add at least one feature",variant:"destructive"});else I({title:"Error",description:"Plan identifier is required",variant:"destructive"})},className:"space-y-6",children:[e.jsxs(n,{children:[e.jsxs(l,{children:[e.jsx(c,{children:"Basic Information"}),e.jsx(d,{children:"Define the core details of your subscription plan"})]}),e.jsxs(o,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"identifier",children:"Plan Identifier *"}),e.jsx(m,{id:"identifier",placeholder:"e.g., free, basic, premium",value:q.identifier,onChange:e=>U({...q,identifier:e.target.value.toLowerCase().replace(/\s+/g,"-")}),required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Unique identifier for the plan (lowercase, no spaces)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"name",children:"Plan Name *"}),e.jsx(m,{id:"name",placeholder:"e.g., Free Listing, Premium",value:q.name,onChange:e=>U({...q,name:e.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(p,{htmlFor:"description",children:"Description *"}),e.jsx(h,{id:"description",placeholder:"Describe the plan benefits...",value:q.description,onChange:e=>U({...q,description:e.target.value}),required:!0,rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"price",children:"Price *"}),e.jsx(m,{id:"price",type:"number",step:"0.01",min:"0",value:q.price,onChange:e=>U({...q,price:parseFloat(e.target.value)||0}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"currency",children:"Currency"}),e.jsxs(x,{value:q.currency,onValueChange:e=>U({...q,currency:e}),children:[e.jsx(u,{children:e.jsx(j,{})}),e.jsxs(g,{children:[e.jsx(f,{value:"INR",children:"INR (₹)"}),e.jsx(f,{value:"USD",children:"USD ($)"}),e.jsx(f,{value:"EUR",children:"EUR (€)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"billingCycleMonths",children:"Billing Period (Months) *"}),e.jsx(m,{id:"billingCycleMonths",type:"number",min:"1",max:"120",value:q.billingCycleMonths,onChange:e=>{const s=parseInt(e.target.value)||1;let a="custom";1===s?a="monthly":12===s&&(a="yearly"),U({...q,billingPeriod:a,billingCycleMonths:s})},placeholder:"Enter number of months (1-120)"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter the billing cycle in months. Common values: 1 (monthly), 12 (yearly)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"sortOrder",children:"Sort Order"}),e.jsx(m,{id:"sortOrder",type:"number",min:"0",value:q.sortOrder,onChange:e=>U({...q,sortOrder:parseInt(e.target.value)||0})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Lower numbers appear first"})]})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{id:"isActive",checked:q.isActive,onCheckedChange:e=>U({...q,isActive:e})}),e.jsx(p,{htmlFor:"isActive",className:"cursor-pointer",children:"Active"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{id:"isPopular",checked:q.isPopular,onCheckedChange:e=>U({...q,isPopular:e})}),e.jsx(p,{htmlFor:"isPopular",className:"cursor-pointer",children:"Mark as Popular"})]})]})]})]}),e.jsxs(n,{children:[e.jsxs(l,{children:[e.jsx(c,{children:"Usage Limits"}),e.jsx(d,{children:"Set usage limits for plan subscribers"})]}),e.jsx(o,{className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"properties",children:"Property Listings"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{id:"properties",type:"number",min:"1",value:null===q.limits.properties?"":q.limits.properties,onChange:e=>U({...q,limits:{...q.limits,properties:parseInt(e.target.value)||1}}),placeholder:null===q.limits.properties?"∞ Unlimited":"Enter number",disabled:null===q.limits.properties}),e.jsx(r,{type:"button",variant:null===q.limits.properties?"default":"outline",size:"icon",onClick:()=>U({...q,limits:{...q.limits,properties:null===q.limits.properties?5:null}}),title:null===q.limits.properties?"Set limited":"Set unlimited (infinity)",children:"∞"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:null===q.limits.properties?"Unlimited properties (∞)":`Limited to ${q.limits.properties} properties`})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"featuredListings",children:"Featured Listings"}),e.jsx(m,{id:"featuredListings",type:"number",min:"0",value:q.limits.featuredListings,onChange:e=>U({...q,limits:{...q.limits,featuredListings:parseInt(e.target.value)||0}})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Highlighted in search"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"leads",children:"Monthly Leads"}),e.jsx(m,{id:"leads",type:"number",min:"0",value:q.limits.leads,onChange:e=>U({...q,limits:{...q.limits,leads:parseInt(e.target.value)||0}})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"0 = unlimited"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"photos",children:"Photos per Property"}),e.jsx(m,{id:"photos",type:"number",min:"1",max:"100",value:q.limits.photos,onChange:e=>U({...q,limits:{...q.limits,photos:parseInt(e.target.value)||10}})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Max photos per property"})]})]})})]}),e.jsxs(n,{children:[e.jsxs(l,{children:[e.jsx(c,{children:"Plan Badges"}),e.jsx(d,{children:"Badges displayed on vendor profiles and home page for users who purchase this plan"})]}),e.jsxs(o,{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{placeholder:"Badge name (e.g., Top Rated, Verified)...",value:M.name,onChange:e=>O({...M,name:e.target.value}),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),R()),className:"flex-1"}),e.jsx(m,{placeholder:"Description (e.g., Highly rated professional)...",value:M.description,onChange:e=>O({...M,description:e.target.value}),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),R()),className:"flex-1"}),e.jsx(m,{placeholder:"Icon (star, shield, etc)...",value:M.icon,onChange:e=>O({...M,icon:e.target.value}),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),R()),className:"w-32"}),e.jsx(r,{type:"button",onClick:R,size:"icon",children:e.jsx(b,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-2",children:[q.benefits.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg hover:bg-muted/80 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx(N,{id:`benefit-${a}`,checked:s.enabled,onCheckedChange:()=>(e=>{const s=[...q.benefits];s[e]={...s[e],enabled:!s[e].enabled},U({...q,benefits:s})})(a)}),e.jsxs("div",{className:"flex-1",children:[e.jsx(p,{htmlFor:`benefit-${a}`,className:"cursor-pointer text-sm font-medium",children:s.name}),s.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.description}),s.icon&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Icon: ",s.icon]})]})]}),e.jsx(r,{type:"button",variant:"ghost",size:"icon",onClick:()=>(e=>{U({...q,benefits:q.benefits.filter((s,a)=>a!==e)})})(a),children:e.jsx(v,{className:"w-4 h-4"})})]},a)),0===q.benefits.length&&e.jsxs(C,{children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx(w,{children:'No badges added yet. Add badges to highlight this plan on vendor profiles and the home page. Example badges: "Top Rated", "Verified", "Marketing Pro"'})]})]})]})]}),e.jsxs(n,{children:[e.jsxs(l,{children:[e.jsx(c,{children:"WhatsApp Support"}),e.jsx(d,{children:"Configure WhatsApp contact for enterprise properties"})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{id:"whatsappEnabled",checked:q.whatsappSupport.enabled,onCheckedChange:e=>U({...q,whatsappSupport:{...q.whatsappSupport,enabled:e}})}),e.jsx(p,{htmlFor:"whatsappEnabled",className:"cursor-pointer",children:"Enable WhatsApp Contact"})]}),q.whatsappSupport.enabled&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"whatsappNumber",children:"WhatsApp Number *"}),e.jsx(m,{id:"whatsappNumber",placeholder:"+91 98765 43210",value:q.whatsappSupport.number,onChange:e=>U({...q,whatsappSupport:{...q.whatsappSupport,number:e.target.value}})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Include country code (e.g., +91 for India). This number will be shown for enterprise property inquiries."})]})]})]}),e.jsxs(n,{children:[e.jsxs(l,{children:[e.jsx(c,{children:"Features"}),e.jsx(d,{children:"List the key features included in this plan"})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs(C,{className:"border-amber-200 bg-amber-50 dark:bg-amber-950/20",children:[e.jsx(F,{className:"h-4 w-4 text-amber-600"}),e.jsx(w,{className:"text-amber-900 dark:text-amber-100 text-sm",children:"Add descriptive features to help users understand what they get with this plan. These will be displayed on the subscription selection page."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{placeholder:"Feature name...",value:L.name,onChange:e=>D({...L,name:e.target.value}),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),z()),className:"flex-1"}),e.jsx(m,{placeholder:"Description (optional)",value:L.description,onChange:e=>D({...L,description:e.target.value}),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),z()),className:"flex-1"}),e.jsx(r,{type:"button",onClick:z,size:"icon",children:e.jsx(b,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-2",children:[q.features.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:s.name}),s.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.description})]}),e.jsx(r,{type:"button",variant:"ghost",size:"icon",onClick:()=>(e=>{U({...q,features:q.features.filter((s,a)=>a!==e)})})(a),children:e.jsx(v,{className:"w-4 h-4"})})]},a)),0===q.features.length&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No features added yet. Add at least one feature."})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(r,{type:"submit",disabled:A,children:[A&&e.jsx(y,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Plan"]}),e.jsx(r,{type:"button",variant:"outline",onClick:()=>S("/admin/plans"),children:"Cancel"})]})]})]})};export{S as default};
