import{j as e}from"./ui-BNZSgpjP.js";import{e as s,d as a,r,L as t}from"./router-D8v2YSKU.js";import{u as l,aL as i,t as n,bO as c,f as o,A as d,a as m,e as x,Q as p,k as h,a1 as u,bX as j,B as f,b as g,c as N,x as y,g as v,y as b,am as w,E as k,a3 as C,bP as S,bQ as L,bu as A}from"./index-uSA-3vk3.js";import{g as $,a as F}from"./propertyUtils-41DuwCMc.js";import{vendorService as P}from"./vendorService-C4BcjEQb.js";import{E as T}from"./EnterprisePropertyContactDialog-DBO19n_0.js";import{L as E}from"./log-in-CTq4yGty.js";import{S as D}from"./share-2-BhnZvy67.js";import{E as _}from"./external-link-DHrBZK4V.js";import{C as V}from"./car-CxUoe61z.js";import{C as M}from"./calendar-D6wj0hX2.js";import"./vendor-BxThA0WO.js";import"./reviewsService-DOgBHxA8.js";import"./indian-rupee-B7xx3C7i.js";const O=()=>{const{id:O}=s(),I=a(),{isAuthenticated:z,isCustomer:Q}=l(),[q,U]=r.useState(null),[W,Y]=r.useState(!0),[B,R]=r.useState(0),[H,X]=r.useState(!1),[G,J]=r.useState(!1),[K,Z]=r.useState(null),[ee,se]=r.useState(!1),[ae,re]=r.useState([]),te=r.useCallback(async()=>{if(O)try{Y(!0);const s=await i.getProperty(O);if(s.success){if(U(s.data.property),s.data.property.vendor?._id||s.data.property.owner?._id)try{se(!0);const e=s.data.property.vendor?._id||s.data.property.owner?._id,a=await P.checkVendorWhatsAppSupport(e);J(a.whatsappEnabled),Z(a.whatsappNumber)}catch(e){J(!1),Z(null)}finally{se(!1)}}else n({title:"Error",description:"Property not found",variant:"destructive"}),I("/")}catch(e){n({title:"Error",description:"Failed to load property details",variant:"destructive"}),I("/")}finally{Y(!1)}},[O,I]);r.useEffect(()=>{te()},[te]),r.useEffect(()=>{(async()=>{if(q?.type)try{const e=(await C.getAllPropertyTypes()).find(e=>e.value===q.type);if(e){const s=await C.getPropertyTypeFields(e._id);re(s.filter(e=>e.isActive).sort((e,s)=>e.displayOrder-s.displayOrder))}}catch(e){}})()},[q?.type]),r.useEffect(()=>{z&&O&&!W&&I(`/customer/property/${O}`,{replace:!0})},[z,O,W,I]);const le=e=>{n({title:"Login Required",description:`Please login to ${e}`,variant:"default"}),I("/login",{state:{from:`/property/${O}`}})},ie=async()=>{const e=`${window.location.origin}/en-new/property/${O}`;if(O&&i.trackInteraction(O,"sharedProperty"),navigator.share&&q)try{await navigator.share({title:q.title,text:`Check out this property: ${q.title}`,url:e})}catch(s){navigator.clipboard.writeText(e),n({title:"Link copied",description:"Property link has been copied to clipboard"})}else navigator.clipboard.writeText(e),n({title:"Link copied",description:"Property link has been copied to clipboard"})},ne=e=>{const s=e.area;let a=0;return"object"==typeof s&&null!==s?a=s.builtUp||s.carpet||s.plot||0:"number"==typeof s&&(a=s),0===a?0:Math.round(e.price/a)};return W?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading property details..."})]})}):q?e.jsxs("div",{className:"min-h-screen bg-background pt-20 pb-8",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-6",children:[z&&e.jsx(m,{className:"border-blue-500 bg-blue-50 dark:bg-blue-950",children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900 dark:text-blue-100",children:"Unlock All Features"}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Save to favorites, send messages, compare properties, and access detailed analytics"})]})]}),e.jsx(o,{onClick:()=>I(`/customer/property/${O}`),className:"bg-blue-600 hover:bg-blue-700",children:"View Full Details"})]})})}),!z&&e.jsx(m,{className:"border-primary bg-primary/5",children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(E,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Login for Full Access"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Contact owner, save favorites, compare properties, and more"})]})]}),e.jsx(o,{onClick:()=>le("access all features"),children:"Login Now"})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(o,{variant:"ghost",size:"icon",onClick:()=>I("/"),children:e.jsx(d,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:q.title}),e.jsxs("div",{className:"flex items-center text-muted-foreground mt-1",children:[e.jsx(h,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"text-sm",children:(e=>{const s=e.address;if("string"==typeof s)return s;const a=[];return s.street&&a.push(s.street),s.locationName&&a.push(s.locationName),s.city&&a.push(s.city),s.district&&a.push(s.district),s.state&&a.push(s.state),s.pincode&&a.push(s.pincode),a.join(", ")})(q)})]})]})]}),e.jsx("div",{className:"flex gap-2",children:z?e.jsxs(e.Fragment,{children:[e.jsxs(o,{variant:"outline",onClick:()=>I(`/customer/property/${O}`),children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"Save to Favorites"]}),e.jsxs(o,{variant:"outline",onClick:ie,children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Share"]}),e.jsxs(o,{onClick:()=>I(`/customer/property/${O}`),children:[e.jsx(j,{className:"w-4 h-4 mr-2"}),"Compare"]})]}):e.jsxs(o,{variant:"outline",onClick:ie,children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Share"]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{className:`${(e=>{switch(e.toLowerCase()){case"available":return"bg-green-600";case"sold":return"bg-red-600";case"rented":return"bg-blue-600";case"pending":return"bg-yellow-600";default:return"bg-gray-600"}})(q.status)} text-white`,children:q.status}),q.featured&&e.jsxs(f,{variant:"secondary",children:[e.jsx(p,{className:"w-3 h-3 mr-1"}),"Featured"]}),q.verified&&e.jsx(f,{className:"bg-green-600 text-white",children:"Verified"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-primary",children:(ce=q.price,oe=q.listingType,"rent"===oe?`₹${ce.toLocaleString("en-IN")}/month`:"lease"===oe?`₹${ce.toLocaleString("en-IN")}/year`:ce>=1e7?`₹${(ce/1e7).toFixed(1)} Cr`:ce>=1e5?`₹${(ce/1e5).toFixed(1)} Lac`:`₹${ce.toLocaleString("en-IN")}`)}),ne(q)>0&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["₹",ne(q),"/sq ft"]})]})]}),q.images&&q.images.length>0&&e.jsx(m,{children:e.jsxs(x,{className:"p-0",children:[e.jsx("div",{className:"aspect-video bg-muted rounded-lg overflow-hidden",children:e.jsx("img",{src:"string"==typeof q.images[B]?q.images[B]:q.images[B].url,alt:q.title,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.src="/placeholder-property.jpg"}})}),q.images.length>1&&e.jsx("div",{className:"flex gap-2 p-4 overflow-x-auto",children:q.images.map((s,a)=>e.jsx("button",{onClick:()=>R(a),className:"flex-shrink-0 w-20 h-16 rounded-lg overflow-hidden border-2 "+(a===B?"border-primary":"border-transparent"),children:e.jsx("img",{src:"string"==typeof s?s:s.url,alt:`Property image ${a+1}`,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.src="/placeholder-property.jpg"}})},a))})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(m,{children:[e.jsx(g,{children:e.jsxs(N,{className:"flex items-center",children:[e.jsx(c,{className:"w-5 h-5 mr-2"}),"Property Overview"]})}),e.jsx(x,{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:ae.map(s=>{const a=q.customFields?.[s.fieldName];if(null==a||""===a||"N/A"===a)return null;let r=c;const t=s.fieldName.toLowerCase();t.includes("bed")?r=S:t.includes("bath")?r=L:t.includes("area")?r=A:t.includes("park")?r=V:(t.includes("date")||t.includes("year")||t.includes("age"))&&(r=M);let l=a;return"boolean"===s.fieldType?l=a?"Yes":"No":Array.isArray(a)&&(l=a.join(", ")),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx(r,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-xl md:text-2xl font-bold capitalize break-words leading-tight",children:l.toString()}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.fieldLabel})]},s._id)})})})]}),q.description&&e.jsx(m,{children:e.jsxs(x,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-muted-foreground leading-relaxed",children:q.description})]})}),e.jsxs(m,{children:[e.jsx(g,{children:e.jsx(N,{children:"Property Details"})}),e.jsx(x,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:ae.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3",children:[ae.filter((e,s)=>s%2==0).map(s=>{const a=q.customFields?.[s.fieldName];if(null==a||""===a||"N/A"===a)return null;let r=a;return"boolean"===s.fieldType?r=a?"Yes":"No":Array.isArray(a)&&(r=a.join(", ")),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s.fieldLabel,":"]}),e.jsx("span",{className:"font-medium capitalize",children:r.toString()})]},s._id)}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Listed On:"}),e.jsx("span",{className:"font-medium",children:new Date(q.createdAt).toLocaleDateString()})]})]}),e.jsx("div",{className:"space-y-3",children:ae.filter((e,s)=>s%2!=0).map(s=>{const a=q.customFields?.[s.fieldName];if(null==a||""===a||"N/A"===a)return null;let r=a;return"boolean"===s.fieldType?r=a?"Yes":"No":Array.isArray(a)&&(r=a.join(", ")),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s.fieldLabel,":"]}),e.jsx("span",{className:"font-medium capitalize",children:r.toString()})]},s._id)})})]}):null})})]}),q.amenities&&q.amenities.length>0&&e.jsxs(m,{children:[e.jsx(g,{children:e.jsx(N,{children:"Amenities"})}),e.jsx(x,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:q.amenities.map((s,a)=>e.jsxs("div",{className:"flex items-center p-3 bg-muted rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mr-3"}),e.jsx("span",{className:"text-sm",children:s})]},a))})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(m,{children:[e.jsx(g,{children:e.jsxs(N,{className:"flex items-center",children:[e.jsx(y,{className:"w-5 h-5 mr-2"}),"Contact Information"]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-medium",children:$(q.owner)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:F(q)})]}),e.jsx(v,{}),e.jsx("div",{className:"space-y-3",children:z?e.jsxs(e.Fragment,{children:[e.jsxs(o,{className:"w-full",onClick:()=>I(`/customer/property/${O}`),children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"View Contact Details"]}),e.jsxs(o,{variant:"outline",className:"w-full",onClick:()=>I(`/customer/property/${O}`),children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Send Message"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(o,{className:"w-full",onClick:()=>le("contact the owner"),children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Login to Contact"]}),e.jsxs(o,{variant:"outline",className:"w-full",onClick:()=>le("send message"),children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Login to Message"]})]})})]})]}),e.jsxs(m,{children:[e.jsx(g,{children:e.jsxs(N,{className:"flex items-center",children:[e.jsx(k,{className:"w-5 h-5 mr-2"}),"Property Stats"]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Views"}),e.jsx("span",{className:"font-semibold",children:q.views||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Listed"}),e.jsxs("span",{className:"font-semibold",children:[Math.floor((Date.now()-new Date(q.createdAt).getTime())/864e5)," days ago"]})]})]})]}),e.jsxs(m,{children:[e.jsx(g,{children:e.jsx(N,{children:"Quick Actions"})}),e.jsxs(x,{className:"space-y-3",children:[q.virtualTour&&e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>window.open(q.virtualTour,"_blank"),children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Virtual Tour"]}),z&&Q?e.jsxs(e.Fragment,{children:[e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>I(`/customer/property/${O}`),children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"Add to Favorites"]}),e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>I(`/customer/property/${O}`),children:[e.jsx(j,{className:"w-4 h-4 mr-2"}),"Compare Property"]})]}):z?null:e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>le("save to favorites"),children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Login for More Actions"]}),e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:ie,children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Share Property"]})]})]})]})]})]}),e.jsx(T,{open:H,onOpenChange:X,property:q,whatsappNumber:K})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(c,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Property Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"The property you're looking for doesn't exist."}),e.jsx(t,{to:"/",children:e.jsxs(o,{children:[e.jsx(d,{className:"w-4 h-4 mr-2"}),"Back to Home"]})})]})});var ce,oe};export{O as default};
