import{j as e}from"./ui-BNZSgpjP.js";import{d as s,r as i}from"./router-D8v2YSKU.js";import{a2 as a,f as r,A as l,a as n,b as t,S as c,c as d,d as o,e as m,L as x,I as p,T as h,B as j,aJ as u,_ as b,g}from"./index-C1UN0dDZ.js";import{C as N}from"./checkbox-CRHlB3_Z.js";import{r as f}from"./roleService-93_GADdl.js";import{A as v,a as y,b as w,c as k}from"./accordion-DP2ulMko.js";import{K as C}from"./key-CT6toxP2.js";import{I as A}from"./info-DYXDYsXl.js";import{C as S}from"./circle-check-5aC4nM7S.js";import"./vendor-BxThA0WO.js";const R=()=>{const R=s(),{toast:D}=a(),[P,F]=i.useState(!1),[I,q]=i.useState({name:"",description:"",permissions:[],level:1,isActive:!0});return e.jsxs("div",{className:"space-y-8 pb-20",children:[e.jsxs("div",{className:"flex items-center gap-4 border-b pb-6",children:[e.jsx(r,{variant:"outline",size:"icon",onClick:()=>R("/admin/roles"),className:"h-10 w-10 rounded-full",children:e.jsx(l,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Create New Role"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Define a new role with specific permissions and access levels"})]})]}),e.jsx("form",{onSubmit:async e=>{if(e.preventDefault(),I.name.trim())try{F(!0),await f.createRole({name:I.name,description:I.description,permissions:I.permissions,pages:[],level:I.level,isActive:I.isActive,isSystemRole:!1}),R("/admin/roles")}catch(s){}finally{F(!1)}else D({title:"Validation Error",description:"Role name is required",variant:"destructive"})},className:"space-y-8",children:e.jsxs("div",{className:"grid gap-8 md:grid-cols-[1fr_300px]",children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs(n,{className:"border-l-4 border-l-primary shadow-sm",children:[e.jsx(t,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(c,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx(d,{children:"Basic Information"}),e.jsx(o,{children:"Core details about this role"})]})]})}),e.jsxs(m,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"name",className:"text-base",children:["Role Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(p,{id:"name",value:I.name,onChange:e=>q({...I,name:e.target.value}),placeholder:"e.g., Content Manager",className:"h-11",required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"A unique name to identify this role"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"description",className:"text-base",children:"Description"}),e.jsx(h,{id:"description",value:I.description,onChange:e=>q({...I,description:e.target.value}),placeholder:"Describe the purpose and responsibilities of this role...",className:"min-h-[120px] resize-none"})]})]})]}),e.jsxs(n,{className:"border-l-4 border-l-blue-500 shadow-sm",children:[e.jsx(t,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(C,{className:"h-5 w-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx(d,{children:"Permissions"}),e.jsx(o,{children:"Select which permissions this role has"})]})]}),e.jsxs(j,{variant:"secondary",className:"text-sm px-3 py-1",children:[I.permissions.length," Selected"]})]})}),e.jsxs(m,{children:[e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-950/20 rounded-lg border border-blue-100 dark:border-blue-900/50 flex gap-3",children:[e.jsx(A,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-900 dark:text-blue-100",children:[e.jsx("p",{className:"font-medium mb-1",children:"Permission Control"}),e.jsx("p",{className:"text-blue-700 dark:text-blue-300 leading-relaxed",children:"Permissions are grouped by module. Expand a group to see available actions. Granting a permission allows users with this role to perform specific actions."})]})]}),e.jsx(v,{type:"multiple",className:"w-full space-y-4",children:u.map(s=>{const i=s.permissions.map(e=>e.id),a=i.filter(e=>I.permissions.includes(e)).length,r=a===i.length;return e.jsxs(y,{value:s.id,className:"border rounded-lg px-4 bg-card",children:[e.jsx(w,{className:"hover:no-underline py-4",children:e.jsxs("div",{className:"flex items-center justify-between w-full pr-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-semibold text-lg",children:s.label}),a>0&&e.jsxs(j,{variant:r?"default":"secondary",className:"text-xs",children:[a,"/",s.permissions.length]})]}),e.jsx("div",{onClick:e=>{e.stopPropagation(),(e=>{const s=u.find(s=>s.id===e);if(!s)return;const i=s.permissions.map(e=>e.id),a=i.every(e=>I.permissions.includes(e));q(a?e=>({...e,permissions:e.permissions.filter(e=>!i.includes(e))}):e=>({...e,permissions:[...new Set([...e.permissions,...i])]}))})(s.id)},className:"flex items-center gap-1.5 text-sm font-medium text-primary hover:text-primary/80 transition-colors px-3 py-1.5 rounded-md hover:bg-primary/10",children:r?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-4 h-4"}),"Deselect All"]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4"}),"Select All"]})})]})}),e.jsxs(k,{className:"pb-4 pt-2",children:[e.jsx(g,{className:"mb-4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.permissions.map(s=>e.jsxs("div",{className:`\n                                  flex items-start space-x-3 p-3 rounded-lg border transition-all duration-200\n                                  ${I.permissions.includes(s.id)?"bg-primary/5 border-primary/20 shadow-sm":"hover:bg-accent/50 border-transparent hover:border-border"}\n                                `,children:[e.jsx(N,{id:s.id,checked:I.permissions.includes(s.id),onCheckedChange:()=>{return e=s.id,void q(s=>({...s,permissions:s.permissions.includes(e)?s.permissions.filter(s=>s!==e):[...s.permissions,e]}));var e},className:"mt-1"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{htmlFor:s.id,className:"text-sm font-medium leading-none cursor-pointer block",children:s.label}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.id})]})]},s.id))})]})]},s.id)})})]})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs(n,{className:"sticky top-24",children:[e.jsxs(t,{children:[e.jsx(d,{className:"text-lg",children:"Publish Role"}),e.jsx(o,{children:"Review and save your changes"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Status"}),e.jsx(j,{variant:I.isActive?"default":"secondary",children:I.isActive?"Active":"Draft"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Permissions"}),e.jsx("span",{className:"font-bold",children:I.permissions.length})]}),e.jsx(g,{}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(r,{type:"submit",disabled:P,className:"w-full h-11 text-base",children:P?"Creating Role...":"Create Role"}),e.jsx(r,{type:"button",variant:"outline",onClick:()=>R("/admin/roles"),disabled:P,className:"w-full",children:"Cancel"})]})]})]})})]})})]})};export{R as default};
