import{j as e}from"./ui-DHQhougw.js";import{e as s,d as i,r as a}from"./router-Bi51YGN-.js";import{a0 as t,O as r,f as n,A as l,a as d,b as c,c as o,e as m,L as h,I as p,T as x,S as u,r as j,s as v,v as g,w as f,$ as y,X as N}from"./index-D7KzNfIb.js";import{C as b}from"./checkbox-BfDnM2ZP.js";import{p as C}from"./planService-CJ3hpiob.js";import"./vendor-eVk5PToZ.js";const k=()=>{const{id:k}=s(),F=i(),{toast:P}=t(),[B,w]=a.useState(null),[I,L]=a.useState(!0),[R,O]=a.useState(!1),[S,T]=a.useState("");a.useEffect(()=>{(async()=>{if(k)try{L(!0);const e=(await C.getPlan(k)).data.plan,s=e.features.map(e=>"string"==typeof e?{name:e,description:"",enabled:!0}:e);w({...e,features:s,limits:{properties:e.limits?.properties||0,featuredListings:e.limits?.featuredListings||0,photos:e.limits?.photos||10,videoTours:e.limits?.videoTours||0,leads:e.limits?.leads||0,posters:e.limits?.posters||0,topRated:e.limits?.topRated||!1,verifiedBadge:e.limits?.verifiedBadge||!1,messages:e.limits?.messages||1e3},benefits:{topRatedInWebsite:e.benefits?.topRatedInWebsite||!1,verifiedOwnerBadge:e.benefits?.verifiedOwnerBadge||!1,marketingConsultation:e.benefits?.marketingConsultation||!1,commissionBased:e.benefits?.commissionBased||!1}})}catch(e){P({title:"Error",description:"Failed to load plan data.",variant:"destructive"}),F("/admin/plans")}finally{L(!1)}})()},[k,F,P]);const A=()=>{if(!B||!S.trim())return;const e={name:S.trim(),description:"",enabled:!0};w({...B,features:[...B.features,e]}),T("")};return I?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(r,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2 text-lg",children:"Loading plan..."})]}):B?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>F("/admin/plans"),children:e.jsx(l,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Edit Plan"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Update plan details and pricing"})]})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),B&&k)try{O(!0),await C.updatePlan(k,B),F("/admin/plans")}catch(s){}finally{O(!1)}},className:"space-y-6",children:[e.jsxs(d,{children:[e.jsx(c,{children:e.jsx(o,{children:"Basic Information"})}),e.jsxs(m,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"name",children:"Plan Name *"}),e.jsx(p,{id:"name",value:B.name,onChange:e=>w({...B,name:e.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(h,{htmlFor:"description",children:"Description *"}),e.jsx(x,{id:"description",value:B.description,onChange:e=>w({...B,description:e.target.value}),required:!0,rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"price",children:"Price *"}),e.jsx(p,{id:"price",type:"number",step:"0.01",min:"0",value:B.price,onChange:e=>w({...B,price:parseFloat(e.target.value)||0}),required:!0}),B.priceHistory&&B.priceHistory.length>1&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Previous price: ₹",B.priceHistory[B.priceHistory.length-2]?.price||"N/A"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"currency",children:"Currency"}),e.jsxs(u,{value:B.currency,onValueChange:e=>w({...B,currency:e}),children:[e.jsx(j,{children:e.jsx(v,{})}),e.jsxs(g,{children:[e.jsx(f,{value:"INR",children:"INR (₹)"}),e.jsx(f,{value:"USD",children:"USD ($)"}),e.jsx(f,{value:"EUR",children:"EUR (€)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"billing",children:"Billing Period *"}),e.jsxs(u,{value:B.billingPeriod,onValueChange:e=>w({...B,billingPeriod:e}),children:[e.jsx(j,{children:e.jsx(v,{})}),e.jsxs(g,{children:[e.jsx(f,{value:"monthly",children:"Monthly"}),e.jsx(f,{value:"yearly",children:"Yearly"}),e.jsx(f,{value:"lifetime",children:"Lifetime"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"sortOrder",children:"Sort Order"}),e.jsx(p,{id:"sortOrder",type:"number",min:"0",value:B.sortOrder,onChange:e=>w({...B,sortOrder:parseInt(e.target.value)||0})})]})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{id:"isActive",checked:B.isActive,onCheckedChange:e=>w({...B,isActive:e})}),e.jsx(h,{htmlFor:"isActive",className:"cursor-pointer",children:"Active"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{id:"isPopular",checked:B.isPopular,onCheckedChange:e=>w({...B,isPopular:e})}),e.jsx(h,{htmlFor:"isPopular",className:"cursor-pointer",children:"Mark as Popular"})]})]})]})]}),e.jsxs(d,{children:[e.jsx(c,{children:e.jsx(o,{children:"Limits & Benefits"})}),e.jsxs(m,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"properties",children:"Properties Limit"}),e.jsx(p,{id:"properties",type:"number",min:"-1",value:B.limits.properties,onChange:e=>w({...B,limits:{...B.limits,properties:parseInt(e.target.value)||0}})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"0 = unlimited"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"leads",children:"Leads Limit"}),e.jsx(p,{id:"leads",type:"number",min:"0",value:B.limits.leads,onChange:e=>w({...B,limits:{...B.limits,leads:parseInt(e.target.value)||0}})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Monthly limit"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"posters",children:"Promotional Posters"}),e.jsx(p,{id:"posters",type:"number",min:"0",value:B.limits.posters,onChange:e=>w({...B,limits:{...B.limits,posters:parseInt(e.target.value)||0}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"featuredListings",children:"Featured Listings"}),e.jsx(p,{id:"featuredListings",type:"number",min:"0",value:B.limits.featuredListings,onChange:e=>w({...B,limits:{...B.limits,featuredListings:parseInt(e.target.value)||0}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"photos",children:"Photos per Property"}),e.jsx(p,{id:"photos",type:"number",min:"0",value:B.limits.photos,onChange:e=>w({...B,limits:{...B.limits,photos:parseInt(e.target.value)||0}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"videoTours",children:"Video Tours"}),e.jsx(p,{id:"videoTours",type:"number",min:"0",value:B.limits.videoTours,onChange:e=>w({...B,limits:{...B.limits,videoTours:parseInt(e.target.value)||0}})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold",children:"Benefits"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{id:"topRated",checked:B.benefits?.topRatedInWebsite||!1,onCheckedChange:e=>w({...B,benefits:{...B.benefits,topRatedInWebsite:e}})}),e.jsx(h,{htmlFor:"topRated",className:"cursor-pointer",children:"Top Rated in Website"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{id:"verifiedBadge",checked:B.benefits?.verifiedOwnerBadge||!1,onCheckedChange:e=>w({...B,benefits:{...B.benefits,verifiedOwnerBadge:e}})}),e.jsx(h,{htmlFor:"verifiedBadge",className:"cursor-pointer",children:"Verified Owner Badge"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{id:"marketing",checked:B.benefits?.marketingConsultation||!1,onCheckedChange:e=>w({...B,benefits:{...B.benefits,marketingConsultation:e}})}),e.jsx(h,{htmlFor:"marketing",className:"cursor-pointer",children:"Marketing Consultation"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{id:"commission",checked:B.benefits?.commissionBased||!1,onCheckedChange:e=>w({...B,benefits:{...B.benefits,commissionBased:e}})}),e.jsx(h,{htmlFor:"commission",className:"cursor-pointer",children:"Commission Based"})]})]})]})]})]}),e.jsxs(d,{children:[e.jsx(c,{children:e.jsx(o,{children:"Features"})}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{placeholder:"Add a new feature...",value:S,onChange:e=>T(e.target.value),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),A())}),e.jsx(n,{type:"button",onClick:A,size:"icon",children:e.jsx(y,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"space-y-2",children:B.features.map((s,i)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsx("span",{className:"text-sm",children:s.name}),e.jsx(n,{type:"button",variant:"ghost",size:"icon",onClick:()=>(e=>{B&&w({...B,features:B.features.filter((s,i)=>i!==e)})})(i),children:e.jsx(N,{className:"w-4 h-4"})})]},i))})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(n,{type:"submit",disabled:R,children:[R&&e.jsx(r,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]}),e.jsx(n,{type:"button",variant:"outline",onClick:()=>F("/admin/plans"),children:"Cancel"})]})]})]}):e.jsx("div",{children:"Plan not found"})};export{k as default};
