import{d as c,t as a}from"./index-CiYV0Sy0.js";class l{baseUrl="https://squares-9d84.onrender.com/api";async makeRequest(r,e={}){const t=`${this.baseUrl}${r}`,n={headers:{"Content-Type":"application/json",...e.headers},...e},o=c.getToken();o&&(n.headers={...n.headers,Authorization:`Bearer ${o}`});try{const s=await fetch(t,n);if(!s.ok){const i=await s.json().catch(()=>({success:!1,message:`HTTP ${s.status}: ${s.statusText}`}));throw new Error(i.message||"An error occurred")}return await s.json()}catch(s){throw console.error("API request failed:",s),s}}async getPlans(r={}){try{const e=new URLSearchParams;Object.entries(r).forEach(([o,s])=>{s!=null&&s!==""&&e.append(o,String(s))});const t=`/plans${e.toString()?`?${e.toString()}`:""}`;return await this.makeRequest(t)}catch(e){const t=e instanceof Error?e.message:"Failed to fetch plans";throw a({title:"Error",description:t,variant:"destructive"}),e}}async getPlan(r){try{return await this.makeRequest(`/plans/${r}`)}catch(e){const t=e instanceof Error?e.message:"Failed to fetch plan";throw a({title:"Error",description:t,variant:"destructive"}),e}}async createPlan(r){try{const e=await this.makeRequest("/plans",{method:"POST",body:JSON.stringify(r)});return a({title:"Success",description:"Plan created successfully!"}),e}catch(e){const t=e instanceof Error?e.message:"Failed to create plan";throw a({title:"Error",description:t,variant:"destructive"}),e}}async updatePlan(r,e){try{const t=await this.makeRequest(`/plans/${r}`,{method:"PUT",body:JSON.stringify(e)});return a({title:"Success",description:"Plan updated successfully!"}),t}catch(t){const n=t instanceof Error?t.message:"Failed to update plan";throw a({title:"Error",description:n,variant:"destructive"}),t}}async deletePlan(r){try{await this.makeRequest(`/plans/${r}`,{method:"DELETE"}),a({title:"Success",description:"Plan deleted successfully!"})}catch(e){const t=e instanceof Error?e.message:"Failed to delete plan";throw a({title:"Error",description:t,variant:"destructive"}),e}}async togglePlanStatus(r){try{const e=await this.makeRequest(`/plans/${r}/toggle-status`,{method:"PATCH"});return a({title:"Success",description:"Plan status updated successfully!"}),e}catch(e){const t=e instanceof Error?e.message:"Failed to update plan status";throw a({title:"Error",description:t,variant:"destructive"}),e}}formatPrice(r){const e=r.currency==="INR"?"₹":r.currency==="USD"?"$":"€",t=r.billingPeriod==="monthly"?"/month":r.billingPeriod==="yearly"?"/year":"";return`${e}${r.price.toLocaleString()}${t}`}getPlanBadgeVariant(r){return r.isActive?r.isPopular?"default":"secondary":"destructive"}getFeatureNames(r){return Array.isArray(r)?r.map(e=>typeof e=="string"?e:e.name):[]}formatFeatures(r){const e=this.getFeatureNames(r);return e.length<=3?e.join(", "):`${e.slice(0,2).join(", ")} and ${e.length-2} more`}async getPriceHistory(r){try{return await this.makeRequest(`/plans/${r}/price-history`)}catch(e){const t=e instanceof Error?e.message:"Failed to fetch price history";throw a({title:"Error",description:t,variant:"destructive"}),e}}}const p=new l;export{p};
