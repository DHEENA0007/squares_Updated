import{j as e}from"./ui-DHQhougw.js";import{r as s}from"./router-Bi51YGN-.js";import{a0 as t,aA as r,H as a,I as i,a as l,e as c,b as d,c as n,d as x,h as o,x as m,B as j,f as h,E as p,R as f,V as N,W as g,Y as u,Z as y,a1 as v}from"./index-D7KzNfIb.js";import{f as b,h as w}from"./apiUtils-CzxUIkbq.js";import{C as R}from"./circle-alert-CnFPhnT_.js";import{C as k}from"./calendar-22zCFttS.js";import{R as C}from"./rotate-ccw-jf2yGR4h.js";import"./vendor-eVk5PToZ.js";const S=()=>{const[S,P]=s.useState([]),[$,A]=s.useState(!0),[B,T]=s.useState(""),[D,E]=s.useState(1),[I,_]=s.useState(1),[V,z]=s.useState(null),[F,L]=s.useState(!1),[O,U]=s.useState({}),{toast:Z}=t();s.useEffect(()=>{H()},[D,B]);const H=async()=>{try{A(!0);const e=await b(`/subadmin/properties/rejected?page=${D}&search=${B}`),s=await w(e);P(s.data.properties||[]),_(s.data.totalPages||1)}catch(e){Z({title:"Error",description:e.message||"Error fetching rejected properties",variant:"destructive"}),P([])}finally{A(!1)}};r("property_rejected",e=>{Z({title:"Property Rejected",description:"A property has been rejected"}),H()});const W=async e=>{try{U({...O,[e]:!0});const s=await b(`/subadmin/properties/${e}/reactivate`,{method:"POST"});await w(s),Z({title:"Success",description:"Property reactivated and moved to pending review"}),H()}catch(s){Z({title:"Error",description:"Failed to reactivate property",variant:"destructive"})}finally{U({...O,[e]:!1})}},Y=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(e);return $&&0===S.length?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Property Rejections"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"View and manage rejected property listings"})]}),e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-32 bg-gray-200 rounded-lg"},s))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Property Rejections"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"View and manage rejected property listings"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(i,{placeholder:"Search rejected properties by title, city, state, email, or description...",value:B,onChange:e=>T(e.target.value),className:"pl-10"})]}),e.jsx("div",{className:"space-y-4",children:0===S.length?e.jsx(l,{children:e.jsxs(c,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(R,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"No Rejected Properties"}),e.jsx("p",{className:"text-muted-foreground text-center",children:"There are no rejected properties at the moment"})]})}):S.map(s=>e.jsxs(l,{className:"border-l-4 border-l-red-500 overflow-hidden",children:[e.jsx(d,{className:"pb-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-2 flex-1 text-center sm:text-left",children:[e.jsx(n,{className:"text-lg sm:text-xl leading-tight",children:s.title}),e.jsx(x,{className:"space-y-1",children:e.jsxs("div",{className:"flex flex-wrap justify-center sm:justify-start items-center gap-2 sm:gap-4 text-xs sm:text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(o,{className:"h-3 w-3 flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:[s.address.city,", ",s.address.state]})]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"h-3 w-3 flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:["Rejected: ",s.rejectedAt?new Date(s.rejectedAt).toLocaleDateString():"N/A"]})]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(m,{className:"h-3 w-3 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.owner.email})]})]})}),s.rejectionReason&&e.jsx("div",{className:"bg-red-50 dark:bg-red-950 border border-red-200 dark:border-red-800 rounded-lg p-2 sm:p-3 mt-3 mx-auto sm:mx-0 max-w-full",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(R,{className:"h-4 w-4 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-red-900 dark:text-red-100",children:"Rejection Reason:"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1 break-words",children:s.rejectionReason}),s.rejectedBy&&e.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1 truncate",children:["Rejected by: ",s.rejectedBy.name]})]})]})})]}),e.jsxs("div",{className:"text-center sm:text-right flex-shrink-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-primary mb-2",children:Y(s.price)}),e.jsxs("div",{className:"flex flex-col gap-1 items-center sm:items-end",children:[e.jsx(j,{variant:"destructive",className:"text-xs px-2 py-1 font-semibold",children:"Rejected"}),e.jsxs(j,{variant:"outline",className:"text-xs px-2 py-1 bg-blue-50 text-blue-700 border-blue-200",children:[s.type," â€¢ ",s.listingType]})]})]})]})}),e.jsx(c,{className:"pt-0",children:e.jsx("div",{className:"flex flex-col sm:flex-row gap-2 sm:justify-start",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full",children:[e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>{z(s),L(!0)},className:"flex-1 touch-manipulation min-h-[40px]",children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),"View Details"]}),e.jsxs(h,{size:"sm",variant:"secondary",onClick:()=>W(s._id),disabled:O[s._id],className:"flex-1 touch-manipulation min-h-[40px]",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Reactivate for Review"]})]})})})]},s._id))}),I>1&&e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(h,{variant:"outline",disabled:1===D,onClick:()=>E(D-1),children:"Previous"}),e.jsxs("span",{className:"px-3 py-2 text-sm",children:["Page ",D," of ",I]}),e.jsx(h,{variant:"outline",disabled:D===I,onClick:()=>E(D+1),children:"Next"})]}),e.jsx(f,{open:F,onOpenChange:L,children:e.jsxs(N,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(g,{children:[e.jsx(u,{children:V?.title}),e.jsx(y,{children:"Rejected property details and information"})]}),V&&e.jsxs("div",{className:"space-y-4",children:[V.rejectionReason&&e.jsx("div",{className:"bg-red-50 dark:bg-red-950 border border-red-200 dark:border-red-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(R,{className:"h-5 w-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-red-900 dark:text-red-100",children:"Rejection Reason:"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:V.rejectionReason}),V.rejectedBy&&e.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 mt-2",children:["Rejected by: ",V.rejectedBy.name," (",V.rejectedBy.email,")"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Property Details"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Type:"})," ",V.type]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Listing Type:"})," ",V.listingType]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Price:"})," ",Y(V.price)]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Area:"})," ",(q=V.area,q.builtUp?`${q.builtUp} ${q.unit}`:q.plot?`${q.plot} ${q.unit}`:q.carpet?`${q.carpet} ${q.unit}`:"N/A")]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Bedrooms:"})," ",V.bedrooms]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Bathrooms:"})," ",V.bathrooms]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Location & Contact"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Address:"})," ",V.address.street]}),e.jsxs("li",{children:[e.jsx("strong",{children:"City:"})," ",V.address.city]}),e.jsxs("li",{children:[e.jsx("strong",{children:"State:"})," ",V.address.state]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Zip Code:"})," ",V.address.zipCode]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Owner:"})," ",V.owner.name]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Email:"})," ",V.owner.email]})]})]})]}),V.description&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Description"}),e.jsx("p",{className:"text-sm",children:V.description})]}),V.images&&V.images.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Images"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:V.images.map((s,t)=>e.jsx("img",{src:s,alt:`Property ${t+1}`,className:"w-full h-32 object-cover rounded"},t))})]})]}),e.jsxs(v,{children:[e.jsx(h,{variant:"outline",onClick:()=>L(!1),children:"Close"}),V&&e.jsxs(h,{variant:"secondary",onClick:()=>{W(V._id),L(!1)},children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Reactivate for Review"]})]})]})})]});var q};export{S as default};
