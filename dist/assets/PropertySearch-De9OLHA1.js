import{b as be,j as e,c as Ne,a as we,e as K,P as I,u as V,F as ye,Q as Pe}from"./ui-DOY6021Z.js";import{r as l,d as Ce}from"./router-2SVJvIbS.js";import{az as ne,ay as Re,g as Ee,G as ke,ao as De,a as O,e as U,H as _e,I as Te,q as G,r as Y,s as q,v as W,w,f as F,aq as se,at as Be,B as re,h as Me,am as Ae,an as Fe}from"./index-DJqidggL.js";import{C as Ke}from"./checkbox-DRMy5EYZ.js";import{f as Q}from"./favoriteService-CIFQEoBV.js";import{L as Ve}from"./loader-circle-C0zUPQir.js";import{S as He}from"./square-C50VkgzQ.js";import"./vendor-Dazix4UH.js";var ae=["PageUp","PageDown"],oe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ie={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},H="Slider",[X,Ie,Le]=we(H),[le]=Ne(H,[Le]),[ze,L]=le(H),ce=l.forwardRef((s,r)=>{const{name:n,min:a=0,max:c=100,step:m=1,orientation:o="horizontal",disabled:d=!1,minStepsBetweenThumbs:x=0,defaultValue:y=[a],value:g,onValueChange:i=()=>{},onValueCommit:f=()=>{},inverted:N=!1,form:j,...S}=s,u=l.useRef(new Set),h=l.useRef(0),b=o==="horizontal"?$e:Oe,[v=[],k]=be({prop:g,defaultProp:y,onChange:P=>{[...u.current][h.current]?.focus(),i(P)}}),M=l.useRef(v);function D(P){const E=We(v,P);_(P,E)}function z(P){_(P,h.current)}function $(){const P=M.current[h.current];v[h.current]!==P&&f(v)}function _(P,E,{commit:T}={commit:!1}){const t=Ze(m),p=et(Math.round((P-a)/m)*m+a,t),C=ne(p,[a,c]);k((A=[])=>{const B=Ye(A,C,E);if(Je(B,x*m)){h.current=B.indexOf(C);const te=String(B)!==String(A);return te&&T&&f(B),te?B:A}else return A})}return e.jsx(ze,{scope:s.__scopeSlider,name:n,disabled:d,min:a,max:c,valueIndexToChangeRef:h,thumbs:u.current,values:v,orientation:o,form:j,children:e.jsx(X.Provider,{scope:s.__scopeSlider,children:e.jsx(X.Slot,{scope:s.__scopeSlider,children:e.jsx(b,{"aria-disabled":d,"data-disabled":d?"":void 0,...S,ref:r,onPointerDown:K(S.onPointerDown,()=>{d||(M.current=v)}),min:a,max:c,inverted:N,onSlideStart:d?void 0:D,onSlideMove:d?void 0:z,onSlideEnd:d?void 0:$,onHomeKeyDown:()=>!d&&_(a,0,{commit:!0}),onEndKeyDown:()=>!d&&_(c,v.length-1,{commit:!0}),onStepKeyDown:({event:P,direction:E})=>{if(!d){const p=ae.includes(P.key)||P.shiftKey&&oe.includes(P.key)?10:1,C=h.current,A=v[C],B=m*p*E;_(A+B,C,{commit:!0})}}})})})})});ce.displayName=H;var[de,me]=le(H,{startEdge:"left",endEdge:"right",size:"width",direction:1}),$e=l.forwardRef((s,r)=>{const{min:n,max:a,dir:c,inverted:m,onSlideStart:o,onSlideMove:d,onSlideEnd:x,onStepKeyDown:y,...g}=s,[i,f]=l.useState(null),N=V(r,b=>f(b)),j=l.useRef(void 0),S=ye(c),u=S==="ltr",h=u&&!m||!u&&m;function R(b){const v=j.current||i.getBoundingClientRect(),k=[0,v.width],D=ee(k,h?[n,a]:[a,n]);return j.current=v,D(b-v.left)}return e.jsx(de,{scope:s.__scopeSlider,startEdge:h?"left":"right",endEdge:h?"right":"left",direction:h?1:-1,size:"width",children:e.jsx(ue,{dir:S,"data-orientation":"horizontal",...g,ref:N,style:{...g.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:b=>{const v=R(b.clientX);o?.(v)},onSlideMove:b=>{const v=R(b.clientX);d?.(v)},onSlideEnd:()=>{j.current=void 0,x?.()},onStepKeyDown:b=>{const k=ie[h?"from-left":"from-right"].includes(b.key);y?.({event:b,direction:k?-1:1})}})})}),Oe=l.forwardRef((s,r)=>{const{min:n,max:a,inverted:c,onSlideStart:m,onSlideMove:o,onSlideEnd:d,onStepKeyDown:x,...y}=s,g=l.useRef(null),i=V(r,g),f=l.useRef(void 0),N=!c;function j(S){const u=f.current||g.current.getBoundingClientRect(),h=[0,u.height],b=ee(h,N?[a,n]:[n,a]);return f.current=u,b(S-u.top)}return e.jsx(de,{scope:s.__scopeSlider,startEdge:N?"bottom":"top",endEdge:N?"top":"bottom",size:"height",direction:N?1:-1,children:e.jsx(ue,{"data-orientation":"vertical",...y,ref:i,style:{...y.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:S=>{const u=j(S.clientY);m?.(u)},onSlideMove:S=>{const u=j(S.clientY);o?.(u)},onSlideEnd:()=>{f.current=void 0,d?.()},onStepKeyDown:S=>{const h=ie[N?"from-bottom":"from-top"].includes(S.key);x?.({event:S,direction:h?-1:1})}})})}),ue=l.forwardRef((s,r)=>{const{__scopeSlider:n,onSlideStart:a,onSlideMove:c,onSlideEnd:m,onHomeKeyDown:o,onEndKeyDown:d,onStepKeyDown:x,...y}=s,g=L(H,n);return e.jsx(I.span,{...y,ref:r,onKeyDown:K(s.onKeyDown,i=>{i.key==="Home"?(o(i),i.preventDefault()):i.key==="End"?(d(i),i.preventDefault()):ae.concat(oe).includes(i.key)&&(x(i),i.preventDefault())}),onPointerDown:K(s.onPointerDown,i=>{const f=i.target;f.setPointerCapture(i.pointerId),i.preventDefault(),g.thumbs.has(f)?f.focus():a(i)}),onPointerMove:K(s.onPointerMove,i=>{i.target.hasPointerCapture(i.pointerId)&&c(i)}),onPointerUp:K(s.onPointerUp,i=>{const f=i.target;f.hasPointerCapture(i.pointerId)&&(f.releasePointerCapture(i.pointerId),m(i))})})}),fe="SliderTrack",xe=l.forwardRef((s,r)=>{const{__scopeSlider:n,...a}=s,c=L(fe,n);return e.jsx(I.span,{"data-disabled":c.disabled?"":void 0,"data-orientation":c.orientation,...a,ref:r})});xe.displayName=fe;var J="SliderRange",he=l.forwardRef((s,r)=>{const{__scopeSlider:n,...a}=s,c=L(J,n),m=me(J,n),o=l.useRef(null),d=V(r,o),x=c.values.length,y=c.values.map(f=>ve(f,c.min,c.max)),g=x>1?Math.min(...y):0,i=100-Math.max(...y);return e.jsx(I.span,{"data-orientation":c.orientation,"data-disabled":c.disabled?"":void 0,...a,ref:d,style:{...s.style,[m.startEdge]:g+"%",[m.endEdge]:i+"%"}})});he.displayName=J;var Z="SliderThumb",pe=l.forwardRef((s,r)=>{const n=Ie(s.__scopeSlider),[a,c]=l.useState(null),m=V(r,d=>c(d)),o=l.useMemo(()=>a?n().findIndex(d=>d.ref.current===a):-1,[n,a]);return e.jsx(Ue,{...s,ref:m,index:o})}),Ue=l.forwardRef((s,r)=>{const{__scopeSlider:n,index:a,name:c,...m}=s,o=L(Z,n),d=me(Z,n),[x,y]=l.useState(null),g=V(r,R=>y(R)),i=x?o.form||!!x.closest("form"):!0,f=Pe(x),N=o.values[a],j=N===void 0?0:ve(N,o.min,o.max),S=qe(a,o.values.length),u=f?.[d.size],h=u?Qe(u,j,d.direction):0;return l.useEffect(()=>{if(x)return o.thumbs.add(x),()=>{o.thumbs.delete(x)}},[x,o.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[d.startEdge]:`calc(${j}% + ${h}px)`},children:[e.jsx(X.ItemSlot,{scope:s.__scopeSlider,children:e.jsx(I.span,{role:"slider","aria-label":s["aria-label"]||S,"aria-valuemin":o.min,"aria-valuenow":N,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...m,ref:g,style:N===void 0?{display:"none"}:s.style,onFocus:K(s.onFocus,()=>{o.valueIndexToChangeRef.current=a})})}),i&&e.jsx(ge,{name:c??(o.name?o.name+(o.values.length>1?"[]":""):void 0),form:o.form,value:N},a)]})});pe.displayName=Z;var Ge="RadioBubbleInput",ge=l.forwardRef(({__scopeSlider:s,value:r,...n},a)=>{const c=l.useRef(null),m=V(c,a),o=Re(r);return l.useEffect(()=>{const d=c.current;if(!d)return;const x=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(x,"value").set;if(o!==r&&g){const i=new Event("input",{bubbles:!0});g.call(d,r),d.dispatchEvent(i)}},[o,r]),e.jsx(I.input,{style:{display:"none"},...n,ref:m,defaultValue:r})});ge.displayName=Ge;function Ye(s=[],r,n){const a=[...s];return a[n]=r,a.sort((c,m)=>c-m)}function ve(s,r,n){const m=100/(n-r)*(s-r);return ne(m,[0,100])}function qe(s,r){return r>2?`Value ${s+1} of ${r}`:r===2?["Minimum","Maximum"][s]:void 0}function We(s,r){if(s.length===1)return 0;const n=s.map(c=>Math.abs(c-r)),a=Math.min(...n);return n.indexOf(a)}function Qe(s,r,n){const a=s/2,m=ee([0,50],[0,a]);return(a-m(r)*n)*n}function Xe(s){return s.slice(0,-1).map((r,n)=>s[n+1]-r)}function Je(s,r){if(r>0){const n=Xe(s);return Math.min(...n)>=r}return!0}function ee(s,r){return n=>{if(s[0]===s[1]||r[0]===r[1])return r[0];const a=(r[1]-r[0])/(s[1]-s[0]);return r[0]+a*(n-s[0])}}function Ze(s){return(String(s).split(".")[1]||"").length}function et(s,r){const n=Math.pow(10,r);return Math.round(s*n)/n}var je=ce,tt=xe,st=he,rt=pe;const Se=l.forwardRef(({className:s,...r},n)=>e.jsxs(je,{ref:n,className:Ee("relative flex w-full touch-none select-none items-center",s),...r,children:[e.jsx(tt,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(st,{className:"absolute h-full bg-primary"})}),e.jsx(rt,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Se.displayName=je.displayName;const ut=()=>{const s=Ce(),{toast:r}=ke(),[n,a]=l.useState([]),[c,m]=l.useState(!0),[o,d]=l.useState(""),[x,y]=l.useState("all"),[g,i]=l.useState("all"),[f,N]=l.useState("any"),[j,S]=l.useState([0,2e7]),[u,h]=l.useState([]),[R,b]=l.useState(1),[v,k]=l.useState(1),[M,D]=l.useState(new Set),z=["Swimming Pool","Gym/Fitness Center","Parking","Security","Garden/Park","Playground","Clubhouse","Power Backup","Elevator","WiFi","CCTV Surveillance","Water Supply","Fire Safety"];l.useEffect(()=>{$()},[o,x,g,f,j,u,R]);const $=async()=>{m(!0);try{const t={page:R,limit:12};o.trim()&&(t.search=o),x!=="all"&&(t.listingType=x),g!=="all"&&(t.propertyType=g),f!=="any"&&(t.bedrooms=f),j[0]>0&&(t.minPrice=j[0]),j[1]<2e7&&(t.maxPrice=j[1]),u.length>0&&(t.amenities=u);const p=await De.getProperties(t);p.success&&(a(p.data.properties),k(p.data.pagination.totalPages))}catch(t){console.error("Error loading properties:",t),r({title:"Error",description:"Failed to load properties",variant:"destructive"})}finally{m(!1)}};l.useEffect(()=>{_()},[]);const _=async()=>{try{const t=await Q.getFavorites();if(t.success){const p=new Set(t.data.favorites.map(C=>C.property?._id).filter(Boolean));D(p)}}catch(t){console.error("Error loading favorites:",t)}},P=async t=>{try{M.has(t)?(await Q.removeFromFavorites(t),D(p=>{const C=new Set(p);return C.delete(t),C}),r({title:"Removed from favorites",description:"Property removed from your favorites"})):(await Q.addToFavorites(t),D(p=>new Set(p).add(t)),r({title:"Added to favorites",description:"Property added to your favorites"}))}catch(p){console.error("Error toggling favorite:",p),r({title:"Error",description:"Failed to update favorite",variant:"destructive"})}},E=()=>{d(""),y("all"),i("all"),N("any"),S([0,2e7]),h([]),b(1)},T=t=>t>=1e7?`₹${(t/1e7).toFixed(2)} Cr`:t>=1e5?`₹${(t/1e5).toFixed(2)} L`:`₹${t.toLocaleString()}`;return e.jsxs("div",{className:"min-h-screen",children:[e.jsx("div",{className:"bg-gradient-to-r from-primary/10 to-primary/5 border-b",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Search Properties"}),e.jsx("p",{className:"text-muted-foreground",children:"Find your dream property from our verified listings"})]})}),e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsx("aside",{className:"lg:w-80 flex-shrink-0",children:e.jsx(O,{className:"sticky top-20",children:e.jsxs(U,{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Filters"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(_e,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(Te,{placeholder:"Location, property name...",value:o,onChange:t=>d(t.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Listing Type"}),e.jsxs(G,{value:x,onValueChange:y,children:[e.jsx(Y,{children:e.jsx(q,{placeholder:"Type"})}),e.jsxs(W,{children:[e.jsx(w,{value:"all",children:"All Types"}),e.jsx(w,{value:"sale",children:"For Sale"}),e.jsx(w,{value:"rent",children:"For Rent"}),e.jsx(w,{value:"lease",children:"For Lease"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Property Type"}),e.jsxs(G,{value:g,onValueChange:i,children:[e.jsx(Y,{children:e.jsx(q,{placeholder:"Property"})}),e.jsxs(W,{children:[e.jsx(w,{value:"all",children:"All Properties"}),e.jsx(w,{value:"apartment",children:"Apartment"}),e.jsx(w,{value:"villa",children:"Villa"}),e.jsx(w,{value:"house",children:"House"}),e.jsx(w,{value:"plot",children:"Plot"}),e.jsx(w,{value:"land",children:"Land"}),e.jsx(w,{value:"commercial",children:"Commercial"}),e.jsx(w,{value:"office",children:"Office"}),e.jsx(w,{value:"pg",children:"PG"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Bedrooms"}),e.jsxs(G,{value:f,onValueChange:N,children:[e.jsx(Y,{children:e.jsx(q,{placeholder:"BHK"})}),e.jsxs(W,{children:[e.jsx(w,{value:"any",children:"Any BHK"}),e.jsx(w,{value:"1",children:"1 BHK"}),e.jsx(w,{value:"2",children:"2 BHK"}),e.jsx(w,{value:"3",children:"3 BHK"}),e.jsx(w,{value:"4",children:"4+ BHK"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Price Range"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Se,{value:j,onValueChange:S,min:0,max:2e7,step:1e5,className:"w-full"}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Min Price"}),e.jsx("span",{className:"font-semibold text-primary",children:T(j[0])})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Max Price"}),e.jsx("span",{className:"font-semibold text-primary",children:T(j[1])})]})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Amenities"}),e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2 border rounded-md p-3",children:z.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ke,{id:t,checked:u.includes(t),onCheckedChange:p=>{h(p?[...u,t]:u.filter(C=>C!==t))}}),e.jsx("label",{htmlFor:t,className:"text-sm font-normal cursor-pointer leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:t})]},t))}),u.length>0&&e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[u.length," selected"]})]}),e.jsx(F,{variant:"outline",onClick:E,className:"w-full",children:"Reset Filters"})]})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Available Properties"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:c?"Loading...":`${n.length} properties found`})]}),c?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(Ve,{className:"h-8 w-8 animate-spin text-primary"})}):n.length===0?e.jsx(O,{children:e.jsxs(U,{className:"p-12 text-center",children:[e.jsx(se,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No properties found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Try adjusting your filters or search criteria"}),e.jsx(F,{onClick:E,children:"Clear Filters"})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:n.map(t=>e.jsxs(O,{className:"overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",children:[e.jsxs("div",{className:"relative h-48 bg-muted",onClick:()=>s(`/property/${t._id}`),children:[t.images&&t.images.length>0?e.jsx("img",{src:typeof t.images[0]=="string"?t.images[0]:t.images[0]?.url,alt:t.title,className:"w-full h-full object-cover",onError:p=>{const C=p.target;C.src="/placeholder-property.jpg"}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(se,{className:"h-12 w-12 text-muted-foreground"})}),e.jsx(F,{size:"icon",variant:"secondary",className:"absolute top-2 right-2",onClick:p=>{p.stopPropagation(),P(t._id)},children:e.jsx(Be,{className:`h-4 w-4 ${M.has(t._id)?"fill-red-500 text-red-500":""}`})}),e.jsx(re,{className:"absolute top-2 left-2 capitalize",children:t.listingType})]}),e.jsxs(U,{className:"p-4",onClick:()=>s(`/customer/property/${t._id}`),children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg line-clamp-1",children:t.title}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mt-1",children:[e.jsx(Me,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{className:"line-clamp-1",children:[t.address.city,", ",t.address.state]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:T(t.price)}),t.listingType==="rent"&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"/month"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[t.bedrooms>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:t.bedrooms})]}),t.bathrooms>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsx("span",{children:t.bathrooms})]}),t.area?.builtUp&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(He,{className:"h-4 w-4"}),e.jsxs("span",{children:[t.area.builtUp," sqft"]})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t",children:e.jsx(re,{variant:"outline",className:"capitalize",children:t.type})})]})]},t._id))}),v>1&&e.jsxs("div",{className:"flex justify-center gap-2 mt-8",children:[e.jsx(F,{variant:"outline",disabled:R===1,onClick:()=>b(t=>t-1),children:"Previous"}),e.jsx("div",{className:"flex items-center gap-2",children:Array.from({length:v},(t,p)=>p+1).map(t=>e.jsx(F,{variant:R===t?"default":"outline",onClick:()=>b(t),className:"w-10",children:t},t))}),e.jsx(F,{variant:"outline",disabled:R===v,onClick:()=>b(t=>t+1),children:"Next"})]})]})]})]})})]})};export{ut as default};
