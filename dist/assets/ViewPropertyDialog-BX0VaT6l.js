import{j as e}from"./ui-BNZSgpjP.js";import{r as s}from"./router-D8v2YSKU.js";import{f as r,a4 as a,a5 as l,a6 as t,a7 as i,a8 as n,k as d,B as o,bu as c,J as m,g as u,a3 as p}from"./index-Bb9pk9gg.js";import{g as x}from"./propertyUtils-41DuwCMc.js";import{E as h}from"./external-link-BoKXBjhS.js";import{I as j}from"./indian-rupee-_CoLumkx.js";const f=({url:a,className:l="",title:t="Virtual Tour"})=>{const[i,n]=s.useState(!1);if(!a)return null;const d=(e=>{if(!e)return"";if(e.includes("youtube.com/watch?v=")){const s=e.split("v=")[1]?.split("&")[0];return`https://www.youtube.com/embed/${s}`}if(e.includes("youtu.be/")){const s=e.split("youtu.be/")[1]?.split("?")[0];return`https://www.youtube.com/embed/${s}`}if(e.includes("vimeo.com/")){const s=e.split("vimeo.com/")[1]?.split("?")[0];return`https://player.vimeo.com/video/${s}`}return e.includes("google.com/maps")?e.replace("/maps/","/maps/embed/"):(e.includes("matterport.com"),e)})(a),o=(e=>!!e&&["youtube.com","youtu.be","vimeo.com","matterport.com","google.com/maps","kuula.co","roundme.com","momento360.com"].some(s=>e.includes(s)))(a);return(e=>{e&&(e.includes("youtube.com")||e.includes("youtu.be")||(e.includes("vimeo.com")||(e.includes("matterport.com")||e.includes("google.com/maps"))))})(a),i||!o?e.jsxs("div",{className:`flex flex-col items-center justify-center p-8 border-2 border-dashed rounded-lg bg-muted/50 ${l}`,children:[e.jsx(h,{className:"w-12 h-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Virtual Tour Available"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4 text-center",children:"This virtual tour needs to be opened in a new window for security reasons."}),e.jsx(r,{asChild:!0,children:e.jsxs("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(h,{className:"w-4 h-4 mr-2"}),"Open Virtual Tour"]})})]}):e.jsxs("div",{className:`relative ${l}`,children:[e.jsx("iframe",{src:d,className:"w-full h-full min-h-[400px]",allowFullScreen:!0,loading:"lazy",title:t,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",onError:()=>n(!0),sandbox:"allow-same-origin allow-scripts allow-popups allow-forms"}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(r,{size:"sm",variant:"secondary",asChild:!0,className:"bg-white/90 hover:bg-white",children:e.jsxs("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(h,{className:"w-3 h-3 mr-1"}),"Open"]})})})]})},g=({property:r,open:h,onOpenChange:g})=>{const[N,b]=s.useState([]);if(s.useEffect(()=>{h&&r&&(async()=>{if(r?.type)try{const e=(await p.getAllPropertyTypes()).find(e=>e.value===r.type);if(e){const s=(await p.getPropertyTypeFields(e.id)).filter(e=>!["price","area","description","images","videos","virtualTour","amenities"].includes(e.field_name)&&e.is_active).sort((e,s)=>(e.display_order||0)-(s.display_order||0));b(s)}}catch(e){}})()},[r,h]),!r)return null;const v=e=>{if("builtUpArea"===e.fieldName)return r.area?.builtUp?`${r.area.builtUp} ${r.area.unit||"sqft"}`:"N/A";if("carpetArea"===e.fieldName)return r.area?.carpet?`${r.area.carpet} ${r.area.unit||"sqft"}`:"N/A";if("plotArea"===e.fieldName)return r.area?.plot?`${r.area.plot} ${r.area.unit||"sqft"}`:"N/A";let s=r[e.fieldName];return null==s&&r.customFields&&(s=r.customFields[e.fieldName]),null==s?"N/A":"boolean"==typeof s?s?"Yes":"No":s.toString()};return e.jsx(a,{open:h,onOpenChange:g,children:e.jsxs(l,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(t,{children:[e.jsx(i,{className:"text-2xl",children:r.title}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(d,{className:"w-4 h-4"}),r.address.street,", ",r.address.city,", ",r.address.state," - ",r.address.pincode]})})]}),e.jsxs("div",{className:"space-y-6 mt-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(o,{variant:"available"===r.status?"default":"pending"===r.status?"outline":"destructive",children:["Status: ",r.status]}),e.jsx(o,{variant:"secondary",className:"capitalize",children:r.type?r.type.replace("_"," "):"property"}),e.jsxs(o,{variant:"sale"===r.listingType?"default":"outline",children:["For ","sale"===r.listingType?"Sale":"Rent"]}),r.featured&&e.jsx(o,{variant:"default",children:"Featured"}),r.verified&&e.jsx(o,{variant:"default",children:"Verified"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Price"}),e.jsx("p",{className:"font-semibold",children:((e,s)=>{const r=new Intl.NumberFormat("en-IN",{maximumFractionDigits:0}).format(e);return"rent"===s?`₹${r}/month`:`₹${r}`})(r.price,r.listingType)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Area"}),e.jsx("p",{className:"font-semibold",children:(y=r.area,y?.builtUp?`${y.builtUp} ${y.unit||"sqft"}`:y?.carpet?`${y.carpet} ${y.unit||"sqft"}`:y?.plot?`${y.plot} ${y.unit||"sqft"}`:"N/A")})]})]}),N.map(s=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{className:"w-5 h-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:s.field_label}),e.jsx("p",{className:"font-semibold",children:v(s)})]})]},s.id))]}),e.jsx(u,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.description})]}),r.amenities&&r.amenities.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(u,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Amenities"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.amenities.map((s,r)=>e.jsx(o,{variant:"outline",className:"capitalize",children:s.replace("_"," ")},r))})]})]}),e.jsx(u,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Owner Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Name"}),e.jsx("p",{className:"font-medium",children:x(r.owner)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Email"}),e.jsx("p",{className:"font-medium",children:r.owner?.email||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Contact Number"}),e.jsx("p",{className:"font-medium",children:r.owner?.profile?.phone||"N/A"})]})]})]}),r.images&&r.images.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(u,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Images"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:r.images.map((s,r)=>e.jsxs("div",{className:"relative aspect-video rounded-lg overflow-hidden border",children:[e.jsx("img",{src:s.url,alt:s.caption||`Property ${r+1}`,className:"w-full h-full object-cover"}),s.isPrimary&&e.jsx(o,{className:"absolute top-2 left-2",variant:"default",children:"Primary"})]},r))})]})]}),r.videos&&r.videos.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(u,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Videos"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.videos.map((s,r)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"relative aspect-video rounded-lg overflow-hidden border bg-black",children:s.url.includes("youtube.com")||s.url.includes("youtu.be")?e.jsx("iframe",{src:s.url.replace("watch?v=","embed/").replace("youtu.be/","youtube.com/embed/"),className:"w-full h-full",allowFullScreen:!0,title:s.caption||`Video ${r+1}`}):e.jsx("video",{src:s.url,controls:!0,className:"w-full h-full object-contain",poster:s.thumbnail})}),s.caption&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.caption})]},r))})]})]}),r.virtualTour&&e.jsxs(e.Fragment,{children:[e.jsx(u,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Virtual Tour"}),e.jsx(f,{url:r.virtualTour})]})]}),"rejected"===r.status&&r.rejectionReason&&e.jsxs(e.Fragment,{children:[e.jsx(u,{}),e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-red-700 mb-2",children:"Rejection Reason"}),e.jsx("p",{className:"text-sm text-red-600",children:r.rejectionReason})]})]})]})]})});var y};export{g as V};
