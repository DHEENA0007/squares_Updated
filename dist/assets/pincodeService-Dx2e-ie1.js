import{t}from"./index-Ds-LUfCl.js";import"./ui-CEFKCYQo.js";import"./router-Bi51YGN-.js";import"./vendor-eVk5PToZ.js";const e=new class{pincodeData=null;loading=!1;initialized=!1;async loadPincodeData(){if(!this.initialized&&!this.loading){this.loading=!0;try{const t="/v3/",e=await fetch(`${t}5c2f62fe-5afa-4119-a499-fec9d604d5bd.json`);if(!e.ok)throw new Error("Failed to load pincode data");const i=await e.json();this.pincodeData=i.records||[],this.initialized=!0}catch(e){this.pincodeData=[],t({title:"Warning",description:"Pincode autocomplete data could not be loaded. You can still enter pincodes manually.",variant:"destructive"})}finally{this.loading=!1}}}async getPincodeSuggestions(t,e,i,s=10){try{if(this.initialized||await this.loadPincodeData(),!this.pincodeData||0===this.pincodeData.length)return{success:!1,suggestions:[]};const a=t.toLowerCase().trim();if(a.length<1)return{success:!1,suggestions:[]};let n=this.pincodeData;if(e){const t=e.toLowerCase();n=n.filter(e=>e.statename.toLowerCase().includes(t))}if(i){const t=i.toLowerCase();n=n.filter(e=>e.district.toLowerCase().includes(t))}const o=[],c=new Set;for(const t of n){if(o.length>=3*s)break;let e=0,i=!1;t.pincode.startsWith(a)?(e+=100,i=!0):t.pincode.includes(a)?(e+=80,i=!0):t.officename.toLowerCase().includes(a)?(e+=60,i=!0):t.district.toLowerCase().includes(a)?(e+=40,i=!0):t.circlename.toLowerCase().includes(a)&&(e+=20,i=!0),i&&!c.has(t.pincode)&&(c.add(t.pincode),o.push({id:t.pincode,name:t.pincode,pincode:t.pincode,district:t.district,state:t.statename,officename:t.officename,displayName:`${t.pincode} - ${t.officename}, ${t.district}`,relevance:e}))}return{success:!0,suggestions:o.sort((t,e)=>e.relevance-t.relevance).slice(0,s)}}catch(a){return{success:!1,suggestions:[]}}}async getLocationByPincode(t){try{if(this.initialized||await this.loadPincodeData(),!this.pincodeData||0===this.pincodeData.length)return{success:!1};const e=this.pincodeData.find(e=>e.pincode===t);if(!e)return{success:!1};return{success:!0,data:{pincode:e.pincode,country:"India",state:e.statename,district:e.district,city:e.district,locality:e.officename,area:e.regionname,officename:e.officename,officetype:e.officetype,latitude:e.latitude?parseFloat(e.latitude):void 0,longitude:e.longitude?parseFloat(e.longitude):void 0,formattedAddress:`${e.officename}, ${e.district}, ${e.statename}, India - ${e.pincode}`}}}catch(e){return{success:!1}}}async validatePincode(t){try{if(!/^[1-9][0-9]{5}$/.test(t))return{success:!0,valid:!1,exists:!1,message:"Pincode must be 6 digits and cannot start with 0"};const e=await this.getLocationByPincode(t);return{success:!0,valid:!0,exists:e.success,message:e.success?`Valid pincode for ${e.data?.district}, ${e.data?.state}`:"Valid format but pincode not found in database"}}catch(e){return{success:!1,valid:!1,exists:!1,message:"Validation failed"}}}async getPincodesByState(t,e=50){try{if(this.initialized||await this.loadPincodeData(),!this.pincodeData)return{success:!1,pincodes:[]};const i=t.toLowerCase(),s=new Set;for(const t of this.pincodeData){if(s.size>=e)break;t.statename.toLowerCase().includes(i)&&s.add(t.pincode)}return{success:!0,pincodes:Array.from(s).sort()}}catch(i){return{success:!1,pincodes:[]}}}async getPincodesByDistrict(t,e,i=30){try{if(this.initialized||await this.loadPincodeData(),!this.pincodeData)return{success:!1,pincodes:[]};const s=t.toLowerCase(),a=e?.toLowerCase(),n=new Set;for(const t of this.pincodeData){if(n.size>=i)break;const e=t.district.toLowerCase().includes(s),o=!a||t.statename.toLowerCase().includes(a);e&&o&&n.add(t.pincode)}return{success:!0,pincodes:Array.from(n).sort()}}catch(s){return{success:!1,pincodes:[]}}}async initialize(){await this.loadPincodeData()}isReady(){return this.initialized&&!!this.pincodeData}getStats(){if(!this.pincodeData)return{totalRecords:0,totalPincodes:0,totalStates:0,totalDistricts:0};const t=new Set(this.pincodeData.map(t=>t.pincode)),e=new Set(this.pincodeData.map(t=>t.statename)),i=new Set(this.pincodeData.map(t=>t.district));return{totalRecords:this.pincodeData.length,totalPincodes:t.size,totalStates:e.size,totalDistricts:i.size}}};export{e as default,e as pincodeService};
