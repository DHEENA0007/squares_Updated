import{j as e}from"./ui-CEt46o3G.js";import{g as V,d as H,r as i,L as G}from"./router-2SVJvIbS.js";import{C as c,d,a as x,b as p}from"./card-YvDMUmzt.js";import{O as Q,t as n,R as D,Z as g,a as l,M as Y,L as M,$ as A,B as N,z as Z,e as J,o as K}from"./index-CiYV0Sy0.js";import{S as W}from"./separator--OCztuR5.js";import{g as X,a as ee}from"./propertyUtils-B_5yebUt.js";import{p as se}from"./propertyService-vaYzuoi1.js";import{f as y}from"./favoriteService-DXlS-i7P.js";import{P as te,a as re}from"./PropertyContactDialog-CJxUFPij.js";import{A as E}from"./arrow-left-ClppC_3T.js";import{S as T}from"./share-2-BXLCoDth.js";import{B as ae,a as ie}from"./bed-uPel24Y9.js";import{M as le}from"./maximize-C1zLHk6v.js";import{P as oe}from"./phone-BlyPoB6i.js";import{E as ne}from"./eye-CDS1ofgA.js";import"./vendor-Dazix4UH.js";import"./dialog-B2oiH0OC.js";import"./label-BV_cIshD.js";import"./textarea-BbecYreM.js";import"./messageService-DZmz6NiN.js";import"./send-DboPqPcs.js";import"./mail-hCxVaHOS.js";const De=()=>{const{id:o}=V(),m=H(),{isConnected:v}=Q(),[s,B]=i.useState(null),[I,b]=i.useState(!0),[u,h]=i.useState(!1),[w,S]=i.useState(!1),[f,q]=i.useState(0),[O,C]=i.useState(!1),[_,P]=i.useState(!1),j=i.useCallback(async()=>{if(o)try{b(!0);const t=await se.getProperty(o);if(t.success){B(t.data.property);const r=await y.isFavorite(o);h(r)}else n({title:"Error",description:"Property not found",variant:"destructive"}),m("/customer/search")}catch(t){console.error("Error loading property:",t),n({title:"Error",description:"Failed to load property details",variant:"destructive"}),m("/customer/search")}finally{b(!1)}},[o,m]);i.useEffect(()=>{j()},[j]),D("property_updated",i.useCallback(t=>{t.propertyId===o&&(console.log("Property updated via realtime, refreshing..."),j())},[o,j])),D("property_favorited",i.useCallback(t=>{t.propertyId===o&&h(t.action==="add")},[o]));const k=async()=>{if(s)try{S(!0),u?(await y.removeFromFavorites(s._id),h(!1),n({title:"Removed from favorites",description:"Property has been removed from your favorites"})):(await y.addToFavorites(s._id),h(!0),n({title:"Added to favorites",description:"Property has been added to your favorites"}))}catch(t){console.error("Error toggling favorite:",t),n({title:"Error",description:"Failed to update favorites",variant:"destructive"})}finally{S(!1)}},L=async()=>{if(navigator.share&&s)try{await navigator.share({title:s.title,text:`Check out this property: ${s.title}`,url:window.location.href})}catch{navigator.clipboard.writeText(window.location.href),n({title:"Link copied",description:"Property link has been copied to clipboard"})}else navigator.clipboard.writeText(window.location.href),n({title:"Link copied",description:"Property link has been copied to clipboard"})},z=(t,r)=>r==="rent"?`₹${t.toLocaleString("en-IN")}/month`:r==="lease"?`₹${t.toLocaleString("en-IN")}/year`:t>=1e7?`₹${(t/1e7).toFixed(1)} Cr`:t>=1e5?`₹${(t/1e5).toFixed(1)} Lac`:`₹${t.toLocaleString("en-IN")}`,$=t=>{if(!t)return"N/A";if(typeof t=="object"){if(t.builtUp)return`${t.builtUp} ${t.unit||"sq ft"}`;if(t.plot)return`${t.plot} ${t.unit||"sq ft"}`;if(t.carpet)return`${t.carpet} ${t.unit||"sq ft"}`}return typeof t=="number"?`${t} sq ft`:"N/A"},F=t=>{const r=t.area;let a=0;return typeof r=="object"&&r!==null?a=r.builtUp||r.carpet||r.plot||0:typeof r=="number"&&(a=r),a===0?0:Math.round(t.price/a)},R=t=>{const r=t.address;if(typeof r=="string")return r;const a=[];return r.street&&a.push(r.street),r.locationName&&a.push(r.locationName),r.city&&a.push(r.city),r.state&&a.push(r.state),r.pincode&&a.push(r.pincode),a.join(", ")},U=t=>{switch(t.toLowerCase()){case"available":return"bg-green-600";case"sold":return"bg-red-600";case"rented":return"bg-blue-600";case"pending":return"bg-yellow-600";default:return"bg-gray-600"}};return I?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading property details..."})]})}):s?e.jsxs("div",{className:"min-h-screen bg-background pt-20 pb-8",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-muted/50 p-3 rounded-lg",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${v?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-sm text-muted-foreground",children:v?"Real-time property updates active":"Offline mode"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>m(-1),children:e.jsx(E,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:s.title}),e.jsxs("div",{className:"flex items-center text-muted-foreground mt-1",children:[e.jsx(Y,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"text-sm",children:R(s)})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{variant:"outline",onClick:k,disabled:w,children:[e.jsx(M,{className:`w-4 h-4 mr-2 ${u?"fill-red-500 text-red-500":""}`}),u?"Favorited":"Add to Favorites"]}),e.jsxs(l,{variant:"outline",onClick:L,children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Share"]}),e.jsxs(l,{onClick:()=>{const t=[s._id];m(`/customer/compare?properties=${t.join(",")}`)},children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Compare"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(N,{className:`${U(s.status)} text-white`,children:s.status}),s.featured&&e.jsxs(N,{variant:"secondary",children:[e.jsx(Z,{className:"w-3 h-3 mr-1"}),"Featured"]}),s.verified&&e.jsx(N,{className:"bg-green-600 text-white",children:"Verified"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-primary",children:z(s.price,s.listingType)}),F(s)>0&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["₹",F(s),"/sq ft"]})]})]}),s.images&&s.images.length>0&&e.jsx(c,{children:e.jsxs(d,{className:"p-0",children:[e.jsx("div",{className:"aspect-video bg-muted rounded-lg overflow-hidden",children:e.jsx("img",{src:typeof s.images[f]=="string"?s.images[f]:s.images[f].url,alt:s.title,className:"w-full h-full object-cover",onError:t=>{t.currentTarget.src="/placeholder-property.jpg"}})}),s.images.length>1&&e.jsx("div",{className:"flex gap-2 p-4 overflow-x-auto",children:s.images.map((t,r)=>e.jsx("button",{onClick:()=>q(r),className:`flex-shrink-0 w-20 h-16 rounded-lg overflow-hidden border-2 ${r===f?"border-primary":"border-transparent"}`,children:e.jsx("img",{src:typeof t=="string"?t:t.url,alt:`Property image ${r+1}`,className:"w-full h-full object-cover",onError:a=>{a.currentTarget.src="/placeholder-property.jpg"}})},r))})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(c,{children:[e.jsx(x,{children:e.jsxs(p,{className:"flex items-center",children:[e.jsx(g,{className:"w-5 h-5 mr-2"}),"Property Overview"]})}),e.jsxs(d,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.bedrooms&&s.bedrooms>0&&e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx(ae,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-2xl font-bold",children:s.bedrooms}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bedrooms"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx(ie,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-2xl font-bold",children:s.bathrooms||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bathrooms"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx(le,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-2xl font-bold",children:$(s.area).split(" ")[0]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sq Ft"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx(g,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-2xl font-bold capitalize",children:s.type}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Type"})]})]}),s.description&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-muted-foreground leading-relaxed",children:s.description})]})]})]}),e.jsxs(c,{children:[e.jsx(x,{children:e.jsx(p,{children:"Property Details"})}),e.jsx(d,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Property Type:"}),e.jsx("span",{className:"font-medium capitalize",children:s.type})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Listing Type:"}),e.jsx("span",{className:"font-medium capitalize",children:s.listingType})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Bedrooms:"}),e.jsx("span",{className:"font-medium",children:s.bedrooms||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Bathrooms:"}),e.jsx("span",{className:"font-medium",children:s.bathrooms||0})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Area:"}),e.jsx("span",{className:"font-medium",children:$(s.area)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx("span",{className:"font-medium capitalize",children:s.status})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Listed On:"}),e.jsx("span",{className:"font-medium",children:new Date(s.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Property ID:"}),e.jsx("span",{className:"font-medium text-xs",children:s._id})]})]})]})})]}),s.amenities&&s.amenities.length>0&&e.jsxs(c,{children:[e.jsx(x,{children:e.jsx(p,{children:"Amenities"})}),e.jsx(d,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:s.amenities.map((t,r)=>e.jsxs("div",{className:"flex items-center p-3 bg-muted rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mr-3"}),e.jsx("span",{className:"text-sm",children:t})]},r))})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(c,{children:[e.jsx(x,{children:e.jsxs(p,{className:"flex items-center",children:[e.jsx(J,{className:"w-5 h-5 mr-2"}),"Contact Information"]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-medium",children:X(s.owner)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:ee(s)})]}),e.jsx(W,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(l,{className:"w-full",onClick:()=>P(!0),children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Call Owner"]}),e.jsxs(l,{variant:"outline",className:"w-full",onClick:()=>C(!0),children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Send Message"]})]})]})]}),e.jsxs(c,{children:[e.jsx(x,{children:e.jsxs(p,{className:"flex items-center",children:[e.jsx(ne,{className:"w-5 h-5 mr-2"}),"Property Stats"]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Views"}),e.jsx("span",{className:"font-semibold",children:s.views||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Listed"}),e.jsxs("span",{className:"font-semibold",children:[Math.floor((Date.now()-new Date(s.createdAt).getTime())/(1e3*60*60*24))," days ago"]})]})]})]}),e.jsxs(c,{children:[e.jsx(x,{children:e.jsx(p,{children:"Quick Actions"})}),e.jsxs(d,{className:"space-y-3",children:[e.jsxs(l,{variant:"outline",className:"w-full justify-start",onClick:k,disabled:w,children:[e.jsx(M,{className:`w-4 h-4 mr-2 ${u?"fill-red-500 text-red-500":""}`}),u?"Remove from Favorites":"Add to Favorites"]}),e.jsxs(l,{variant:"outline",className:"w-full justify-start",onClick:()=>{const t=[s._id];m(`/customer/compare?properties=${t.join(",")}`)},children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Compare Property"]}),e.jsxs(l,{variant:"outline",className:"w-full justify-start",onClick:L,children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Share Property"]})]})]})]})]})]}),e.jsx(te,{open:O,onOpenChange:C,property:s,onMessageSent:()=>{console.log("Message sent for property:",s._id),n({title:"Message sent",description:"Your inquiry has been sent to the property owner"})}}),e.jsx(re,{open:_,onOpenChange:P,property:s})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(g,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Property Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"The property you're looking for doesn't exist."}),e.jsx(G,{to:"/customer/search",children:e.jsxs(l,{children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Back to Search"]})})]})})};export{De as default};
