import{D as c,t as a}from"./index-Bd1eLXM_.js";class l{baseUrl="https://api.akodefy.com/api";async makeRequest(r,e={}){const t=`${this.baseUrl}${r}`,o={headers:{"Content-Type":"application/json",...e.headers},...e},n=c.getToken();n&&(o.headers={...o.headers,Authorization:`Bearer ${n}`});try{const s=await fetch(t,o);if(!s.ok){const i=await s.json().catch(()=>({success:!1,message:`HTTP ${s.status}: ${s.statusText}`}));throw new Error(i.message||"An error occurred")}return await s.json()}catch(s){throw console.error("API request failed:",s),s}}async getRoles(r={}){try{const e=new URLSearchParams;Object.entries(r).forEach(([n,s])=>{s!=null&&s!==""&&e.append(n,String(s))});const t=`/roles${e.toString()?`?${e.toString()}`:""}`;return await this.makeRequest(t)}catch(e){const t=e instanceof Error?e.message:"Failed to fetch roles";throw a({title:"Error",description:t,variant:"destructive"}),e}}async getRole(r){try{return await this.makeRequest(`/roles/${r}`)}catch(e){const t=e instanceof Error?e.message:"Failed to fetch role";throw a({title:"Error",description:t,variant:"destructive"}),e}}async getAdminRoles(){try{const r=await this.getRoles({limit:100}),e=r.data.roles.find(o=>o.name.toLowerCase()==="superadmin")||null,t=r.data.roles.find(o=>o.name.toLowerCase()==="subadmin")||null;return{superAdmin:e,subAdmin:t}}catch(r){return console.error("Failed to fetch admin roles:",r),{superAdmin:null,subAdmin:null}}}async createRole(r){try{const e=await this.makeRequest("/roles",{method:"POST",body:JSON.stringify(r)});return a({title:"Success",description:"Role created successfully!"}),e}catch(e){const t=e instanceof Error?e.message:"Failed to create role";throw a({title:"Error",description:t,variant:"destructive"}),e}}async updateRole(r,e){try{const t=await this.makeRequest(`/roles/${r}`,{method:"PUT",body:JSON.stringify(e)});return a({title:"Success",description:"Role updated successfully!"}),t}catch(t){const o=t instanceof Error?t.message:"Failed to update role";throw a({title:"Error",description:o,variant:"destructive"}),t}}async deleteRole(r){try{await this.makeRequest(`/roles/${r}`,{method:"DELETE"}),a({title:"Success",description:"Role deleted successfully!"})}catch(e){const t=e instanceof Error?e.message:"Failed to delete role";throw a({title:"Error",description:t,variant:"destructive"}),e}}async toggleRoleStatus(r){try{const e=await this.makeRequest(`/roles/${r}/toggle-status`,{method:"PATCH"});return a({title:"Success",description:"Role status updated successfully!"}),e}catch(e){const t=e instanceof Error?e.message:"Failed to update role status";throw a({title:"Error",description:t,variant:"destructive"}),e}}async getPermissions(){try{return(await this.makeRequest("/roles/permissions")).data.permissions}catch(r){return console.error("Failed to fetch permissions:",r),this.getAvailablePermissions()}}getAvailablePermissions(){return["create_property","read_property","update_property","delete_property","manage_users","manage_roles","manage_plans","view_dashboard","manage_settings","manage_content","send_messages","moderate_content","access_analytics","review_properties","approve_properties","reject_properties","moderate_user_content","handle_support_tickets","track_vendor_performance","approve_promotions","send_notifications","generate_reports","approve_vendors","reject_vendors","review_vendors"]}formatPermissions(r){return r.length<=3?r.map(e=>e.replace(/_/g," ")).join(", "):`${r.slice(0,2).map(e=>e.replace(/_/g," ")).join(", ")} and ${r.length-2} more`}getRoleLevelVariant(r){return r>=8?"destructive":r>=5?"default":"secondary"}getRoleLevelText(r){return r>=8?"High":r>=5?"Medium":"Low"}}const p=new l;export{p as r};
