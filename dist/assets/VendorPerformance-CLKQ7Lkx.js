import{j as e,a5 as s,a6 as a}from"./ui-s1SEoZIF.js";import{r as l}from"./router-D8v2YSKU.js";import{ao as r,a2 as t,a as n,b as c,c as i,p as d,e as o,Q as x,$ as m,I as h,B as j,f,E as p,a4 as g,a5 as N,a6 as u,a7 as v,a8 as b}from"./index-xsqbJ4m0.js";import{T as w,a as y,b as S,c as R,d as P,e as T}from"./table-B_mPL_j-.js";import{f as $,h as A}from"./apiUtils-B8LmEMCW.js";import{T as k}from"./trending-up-pGp2EKGV.js";import"./vendor-BxThA0WO.js";const E=l.forwardRef(({className:l,value:t,...n},c)=>e.jsx(s,{ref:c,className:r("relative h-4 w-full overflow-hidden rounded-full bg-secondary",l),...n,children:e.jsx(a,{className:"h-full w-full flex-1 bg-primary transition-all rounded-full",style:{transform:`translateX(-${100-(t||0)}%)`}})}));E.displayName=s.displayName;const C=()=>{const[s,a]=l.useState([]),[r,C]=l.useState(!0),[D,M]=l.useState(""),[V,z]=l.useState(null),[B,F]=l.useState(!1),[I,L]=l.useState("performanceScore"),{toast:O}=t();l.useEffect(()=>{G()},[D,I]);const G=async()=>{try{C(!0);const e=await $(`/subadmin/vendors/performance?search=${D}&sortBy=${I}`),s=await A(e);a(s.data.vendors||[])}catch(e){O({title:"Error",description:e.message||"Error fetching vendor metrics",variant:"destructive"}),a([])}finally{C(!1)}},J=e=>e>=80?"text-green-600":e>=60?"text-yellow-600":"text-red-600",Q=e=>e>=80?{label:"Excellent",variant:"default",class:"bg-green-600"}:e>=60?{label:"Good",variant:"secondary",class:"bg-yellow-600"}:{label:"Needs Improvement",variant:"destructive",class:"bg-red-600"},U=e=>e<60?`${Math.round(e)} mins`:e<1440?`${Math.round(e/60)} hrs`:`${Math.round(e/1440)} days`;return r&&0===s.length?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Vendor Performance"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Track and analyze vendor performance metrics"})]}),e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-40 bg-gray-200 rounded-lg"},s))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Vendor Performance"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Track and analyze vendor performance metrics"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(n,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Total Vendors"}),e.jsx(d,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active property vendors"})]})]}),e.jsxs(n,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Top Performers"}),e.jsx(k,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.filter(e=>e.performanceScore>=80).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Excellent performance (80%+)"})]})]}),e.jsxs(n,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Average Rating"}),e.jsx(x,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.length>0?(s.reduce((e,s)=>e+s.averageRating,0)/s.length).toFixed(1):"0.0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Overall vendor ratings"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(m,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(h,{placeholder:"Search vendors by name or email...",value:D,onChange:e=>M(e.target.value),className:"pl-10"})]}),e.jsxs("select",{value:I,onChange:e=>L(e.target.value),className:"px-4 py-2 border rounded-md bg-background w-full sm:w-auto",children:[e.jsx("option",{value:"performanceScore",children:"Sort by Performance"}),e.jsx("option",{value:"totalProperties",children:"Sort by Properties"}),e.jsx("option",{value:"averageRating",children:"Sort by Rating"})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(w,{children:[e.jsx(y,{children:e.jsxs(S,{children:[e.jsx(R,{className:"w-[80px]",children:"Rank"}),e.jsx(R,{children:"Vendor"}),e.jsx(R,{children:"Performance"}),e.jsx(R,{children:"Properties"}),e.jsx(R,{children:"Rating"}),e.jsx(R,{children:"Response"}),e.jsx(R,{className:"text-right",children:"Actions"})]})}),e.jsx(P,{children:0===s.length?e.jsx(S,{children:e.jsx(T,{colSpan:7,className:"h-24 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(d,{className:"h-8 w-8 text-muted-foreground mb-2"}),e.jsx("p",{children:"No vendors found"})]})})}):s.map((s,a)=>{const l=Q(s.performanceScore);return e.jsxs(S,{children:[e.jsxs(T,{className:"font-medium",children:["#",a+1]}),e.jsx(T,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.email})]})}),e.jsx(T,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`text-lg font-bold ${J(s.performanceScore)}`,children:[s.performanceScore,"%"]}),e.jsx(j,{className:`${l.class} text-white hover:${l.class}`,children:l.label})]})}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-sm",children:[s.activeProperties," / ",s.totalProperties," Active"]}),e.jsx(E,{value:s.totalProperties>0?s.activeProperties/s.totalProperties*100:0,className:"h-1.5 w-[100px]"})]})}),e.jsx(T,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(x,{className:"h-4 w-4 fill-yellow-500 text-yellow-500"}),e.jsx("span",{children:s.averageRating.toFixed(1)}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",s.totalReviews,")"]})]})}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-sm",children:[s.responseRate,"% Rate"]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[U(s.averageResponseTime)," Avg"]})]})}),e.jsx(T,{className:"text-right",children:e.jsxs(f,{variant:"ghost",size:"sm",onClick:()=>{z(s),F(!0)},children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),"Details"]})})]},s._id)})})]})}),e.jsx(g,{open:B,onOpenChange:F,children:e.jsxs(N,{className:"max-w-3xl mx-4 sm:mx-auto max-h-[85vh] overflow-y-auto",children:[e.jsxs(u,{children:[e.jsxs(v,{className:"text-lg sm:text-xl",children:[V?.name," - Performance Details"]}),e.jsx(b,{className:"text-sm",children:"Comprehensive performance metrics and statistics"})]}),V&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Contact Information"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Email:"})," ",e.jsx("span",{className:"break-words",children:V.email})]}),V.phone&&e.jsxs("li",{children:[e.jsx("strong",{children:"Phone:"})," ",V.phone]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Joined:"})," ",new Date(V.joinedDate).toLocaleDateString()]}),V.lastActive&&e.jsxs("li",{children:[e.jsx("strong",{children:"Last Active:"})," ",new Date(V.lastActive).toLocaleDateString()]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Performance Score"}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-3xl sm:text-5xl font-bold ${J(V.performanceScore)}`,children:[V.performanceScore,"%"]}),e.jsx(j,{className:`mt-2 ${Q(V.performanceScore).class}`,children:Q(V.performanceScore).label})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Property Statistics"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-muted p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:V.totalProperties}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total"})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-950 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-green-600",children:V.activeProperties}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active"})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-950 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-red-600",children:V.rejectedProperties}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Rejected"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Customer Engagement"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-sm",children:"Average Rating"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"h-4 w-4 fill-yellow-500 text-yellow-500 flex-shrink-0"}),e.jsxs("span",{className:"font-semibold",children:[V.averageRating.toFixed(1)," / 5.0"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-sm",children:"Total Reviews"}),e.jsx("span",{className:"font-semibold",children:V.totalReviews})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-sm",children:"Total Messages"}),e.jsx("span",{className:"font-semibold",children:V.totalMessages})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-sm",children:"Response Rate"}),e.jsxs("span",{className:"font-semibold",children:[V.responseRate,"%"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-sm",children:"Average Response Time"}),e.jsx("span",{className:"font-semibold",children:U(V.averageResponseTime)})]})]})]})]})]})})]})};export{C as default};
