import{j as e}from"./ui-DHQhougw.js";import{r as s}from"./router-Bi51YGN-.js";import{r as t,R as a,aB as r,x as n,I as l,a4 as i,a5 as d,a6 as c,ak as o,a as x,e as m,b as p,c as h,B as j,d as u,p as g,f as v,E as N,C as f,w as b,D as y,G as w,J as R,K as k,O as C,T as S,a1 as D,af as _,ar as A}from"./index-B494FSRu.js";import{f as B,h as $}from"./apiUtils-H5kZq7Df.js";import{I as E}from"./image-LCarBDKg.js";import"./vendor-eVk5PToZ.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=t("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]),z=()=>{const[t,z]=s.useState([]),[F,I]=s.useState(!0),[M,T]=s.useState(""),[V,G]=s.useState("pending"),[J,K]=s.useState(null),[L,P]=s.useState(!1),[U,q]=s.useState(!1),[H,Q]=s.useState("approve"),[W,X]=s.useState(""),[Y,Z]=s.useState({}),{toast:ee}=a();s.useEffect(()=>{se()},[V,M]);const se=async()=>{try{I(!0);const e=await B(`/subadmin/content/reports?status=${V}&search=${M}`),s=await $(e);z(s.data.reports||[])}catch(e){ee({title:"Error",description:e.message||"Error fetching content reports",variant:"destructive"}),z([])}finally{I(!1)}};r("content_reported",e=>{ee({title:"New Report",description:"New content has been reported for moderation"}),"pending"===V&&se()});const te=s=>{switch(s){case"property":return e.jsx(E,{className:"h-4 w-4"});case"review":return e.jsx(A,{className:"h-4 w-4"});case"message":return e.jsx(_,{className:"h-4 w-4"});case"user":return e.jsx(g,{className:"h-4 w-4"});default:return e.jsx(O,{className:"h-4 w-4"})}},ae=e=>{switch(e){case"property":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"review":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"message":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200";case"user":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}};return F&&0===t.length?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Content Moderation"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Review and moderate reported content"})]}),e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-32 bg-gray-200 rounded-lg"},s))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Content Moderation"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Review and moderate reported content"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(l,{placeholder:"Search reports...",value:M,onChange:e=>T(e.target.value),className:"pl-10"})]}),e.jsxs(i,{value:V,onValueChange:G,children:[e.jsxs(d,{children:[e.jsx(c,{value:"pending",children:"Pending"}),e.jsx(c,{value:"resolved",children:"Resolved"}),e.jsx(c,{value:"dismissed",children:"Dismissed"})]}),e.jsx(o,{value:V,className:"space-y-4 mt-6",children:0===t.length?e.jsx(x,{children:e.jsxs(m,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(O,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"No Reports Found"}),e.jsx("p",{className:"text-muted-foreground text-center",children:"pending"===V?"All reports have been reviewed. Great job!":`No ${V} reports to display`})]})}):t.map(s=>e.jsxs(x,{className:"border-l-4 border-l-orange-500",children:[e.jsx(p,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"text-lg",children:"Content Report"}),e.jsx(j,{className:ae(s.type),children:e.jsxs("span",{className:"flex items-center gap-1",children:[te(s.type),s.type.charAt(0).toUpperCase()+s.type.slice(1)]})})]}),e.jsxs(u,{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(g,{className:"h-3 w-3"}),"Reported by: ",s.reportedBy.name]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(O,{className:"h-3 w-3"}),"Reason: ",s.reason]})]}),e.jsx("p",{className:"text-sm mt-2",children:s.description})]})]}),e.jsx("div",{className:"text-right ml-4",children:e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(s.createdAt).toLocaleDateString()})})]})}),e.jsx(m,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>{K(s),P(!0)},children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"View Details"]}),"pending"===V&&e.jsxs(e.Fragment,{children:[e.jsxs(v,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>{K(s),Q("approve"),q(!0)},disabled:Y[s._id],children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Resolve"]}),e.jsxs(v,{variant:"secondary",size:"sm",onClick:()=>{K(s),Q("dismiss"),q(!0)},disabled:Y[s._id],children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Dismiss"]})]})]})})]},s._id))})]}),e.jsx(y,{open:L,onOpenChange:P,children:e.jsxs(w,{className:"max-w-3xl",children:[e.jsxs(R,{children:[e.jsx(k,{children:"Content Report Details"}),e.jsx(C,{children:"Detailed information about the reported content"})]}),J&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Report Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Type"}),e.jsx(j,{className:ae(J.type),children:J.type})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Status"}),e.jsx(j,{children:J.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Reported By"}),e.jsx("p",{children:J.reportedBy.name}),e.jsx("p",{className:"text-xs",children:J.reportedBy.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Date"}),e.jsx("p",{children:new Date(J.createdAt).toLocaleString()})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Reason"}),e.jsx("p",{className:"text-sm",children:J.reason})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-sm",children:J.description})]}),J.content&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Reported Content"}),e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[J.content.title&&e.jsx("p",{className:"font-medium",children:J.content.title}),J.content.description&&e.jsx("p",{className:"text-sm mt-2",children:J.content.description}),J.content.text&&e.jsx("p",{className:"text-sm mt-2",children:J.content.text})]})]})]})]})}),e.jsx(y,{open:U,onOpenChange:q,children:e.jsxs(w,{children:[e.jsxs(R,{children:[e.jsx(k,{children:"approve"===H?"Resolve Report":"Dismiss Report"}),e.jsx(C,{children:"approve"===H?"Add a note about the resolution (optional)":"Add a note about why this report is being dismissed (optional)"})]}),e.jsx(S,{placeholder:"Add a note...",value:W,onChange:e=>X(e.target.value),rows:4}),e.jsxs(D,{children:[e.jsx(v,{variant:"outline",onClick:()=>{q(!1),X("")},children:"Cancel"}),e.jsx(v,{onClick:async()=>{if(J)try{Z({...Y,[J._id]:!0});const e="approve"===H?"resolve":"dismiss",s=await B(`/subadmin/content/reports/${J._id}/${e}`,{method:"POST",body:JSON.stringify({note:W})});await $(s),ee({title:"Success",description:`Report ${"approve"===H?"resolved":"dismissed"} successfully`}),q(!1),X(""),K(null),se()}catch(e){ee({title:"Error",description:"Failed to process report",variant:"destructive"})}finally{Z({...Y,[J._id]:!1})}},disabled:Y[J?._id||""],className:"approve"===H?"bg-green-600 hover:bg-green-700":"",children:"approve"===H?"Resolve":"Dismiss"})]})]})})]})};export{z as default};
