import{j as e}from"./ui-CEFKCYQo.js";import{e as s,d as a,r as i}from"./router-Bi51YGN-.js";import{W as l,u as t,G as r,f as n,A as c,a as d,b as o,c as m,d as x,e as h,L as p,I as j,T as v}from"./index-Ds-LUfCl.js";import"./checkbox-DscVYI3N.js";import{r as u}from"./roleService-DIgajIoH.js";import"./vendor-eVk5PToZ.js";const g=()=>{const{id:g}=s(),f=a(),{toast:N}=l(),{isSuperAdmin:y}=t(),[b,S]=i.useState(null),[C,R]=i.useState(!0),[w,k]=i.useState(!1);i.useEffect(()=>{(async()=>{if(g)try{R(!0);const e=(await u.getRole(g)).data.role;S({...e,pages:e.pages||[]})}catch(e){N({title:"Error",description:"Failed to load role data.",variant:"destructive"}),f("/admin/roles")}finally{R(!1)}})()},[g,f,N]);return C?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(r,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2 text-lg",children:"Loading role..."})]}):b?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>f("/admin/roles"),children:e.jsx(c,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold",children:["Edit Role: ",b.name]}),e.jsx("p",{className:"text-muted-foreground",children:"Update role details and page access"})]})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),b&&g)if(b.pages&&0!==b.pages.length)try{k(!0),await u.updateRole(g,{name:b.name,description:b.description,pages:b.pages,isActive:b.isActive,level:b.level}),f("/admin/roles")}catch(s){}finally{k(!1)}else N({title:"Validation Error",description:"Please select at least one page",variant:"destructive"})},className:"space-y-6",children:[e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsx(m,{children:"Basic Information"}),e.jsx(x,{children:"Core details about this role"})]}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(p,{htmlFor:"name",children:["Role Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(j,{id:"name",value:b.name,onChange:e=>S({...b,name:e.target.value}),disabled:b.isSystemRole&&!y,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"level",children:"Access Level (1-10)"}),e.jsx(j,{id:"level",type:"number",min:"1",max:"10",value:b.level,onChange:e=>S({...b,level:parseInt(e.target.value)||1}),disabled:b.isSystemRole&&!y})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"description",children:"Description"}),e.jsx(v,{id:"description",value:b.description,onChange:e=>S({...b,description:e.target.value}),rows:3})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(n,{type:"submit",disabled:w,children:w?"Saving...":"Save Changes"}),e.jsx(n,{type:"button",variant:"outline",onClick:()=>f("/admin/roles"),disabled:w,children:"Cancel"})]})]})]}):e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>f("/admin/roles"),children:e.jsx(c,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Role Not Found"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"The requested role could not be found."})]})]})})};export{g as default};
