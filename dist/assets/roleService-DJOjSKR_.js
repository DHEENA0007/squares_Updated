import{d as c,t as o}from"./index-CiYV0Sy0.js";class l{baseUrl="https://squares-9d84.onrender.com/api";async makeRequest(r,e={}){const t=`${this.baseUrl}${r}`,a={headers:{"Content-Type":"application/json",...e.headers},...e},n=c.getToken();n&&(a.headers={...a.headers,Authorization:`Bearer ${n}`});try{const s=await fetch(t,a);if(!s.ok){const i=await s.json().catch(()=>({success:!1,message:`HTTP ${s.status}: ${s.statusText}`}));throw new Error(i.message||"An error occurred")}return await s.json()}catch(s){throw console.error("API request failed:",s),s}}async getRoles(r={}){try{const e=new URLSearchParams;Object.entries(r).forEach(([n,s])=>{s!=null&&s!==""&&e.append(n,String(s))});const t=`/roles${e.toString()?`?${e.toString()}`:""}`;return await this.makeRequest(t)}catch(e){const t=e instanceof Error?e.message:"Failed to fetch roles";throw o({title:"Error",description:t,variant:"destructive"}),e}}async getRole(r){try{return await this.makeRequest(`/roles/${r}`)}catch(e){const t=e instanceof Error?e.message:"Failed to fetch role";throw o({title:"Error",description:t,variant:"destructive"}),e}}async createRole(r){try{const e=await this.makeRequest("/roles",{method:"POST",body:JSON.stringify(r)});return o({title:"Success",description:"Role created successfully!"}),e}catch(e){const t=e instanceof Error?e.message:"Failed to create role";throw o({title:"Error",description:t,variant:"destructive"}),e}}async updateRole(r,e){try{const t=await this.makeRequest(`/roles/${r}`,{method:"PUT",body:JSON.stringify(e)});return o({title:"Success",description:"Role updated successfully!"}),t}catch(t){const a=t instanceof Error?t.message:"Failed to update role";throw o({title:"Error",description:a,variant:"destructive"}),t}}async deleteRole(r){try{await this.makeRequest(`/roles/${r}`,{method:"DELETE"}),o({title:"Success",description:"Role deleted successfully!"})}catch(e){const t=e instanceof Error?e.message:"Failed to delete role";throw o({title:"Error",description:t,variant:"destructive"}),e}}async toggleRoleStatus(r){try{const e=await this.makeRequest(`/roles/${r}/toggle-status`,{method:"PATCH"});return o({title:"Success",description:"Role status updated successfully!"}),e}catch(e){const t=e instanceof Error?e.message:"Failed to update role status";throw o({title:"Error",description:t,variant:"destructive"}),e}}async getPermissions(){try{return(await this.makeRequest("/roles/permissions")).data.permissions}catch(r){return console.error("Failed to fetch permissions:",r),this.getAvailablePermissions()}}getAvailablePermissions(){return["create_property","read_property","update_property","delete_property","manage_users","manage_roles","manage_plans","view_dashboard","manage_settings","manage_content","send_messages","moderate_content","access_analytics"]}formatPermissions(r){return r.length<=3?r.map(e=>e.replace(/_/g," ")).join(", "):`${r.slice(0,2).map(e=>e.replace(/_/g," ")).join(", ")} and ${r.length-2} more`}getRoleLevelVariant(r){return r>=8?"destructive":r>=5?"default":"secondary"}getRoleLevelText(r){return r>=8?"High":r>=5?"Medium":"Low"}}const p=new l;export{p as r};
