import{d as c,t as s}from"./index-CiYV0Sy0.js";class u{baseUrl="https://squares-9d84.onrender.com/api";async makeRequest(t,e={}){const r=`${this.baseUrl}${t}`,o={headers:{"Content-Type":"application/json",...e.headers},...e},n=c.getToken();n&&(o.headers={...o.headers,Authorization:`Bearer ${n}`});try{const a=await fetch(r,o);if(!a.ok){const i=await a.json().catch(()=>({success:!1,message:`HTTP ${a.status}: ${a.statusText}`}));throw new Error(i.message||"An error occurred")}return await a.json()}catch(a){throw console.error("API request failed:",a),a}}async getUsers(t={}){try{const e=new URLSearchParams;Object.entries(t).forEach(([n,a])=>{a!=null&&a!==""&&e.append(n,String(a))});const r=`/users${e.toString()?`?${e.toString()}`:""}`;return await this.makeRequest(r)}catch(e){const r=e instanceof Error?e.message:"Failed to fetch users";throw s({title:"Error",description:r,variant:"destructive"}),e}}async getUser(t){try{return await this.makeRequest(`/users/${t}`)}catch(e){const r=e instanceof Error?e.message:"Failed to fetch user";throw s({title:"Error",description:r,variant:"destructive"}),e}}async createUser(t){try{const e=await this.makeRequest("/users",{method:"POST",body:JSON.stringify(t)});return s({title:"Success",description:"User created successfully!"}),e}catch(e){const r=e instanceof Error?e.message:"Failed to create user";throw s({title:"Error",description:r,variant:"destructive"}),e}}async updateUser(t,e){try{const r=await this.makeRequest(`/users/${t}`,{method:"PUT",body:JSON.stringify(e)});return s({title:"Success",description:"User updated successfully!"}),r}catch(r){const o=r instanceof Error?r.message:"Failed to update user";throw s({title:"Error",description:o,variant:"destructive"}),r}}async deleteUser(t){try{await this.makeRequest(`/users/${t}`,{method:"DELETE"}),s({title:"Success",description:"User deleted successfully!"})}catch(e){const r=e instanceof Error?e.message:"Failed to delete user";throw s({title:"Error",description:r,variant:"destructive"}),e}}async updateUserStatus(t,e){try{const r=await this.makeRequest(`/users/${t}/status`,{method:"PATCH",body:JSON.stringify({status:e})});return s({title:"Success",description:`User status updated to ${e}!`}),r}catch(r){const o=r instanceof Error?r.message:"Failed to update user status";throw s({title:"Error",description:o,variant:"destructive"}),r}}async getCurrentUser(){try{return await this.makeRequest("/auth/me")}catch(t){const e=t instanceof Error?t.message:"Failed to fetch current user";throw s({title:"Error",description:e,variant:"destructive"}),t}}async updateCurrentUser(t){try{const r=(await this.getCurrentUser()).data.user._id,o=await this.makeRequest(`/users/${r}`,{method:"PUT",body:JSON.stringify({profile:t.profile})});return s({title:"Success",description:"Profile updated successfully!"}),o}catch(e){const r=e instanceof Error?e.message:"Failed to update profile";throw s({title:"Error",description:r,variant:"destructive"}),e}}async updateUserPreferences(t){try{const r=(await this.getCurrentUser()).data.user._id;return await this.makeRequest(`/users/${r}`,{method:"PUT",body:JSON.stringify(t)})}catch(e){const r=e instanceof Error?e.message:"Failed to update preferences";throw s({title:"Error",description:r,variant:"destructive"}),e}}getFullName(t){return`${t.profile.firstName} ${t.profile.lastName}`.trim()}formatCreationDate(t){return new Date(t).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"})}}const h=new u;export{h as u};
