import{j as e}from"./ui-DYmpZ3pJ.js";import{d as k,r}from"./router-2SVJvIbS.js";import{f as A,A as w,a as F,b as L,c as B,d as T,e as M,B as d}from"./index-BbgqWuYN.js";import{u as D}from"./usePagination-DI7D6ysW.js";import{P as E,a as I,b as m,c as _,d as V,e as H}from"./pagination-B81IIWK4.js";import{p as x}from"./planService-nsbzt5Yw.js";import{D as O}from"./DataTable-Cs-k6Jh3.js";import{S as R}from"./SearchFilter-BrvzFCXm.js";import{L as Y}from"./loader-circle-DtIJ61xE.js";import"./vendor-Dazix4UH.js";import"./ellipsis-hsdzzVqq.js";import"./table-Cruer2y3.js";import"./square-pen-uFfo4AcD.js";const ae=()=>{const u=k(),[i,p]=r.useState(""),[n,f]=r.useState("all"),[h,g]=r.useState([]),[j,P]=r.useState(!0);r.useEffect(()=>{(async()=>{try{const a=await x.getPlans({limit:1e3});a.success&&g(a.data.plans)}catch(a){console.error("Failed to fetch plans:",a)}finally{P(!1)}})()},[]);const l=r.useMemo(()=>h.filter(s=>{const a=s.name.toLowerCase().includes(i.toLowerCase()),t=n==="all"||s.billingPeriod===n;return a&&t}),[h,i,n]),{paginatedItems:v,currentPage:c,totalPages:o,goToPage:y,nextPage:b,previousPage:N}=D(l,10),C=[{key:"name",label:"Plan Name",render:s=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.description.substring(0,50),"..."]})]})},{key:"price",label:"Price",render:s=>e.jsx("span",{className:"font-semibold",children:x.formatPrice(s)})},{key:"features",label:"Features",render:s=>{const a=Array.isArray(s.features)?s.features.map(t=>typeof t=="string"?t:t.name):[];return e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.slice(0,2).map((t,S)=>e.jsx(d,{variant:"secondary",className:"text-xs",children:t},S)),a.length>2&&e.jsxs(d,{variant:"secondary",className:"text-xs",children:["+",a.length-2]})]})}},{key:"subscriberCount",label:"Subscribers",render:s=>e.jsx("span",{className:"font-medium",children:s.subscriberCount||0})},{key:"isActive",label:"Status",render:s=>e.jsx(d,{variant:x.getPlanBadgeVariant(s),children:s.isActive?"Active":"Inactive"})}];return j?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(Y,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2 text-lg",children:"Loading plans..."})]}):e.jsxs("div",{className:"space-y-6 relative top-[60px]",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Plan Management"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage subscription plans and pricing"})]}),e.jsxs(A,{onClick:()=>u("/admin/plans/create"),children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Create Plan"]})]}),e.jsxs(F,{children:[e.jsxs(L,{children:[e.jsx(B,{children:"All Plans"}),e.jsxs(T,{children:[l.length," plan",l.length!==1?"s":""," found"]})]}),e.jsxs(M,{children:[e.jsx(R,{searchTerm:i,onSearchChange:p,filterValue:n,onFilterChange:f,filterOptions:[{label:"Monthly",value:"monthly"},{label:"Yearly",value:"yearly"}],filterPlaceholder:"Filter by billing"}),e.jsx(O,{columns:C,data:v.map(s=>({...s,id:s._id})),editPath:s=>`/admin/plans/edit/${s._id}`}),o>1&&e.jsx("div",{className:"mt-6",children:e.jsx(E,{children:e.jsxs(I,{children:[e.jsx(m,{children:e.jsx(_,{onClick:N,className:c===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:o},(s,a)=>a+1).map(s=>e.jsx(m,{children:e.jsx(V,{onClick:()=>y(s),isActive:c===s,className:"cursor-pointer",children:s})},s)),e.jsx(m,{children:e.jsx(H,{onClick:b,className:c===o?"pointer-events-none opacity-50":"cursor-pointer"})})]})})})]})]})]})};export{ae as default};
