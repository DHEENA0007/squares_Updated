import{j as e}from"./ui-BHyUY8Z8.js";import{d as D,r as C}from"./router-2SVJvIbS.js";import{f as g,a as h,b as x,c as u,d as w,e as v,L as o,I as M,q as E,B as S,H as F,t as l}from"./index-Bd1eLXM_.js";import{C as I}from"./checkbox-CFGICxZb.js";import{S as B}from"./switch-DhuCaVX7.js";import{A as _,a as P}from"./alert-DQvV8n_v.js";import{r as q}from"./roleService-aAI-qze7.js";import{A as H}from"./arrow-left-Dy16oLhe.js";import{I as A}from"./info-CXcNcErv.js";import{C as y}from"./circle-alert--1esrBFY.js";import{C as R}from"./circle-check-DJZyI1A1.js";import{S as O}from"./save-VRl1U5Be.js";import"./vendor-Dazix4UH.js";const j=[{id:"create_property",label:"Create Properties",description:"Can create new property listings",category:"Property Management"},{id:"read_property",label:"View Properties",description:"Can view property listings",category:"Property Management"},{id:"update_property",label:"Edit Properties",description:"Can edit existing properties",category:"Property Management"},{id:"delete_property",label:"Delete Properties",description:"Can delete property listings",category:"Property Management"},{id:"review_properties",label:"Review Properties",description:"Can review property submissions",category:"Property Management"},{id:"approve_properties",label:"Approve Properties",description:"Can approve property listings",category:"Property Management"},{id:"reject_properties",label:"Reject Properties",description:"Can reject property listings",category:"Property Management"},{id:"manage_users",label:"Manage Users",description:"Can manage user accounts",category:"User Management"},{id:"manage_roles",label:"Manage Roles",description:"Can create and manage user roles",category:"User Management"},{id:"approve_vendors",label:"Approve Vendors",description:"Can approve vendor applications",category:"Vendor Management"},{id:"reject_vendors",label:"Reject Vendors",description:"Can reject vendor applications",category:"Vendor Management"},{id:"review_vendors",label:"Review Vendors",description:"Can review vendor profiles",category:"Vendor Management"},{id:"track_vendor_performance",label:"Track Vendor Performance",description:"Can monitor vendor activities",category:"Vendor Management"},{id:"manage_plans",label:"Manage Plans",description:"Can manage subscription plans",category:"System Management"},{id:"view_dashboard",label:"View Dashboard",description:"Can access admin dashboard",category:"System Management"},{id:"manage_settings",label:"Manage Settings",description:"Can modify system settings",category:"System Management"},{id:"manage_content",label:"Manage Content",description:"Can manage site content",category:"System Management"},{id:"send_messages",label:"Send Messages",description:"Can send messages to users",category:"Communication"},{id:"moderate_content",label:"Moderate Content",description:"Can moderate user content",category:"Communication"},{id:"moderate_user_content",label:"Moderate User Content",description:"Can review and moderate user posts",category:"Communication"},{id:"send_notifications",label:"Send Notifications",description:"Can send system notifications",category:"Communication"},{id:"handle_support_tickets",label:"Handle Support Tickets",description:"Can manage customer support tickets",category:"Support & Operations"},{id:"approve_promotions",label:"Approve Promotions",description:"Can approve promotional campaigns",category:"Support & Operations"},{id:"generate_reports",label:"Generate Reports",description:"Can create system reports",category:"Support & Operations"},{id:"access_analytics",label:"Access Analytics",description:"Can view system analytics",category:"Analytics"}],te=()=>{const m=D(),[p,f]=C.useState(!1),[s,c]=C.useState({name:"",description:"",permissions:[],isActive:!0,level:1}),d=(t,r)=>{c(n=>({...n,[t]:r}))},N=t=>{c(r=>({...r,permissions:r.permissions.includes(t)?r.permissions.filter(n=>n!==t):[...r.permissions,t]}))},k=t=>{const r=j.filter(a=>a.category===t).map(a=>a.id),n=r.every(a=>s.permissions.includes(a));c(n?a=>({...a,permissions:a.permissions.filter(i=>!r.includes(i))}):a=>({...a,permissions:[...new Set([...a.permissions,...r])]}))},V=async t=>{if(t.preventDefault(),!s.name.trim()){l({title:"Validation Error",description:"Role name is required",variant:"destructive"});return}if(s.name.length<3){l({title:"Validation Error",description:"Role name must be at least 3 characters long",variant:"destructive"});return}if(!s.description.trim()){l({title:"Validation Error",description:"Role description is required",variant:"destructive"});return}if(s.description.length<10){l({title:"Validation Error",description:"Role description must be at least 10 characters long",variant:"destructive"});return}if(s.permissions.length===0){l({title:"Validation Error",description:"At least one permission must be selected",variant:"destructive"});return}try{f(!0),await q.createRole(s),l({title:"Success",description:"Role created successfully!"}),m("/admin/roles")}catch(r){console.error("Failed to create role:",r)}finally{f(!1)}},L=[...new Set(j.map(r=>r.category))].reduce((r,n)=>(r[n]=j.filter(a=>a.category===n),r),{});return e.jsxs("div",{className:"space-y-6 relative top-[60px] pb-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(g,{variant:"ghost",size:"icon",onClick:()=>m("/admin/roles"),className:"flex items-center gap-2",children:e.jsx(H,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Add New Role"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Create a new user role with specific permissions and access levels"})]})]}),e.jsxs(_,{children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx(P,{children:"Roles define what users can do in the system. Higher level roles (closer to 10) have more authority. Make sure to select only the necessary permissions for this role."})]}),e.jsxs("form",{onSubmit:V,className:"space-y-6",children:[e.jsxs(h,{children:[e.jsxs(x,{children:[e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx("span",{className:"text-lg",children:"1"})}),"Basic Information"]}),e.jsx(w,{children:"Provide essential details about the role"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"name",className:"flex items-center gap-1",children:["Role Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(M,{id:"name",placeholder:"e.g., Property Manager, Content Moderator",value:s.name,onChange:t=>d("name",t.target.value),required:!0,className:s.name&&s.name.length<3?"border-destructive":""}),s.name&&s.name.length<3&&e.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[e.jsx(y,{className:"h-3 w-3"}),"Must be at least 3 characters"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"level",className:"flex items-center gap-1",children:["Authorization Level ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(M,{id:"level",type:"number",min:1,max:10,value:s.level,onChange:t=>d("level",parseInt(t.target.value)||1),required:!0}),e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(A,{className:"h-3 w-3"}),"Level ",s.level,"/10 - ",s.level>=8?"High Authority":s.level>=5?"Medium Authority":"Low Authority"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"description",className:"flex items-center gap-1",children:["Description ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(E,{id:"description",placeholder:"Describe the responsibilities and purpose of this role...",value:s.description,onChange:t=>d("description",t.target.value),required:!0,rows:4,className:s.description&&s.description.length<10?"border-destructive":""}),e.jsxs("div",{className:"flex justify-between items-center",children:[s.description&&s.description.length<10?e.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[e.jsx(y,{className:"h-3 w-3"}),"Must be at least 10 characters"]}):e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.description.length," characters"]}),s.description.length>=10&&e.jsx(R,{className:"h-4 w-4 text-green-600"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(o,{htmlFor:"isActive",className:"text-base font-medium cursor-pointer",children:"Active Role"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Users can be assigned to this role immediately after creation"})]}),e.jsx(B,{id:"isActive",checked:s.isActive,onCheckedChange:t=>d("isActive",t)})]})]})]}),e.jsxs(h,{children:[e.jsxs(x,{children:[e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx("span",{className:"text-lg",children:"2"})}),"Permissions"]}),e.jsx(w,{children:"Select what actions users with this role can perform. Click on category badges to select/deselect all permissions in that category."})]}),e.jsxs(v,{className:"space-y-6",children:[Object.entries(L).map(([t,r])=>{const n=r.filter(i=>s.permissions.includes(i.id)).length,a=n===r.length;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{variant:a?"default":"outline",className:"cursor-pointer hover:bg-primary/80 transition-colors text-sm px-3 py-1",onClick:()=>k(t),children:t}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[n," of ",r.length," selected"]})]}),a&&e.jsx(R,{className:"h-5 w-5 text-green-600"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:r.map(i=>{const b=s.permissions.includes(i.id);return e.jsxs("div",{className:`flex items-start space-x-3 p-3 border-2 rounded-lg transition-all cursor-pointer ${b?"border-primary bg-primary/5":"border-border hover:border-primary/50 hover:bg-muted/50"}`,children:[e.jsx(I,{id:i.id,checked:b,onCheckedChange:()=>N(i.id),className:"mt-1"}),e.jsxs("div",{className:"flex-1",onClick:()=>N(i.id),children:[e.jsx(o,{htmlFor:i.id,className:"cursor-pointer font-medium text-sm",children:i.label}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:i.description})]})]},i.id)})})]},t)}),s.permissions.length===0&&e.jsxs(_,{variant:"destructive",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx(P,{children:"Please select at least one permission for this role"})]})]})]}),e.jsxs(h,{children:[e.jsx(x,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx("span",{className:"text-lg",children:"3"})}),"Review & Submit"]})}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-muted/30 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Role Name"}),e.jsx("p",{className:"font-medium",children:s.name||"Not set"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Level"}),e.jsxs(S,{variant:s.level>=8?"destructive":s.level>=5?"default":"secondary",children:["Level ",s.level]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Permissions"}),e.jsxs("p",{className:"font-medium",children:[s.permissions.length," selected"]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4",children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>m("/admin/roles"),disabled:p,size:"lg",children:"Cancel"}),e.jsx(g,{type:"submit",disabled:p||!s.name||!s.description||s.permissions.length===0,className:"flex items-center gap-2",size:"lg",children:p?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"h-4 w-4 animate-spin"}),"Creating Role..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"h-4 w-4"}),"Create Role"]})})]})]})]})]})]})};export{te as default};
