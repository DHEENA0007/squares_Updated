import{j as e,a6 as $,a7 as U}from"./ui-DOY6021Z.js";import{r as c}from"./router-2SVJvIbS.js";import{g as z,a as n,e as i,q as N,r as v,s as w,v as y,w as t,f as x,U as b,ax as S,ai as R,E as M,B as T,y as I,$ as D}from"./index-SPvHGBGF.js";import{T as m}from"./trending-up-ohBLGDCN.js";import{T as o}from"./trending-down-B09w3R_6.js";import"./vendor-Dazix4UH.js";const P=c.forwardRef(({className:l,value:h,...j},d)=>e.jsx($,{ref:d,className:z("relative h-4 w-full overflow-hidden rounded-full bg-secondary",l),...j,children:e.jsx(U,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(h||0)}%)`}})}));P.displayName=$.displayName;const H=()=>{const[l,h]=c.useState([]),[j,d]=c.useState(!0),[g,V]=c.useState("totalProperties"),[u,L]=c.useState("all"),[f,B]=c.useState("30d"),C=async()=>{d(!0);try{const s=new URLSearchParams({sortBy:g,status:u,timeRange:f}),a=await fetch(`/api/admin/vendors/performance?${s}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(a.ok){const p=await a.json();h(p.vendors)}}catch(s){console.error("Failed to fetch vendor performance:",s)}finally{d(!1)}};c.useEffect(()=>{C()},[g,u,f]);const A=s=>{const{metrics:a}=s,p=Math.min(a.averageRating/5,1)*25+Math.min(a.responseRate/100,1)*25+Math.min(a.conversionRate/10,1)*25+Math.max(0,Math.min((100-a.responseTime)/100,1))*25;return Math.round(p)},F=s=>s>=80?"text-green-600":s>=60?"text-yellow-600":"text-red-600",k=s=>s>=80?"bg-green-100 text-green-800":s>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",r=s=>s>=0?"text-green-600":"text-red-600",E=s=>s<1?`${Math.round(s*60)} min`:s<24?`${Math.round(s)} hr`:`${Math.round(s/24)} day`;return j?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Performance Tracking"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Monitor vendor and builder performance metrics"})]})}),e.jsx(n,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"w-full sm:w-48",children:e.jsxs(N,{value:g,onValueChange:V,children:[e.jsx(v,{children:e.jsx(w,{})}),e.jsxs(y,{children:[e.jsx(t,{value:"totalProperties",children:"Total Properties"}),e.jsx(t,{value:"viewsThisMonth",children:"Monthly Views"}),e.jsx(t,{value:"leadsThisMonth",children:"Monthly Leads"}),e.jsx(t,{value:"averageRating",children:"Rating"}),e.jsx(t,{value:"responseRate",children:"Response Rate"}),e.jsx(t,{value:"performanceScore",children:"Performance Score"})]})]})}),e.jsx("div",{className:"w-full sm:w-48",children:e.jsxs(N,{value:u,onValueChange:L,children:[e.jsx(v,{children:e.jsx(w,{})}),e.jsxs(y,{children:[e.jsx(t,{value:"all",children:"All Status"}),e.jsx(t,{value:"active",children:"Active"}),e.jsx(t,{value:"inactive",children:"Inactive"}),e.jsx(t,{value:"suspended",children:"Suspended"})]})]})}),e.jsx("div",{className:"w-full sm:w-48",children:e.jsxs(N,{value:f,onValueChange:B,children:[e.jsx(v,{children:e.jsx(w,{})}),e.jsxs(y,{children:[e.jsx(t,{value:"7d",children:"Last 7 days"}),e.jsx(t,{value:"30d",children:"Last 30 days"}),e.jsx(t,{value:"90d",children:"Last 90 days"}),e.jsx(t,{value:"1y",children:"Last year"})]})]})}),e.jsx(x,{onClick:C,variant:"outline",children:"Refresh Data"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(n,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:l.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Vendors"})]})]})})}),e.jsx(n,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:l.reduce((s,a)=>s+a.metrics.totalProperties,0)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Properties"})]})]})})}),e.jsx(n,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-8 h-8 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:l.length>0?(l.reduce((s,a)=>s+a.metrics.averageRating,0)/l.length).toFixed(1):"0.0"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Rating"})]})]})})}),e.jsx(n,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:l.reduce((s,a)=>s+a.metrics.viewsThisMonth,0).toLocaleString()}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Monthly Views"})]})]})})})]}),e.jsx("div",{className:"space-y-4",children:l.map(s=>{const a=A(s);return e.jsx(n,{className:"hover:shadow-md transition-shadow",children:e.jsx(i,{className:"pt-6",children:e.jsx("div",{className:"flex flex-col lg:flex-row gap-6",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:s.vendor.name}),e.jsx("p",{className:"text-muted-foreground",children:s.vendor.company}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.vendor.email})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(T,{className:k(a),children:["Score: ",a,"/100"]}),e.jsx(T,{variant:"outline",children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Overall Performance"}),e.jsxs("span",{className:F(a),children:[a,"%"]})]}),e.jsx(P,{value:a,className:"h-2"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(S,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-lg font-bold",children:s.metrics.totalProperties})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Properties"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(M,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-lg font-bold",children:s.metrics.viewsThisMonth.toLocaleString()})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Monthly Views"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(I,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-lg font-bold",children:s.metrics.leadsThisMonth})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Monthly Leads"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(R,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-lg font-bold",children:s.metrics.averageRating.toFixed(1)})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Avg Rating"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Response Rate:"}),e.jsxs("span",{className:"font-medium",children:[s.metrics.responseRate,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Response Time:"}),e.jsx("span",{className:"font-medium",children:E(s.metrics.responseTime)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Conversion Rate:"}),e.jsxs("span",{className:"font-medium",children:[s.metrics.conversionRate,"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.trends.propertiesChange>=0?e.jsx(m,{className:`w-4 h-4 ${r(s.trends.propertiesChange)}`}):e.jsx(o,{className:`w-4 h-4 ${r(s.trends.propertiesChange)}`}),e.jsxs("span",{className:`text-sm ${r(s.trends.propertiesChange)}`,children:[s.trends.propertiesChange>=0?"+":"",s.trends.propertiesChange," properties"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.trends.viewsChange>=0?e.jsx(m,{className:`w-4 h-4 ${r(s.trends.viewsChange)}`}):e.jsx(o,{className:`w-4 h-4 ${r(s.trends.viewsChange)}`}),e.jsxs("span",{className:`text-sm ${r(s.trends.viewsChange)}`,children:[s.trends.viewsChange>=0?"+":"",s.trends.viewsChange,"% views"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.trends.leadsChange>=0?e.jsx(m,{className:`w-4 h-4 ${r(s.trends.leadsChange)}`}):e.jsx(o,{className:`w-4 h-4 ${r(s.trends.leadsChange)}`}),e.jsxs("span",{className:`text-sm ${r(s.trends.leadsChange)}`,children:[s.trends.leadsChange>=0?"+":"",s.trends.leadsChange,"% leads"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.trends.ratingChange>=0?e.jsx(m,{className:`w-4 h-4 ${r(s.trends.ratingChange)}`}):e.jsx(o,{className:`w-4 h-4 ${r(s.trends.ratingChange)}`}),e.jsxs("span",{className:`text-sm ${r(s.trends.ratingChange)}`,children:[s.trends.ratingChange>=0?"+":"",s.trends.ratingChange.toFixed(1)," rating"]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(x,{variant:"outline",size:"sm",children:"View Details"}),e.jsxs(x,{variant:"outline",size:"sm",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Contact Vendor"]}),s.status==="active"&&a<50&&e.jsx(x,{variant:"outline",size:"sm",className:"text-orange-600",children:"Send Warning"})]})]})})})},s._id)})}),l.length===0&&e.jsx(n,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(b,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Vendors Found"}),e.jsx("p",{className:"text-muted-foreground",children:"No vendors match your current filters."})]})})})]})};export{H as default};
