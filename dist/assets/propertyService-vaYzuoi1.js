import{t as o}from"./index-CiYV0Sy0.js";const c="https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=400&h=300&fit=crop&auto=format",p="https://squares-9d84.onrender.com/api";class d{async makeRequest(e,r={}){const t=`${p}${e}`,a={headers:{"Content-Type":"application/json",...r.headers},...r},i=localStorage.getItem("token");i&&(a.headers={...a.headers,Authorization:`Bearer ${i}`});try{const s=await fetch(t,a);if(!s.ok){const n=await s.json().catch(()=>({success:!1,message:`HTTP ${s.status}: ${s.statusText}`}));throw n.errors&&Array.isArray(n.errors)?new Error(`Validation failed: ${n.errors.join(", ")}`):new Error(n.message||"An error occurred")}return await s.json()}catch(s){throw console.error("API request failed:",s),s}}async getProperties(e={}){try{const r=new URLSearchParams;Object.entries(e).forEach(([i,s])=>{s!=null&&s!==""&&r.append(i,s.toString())});const t=`/properties${r.toString()?`?${r.toString()}`:""}`;return await this.makeRequest(t)}catch(r){const t=r instanceof Error?r.message:"Failed to fetch properties";throw o({title:"Error",description:t,variant:"destructive"}),r}}async getProperty(e){try{return await this.makeRequest(`/properties/${e}`)}catch(r){const t=r instanceof Error?r.message:"Failed to fetch property";throw o({title:"Error",description:t,variant:"destructive"}),r}}async getAdminProperty(e){try{return await this.makeRequest(`/admin/properties/${e}`)}catch(r){const t=r instanceof Error?r.message:"Failed to fetch property";throw o({title:"Error",description:t,variant:"destructive"}),r}}async createProperty(e){try{const r=await this.makeRequest("/properties",{method:"POST",body:JSON.stringify(e)});return o({title:"Success",description:"Property created successfully!"}),r}catch(r){const t=r instanceof Error?r.message:"Failed to create property";throw o({title:"Error",description:t,variant:"destructive"}),r}}async createAdminProperty(e){try{const r=await this.makeRequest("/admin/properties",{method:"POST",body:JSON.stringify(e)});return o({title:"Success",description:"Property created successfully!"}),r}catch(r){const t=r instanceof Error?r.message:"Failed to create property";throw o({title:"Error",description:t,variant:"destructive"}),r}}async updateProperty(e,r){try{const t=await this.makeRequest(`/properties/${e}`,{method:"PUT",body:JSON.stringify(r)});return o({title:"Success",description:"Property updated successfully!"}),t}catch(t){const a=t instanceof Error?t.message:"Failed to update property";throw o({title:"Error",description:a,variant:"destructive"}),t}}async deleteProperty(e){try{await this.makeRequest(`/properties/${e}`,{method:"DELETE"}),o({title:"Success",description:"Property deleted successfully!"})}catch(r){const t=r instanceof Error?r.message:"Failed to delete property";throw o({title:"Error",description:t,variant:"destructive"}),r}}formatPrice(e,r){return r==="rent"?`₹${e.toLocaleString("en-IN")}/month`:r==="lease"?`₹${e.toLocaleString("en-IN")}/year`:e>=1e7?`₹${(e/1e7).toFixed(1)} Cr`:e>=1e5?`₹${(e/1e5).toFixed(1)} Lac`:`₹${e.toLocaleString("en-IN")}`}getPrimaryImage(e){return e.images.find(t=>t.isPrimary)?.url||e.images[0]?.url||c}formatArea(e){return e.builtUp?`${e.builtUp} ${e.unit}`:e.plot?`${e.plot} ${e.unit}`:e.carpet?`${e.carpet} ${e.unit}`:"Area not specified"}async getVendorProperties(e={}){try{const r=new URLSearchParams;Object.entries(e).forEach(([i,s])=>{s!=null&&s!==""&&r.append(i,s.toString())});const t=`/vendors/properties${r.toString()?`?${r.toString()}`:""}`;return await this.makeRequest(t)}catch(r){const t=r instanceof Error?r.message:"Failed to fetch vendor properties";throw o({title:"Error",description:t,variant:"destructive"}),r}}async getVendorPropertyStats(){try{const e=await this.makeRequest("/vendors/statistics");return e.success&&e.data?{totalProperties:e.data.totalProperties||0,totalViews:e.data.totalViews||0,totalLeads:e.data.totalLeads||0,averageRating:e.data.rating||0,activeProperties:e.data.activeProperties||0,soldProperties:e.data.soldProperties||0,pendingProperties:e.data.pendingProperties||0}:{totalProperties:0,totalViews:0,totalLeads:0,averageRating:0,activeProperties:0,soldProperties:0,pendingProperties:0}}catch(e){return console.error("Failed to fetch vendor property stats:",e),{totalProperties:0,totalViews:0,totalLeads:0,averageRating:0,activeProperties:0,soldProperties:0,pendingProperties:0}}}async togglePropertyStatus(e,r){try{const t=await this.makeRequest(`/properties/${e}/status`,{method:"PATCH",body:JSON.stringify({status:r})});return o({title:"Success",description:"Property status updated successfully!"}),t}catch(t){const a=t instanceof Error?t.message:"Failed to update property status";throw o({title:"Error",description:a,variant:"destructive"}),t}}async togglePropertyFeatured(e,r){try{if((await this.makeRequest(`/properties/${e}/featured`,{method:"PATCH",body:JSON.stringify({featured:r})})).success)o({title:"Success",description:`Property ${r?"featured":"unfeatured"} successfully!`});else throw new Error("Failed to update property featured status")}catch(t){const a=t instanceof Error?t.message:"Failed to update property featured status";throw o({title:"Error",description:a,variant:"destructive"}),t}}getStatusColor(e){switch(e.toLowerCase()){case"available":return"bg-green-500";case"pending":return"bg-yellow-500";case"sold":return"bg-blue-500";case"rented":return"bg-purple-500";case"inactive":return"bg-gray-500";default:return"bg-gray-500"}}getStatusText(e){return e.charAt(0).toUpperCase()+e.slice(1)}}const y=new d;export{c as D,y as p};
