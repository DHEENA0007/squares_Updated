import{j as e}from"./ui-DYmpZ3pJ.js";import{r as a}from"./router-2SVJvIbS.js";import{x as k,g as m,P as L,i as z,f as D,k as I,l as $,Z as p}from"./index-BbgqWuYN.js";import{C as O,a as Q,c as R,d as U,e as V}from"./command-DqNKR-gI.js";import{L as A}from"./loader-circle-DtIJ61xE.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=k("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);function H({value:n,onChange:S,state:o,district:r,city:c,placeholder:C="Select pincode...",disabled:g=!1,className:v,error:i}){const[x,u]=a.useState(!1),[f,h]=a.useState([]),[w,j]=a.useState(!1),[l,N]=a.useState(""),[d,y]=a.useState(!1);a.useEffect(()=>{(async()=>{if(p.isReady())y(!0);else{j(!0);try{await p.initialize(),y(!0)}catch(t){console.error("Failed to initialize loca service:",t)}finally{j(!1)}}})()},[]),a.useEffect(()=>{if(!d)return;(()=>{try{const t=p.getPincodeSuggestions(o,r,c,l);h(t)}catch(t){console.error("Error loading pincode suggestions:",t),h([])}})()},[o,r,c,l,d]);const P=s=>{S(s.pincode,s),u(!1),N("")},b=()=>{if(!n)return C;const s=f.find(t=>t.pincode===n);return s?`${s.pincode} - ${s.city}`:n},E=g||!d||!o&&!r&&!c;return e.jsxs("div",{className:m("relative",v),children:[e.jsxs(L,{open:x,onOpenChange:u,children:[e.jsx(z,{asChild:!0,children:e.jsxs(D,{variant:"outline",role:"combobox","aria-expanded":x,className:m("w-full justify-between",!n&&"text-muted-foreground",i&&"border-red-500"),disabled:E,children:[e.jsx("span",{className:"truncate",children:w?e.jsxs("span",{className:"flex items-center",children:[e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),"Loading..."]}):b()}),e.jsx(B,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(I,{className:"w-full p-0",align:"start",children:e.jsxs(O,{children:[e.jsx(Q,{placeholder:"Search pincode...",value:l,onValueChange:N}),e.jsx(R,{children:!o&&!r&&!c?e.jsx("div",{className:"p-4 text-sm text-muted-foreground text-center",children:"Please select state, district, or city first"}):e.jsx("div",{className:"p-4 text-sm text-muted-foreground text-center",children:"No pincodes found"})}),e.jsx(U,{className:"max-h-64 overflow-auto",children:f.map(s=>e.jsxs(V,{value:s.pincode,onSelect:()=>P(s),children:[e.jsx($,{className:m("mr-2 h-4 w-4",n===s.pincode?"opacity-100":"opacity-0")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.pincode}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[s.city,", ",s.district,", ",s.state]})]})]},`${s.pincode}-${s.city}`))})]})})]}),i&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:i}),!o&&!r&&!c&&!i&&e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Select state, district, or city to see available pincodes"})]})}export{H as P};
