import{j as e}from"./ui-BHyUY8Z8.js";import{r,d as z}from"./router-2SVJvIbS.js";import{H as T,B as n,f as v,E as H,J as L,K as _,O as B,Q as R,R as M,a as m,b as x,c as h,z as O,e as j,S as Q,h as J,V as K,I as q}from"./index-Bd1eLXM_.js";import{T as G,a as W,b as y,c as o,d as X,e as c}from"./table-DaOINtos.js";import{P as Y,a as Z,b as N,c as $,d as ee,e as se}from"./pagination-Rt-SIkt9.js";import{u as d}from"./userService-CKE-Zb2D.js";import{A as ae,a as te,b as ie,c as le,d as re,e as ne,f as de,g as ce,h as oe}from"./alert-dialog-MvJryQ6D.js";import{T as me}from"./trash-2-DTVLnEp9.js";import{A as xe}from"./activity-CJP-ixEL.js";import{C as he}from"./calendar-5Rt0tQ5m.js";import"./vendor-Dazix4UH.js";import"./ellipsis-CXpaKV_5.js";const je=({searchQuery:f})=>{const[i,u]=r.useState(1),[g,C]=r.useState([]),[V,D]=r.useState(!0),[p,w]=r.useState(0),[fe,A]=r.useState(0),[U,P]=r.useState(null),[s,E]=r.useState(null),[k,b]=r.useState(!1),S=10;r.useEffect(()=>{(async()=>{D(!0);try{const t=await d.getUsers({page:i,limit:S,search:f||void 0});t.success&&(C(t.data.users),w(t.data.pagination.totalPages),A(t.data.pagination.totalUsers))}catch(t){console.error("Failed to fetch users:",t)}finally{D(!1)}})()},[i,f]);const F=async a=>{P(a);try{await d.deleteUser(a);const t=await d.getUsers({page:i,limit:S,search:f||void 0});t.success&&(C(t.data.users),w(t.data.pagination.totalPages),A(t.data.pagination.totalUsers))}catch(t){console.error("Failed to delete user:",t)}finally{P(null)}},I=a=>{E(a),b(!0)};return V?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(T,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2 text-lg",children:"Loading users..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md border overflow-x-auto",children:e.jsxs(G,{children:[e.jsx(W,{children:e.jsxs(y,{children:[e.jsx(o,{children:"Name"}),e.jsx(o,{children:"Email"}),e.jsx(o,{className:"hidden md:table-cell",children:"Phone"}),e.jsx(o,{className:"hidden sm:table-cell",children:"Role"}),e.jsx(o,{className:"hidden lg:table-cell",children:"Status"}),e.jsx(o,{className:"hidden lg:table-cell",children:"Created"}),e.jsx(o,{className:"text-right",children:"Actions"})]})}),e.jsx(X,{children:g.length===0?e.jsx(y,{children:e.jsx(c,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No users found."})}):g.map(a=>e.jsxs(y,{children:[e.jsx(c,{className:"font-medium",children:d.getFullName(a)}),e.jsx(c,{children:a.email}),e.jsx(c,{className:"hidden md:table-cell",children:a.profile.phone||"-"}),e.jsx(c,{className:"hidden sm:table-cell",children:e.jsx(n,{variant:a.role==="admin"?"default":"secondary",children:a.role})}),e.jsx(c,{className:"hidden lg:table-cell",children:e.jsx(n,{variant:a.status==="active"?"default":a.status==="pending"?"secondary":"destructive",children:a.status})}),e.jsx(c,{className:"hidden lg:table-cell",children:d.formatCreationDate(a.createdAt)}),e.jsx(c,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>I(a),title:"View User Details",children:e.jsx(H,{className:"h-4 w-4"})}),e.jsxs(ae,{children:[e.jsx(te,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"icon",children:e.jsx(me,{className:"h-4 w-4"})})}),e.jsxs(ie,{children:[e.jsxs(le,{children:[e.jsx(re,{children:"Are you absolutely sure?"}),e.jsx(ne,{children:"This action cannot be undone. This will permanently delete the user account and remove their data from our servers."})]}),e.jsxs(de,{children:[e.jsx(ce,{children:"Cancel"}),e.jsxs(oe,{onClick:()=>F(a._id),disabled:U===a._id,children:[U===a._id?e.jsx(T,{className:"h-4 w-4 animate-spin mr-2"}):null,"Delete"]})]})]})]})]})})]},a._id))})]})}),p>1&&e.jsx(Y,{className:"mt-4",children:e.jsxs(Z,{children:[e.jsx(N,{children:e.jsx($,{onClick:()=>u(a=>Math.max(1,a-1)),className:i===1?"pointer-events-none opacity-50":"cursor-pointer"})}),[...Array(p)].map((a,t)=>{const l=t+1;return l===1||l===p||l>=i-1&&l<=i+1?e.jsx(N,{children:e.jsx(ee,{onClick:()=>u(l),isActive:i===l,className:"cursor-pointer",children:l})},l):l===i-2||l===i+2?e.jsx(N,{children:"..."},l):null}),e.jsx(N,{children:e.jsx(se,{onClick:()=>u(a=>Math.min(p,a+1)),className:i===p?"pointer-events-none opacity-50":"cursor-pointer"})})]})}),e.jsx(L,{open:k,onOpenChange:b,children:e.jsxs(_,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(B,{children:[e.jsx(R,{children:"User Details"}),e.jsxs(M,{children:["Complete information about ",s?d.getFullName(s):"user"]})]}),s&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-5 h-5"}),"Basic Information"]})}),e.jsx(j,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Full Name"}),e.jsx("p",{className:"text-base",children:d.getFullName(s)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),e.jsx("p",{className:"text-base",children:s.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Phone"}),e.jsx("p",{className:"text-base",children:s.profile?.phone||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"User ID"}),e.jsx("p",{className:"text-base font-mono text-sm",children:s._id})]})]})})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5"}),"Account Status"]})}),e.jsx(j,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Role"}),e.jsx(n,{variant:s.role==="admin"?"default":"secondary",className:"mt-1",children:s.role})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsx(n,{variant:s.status==="active"?"default":s.status==="pending"?"secondary":"destructive",className:"mt-1",children:s.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Email Verified"}),e.jsx(n,{variant:s.profile?.emailVerified?"default":"destructive",className:"mt-1",children:s.profile?.emailVerified?"Verified":"Not Verified"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Phone Verified"}),e.jsx(n,{variant:s.profile?.phoneVerified?"default":"destructive",className:"mt-1",children:s.profile?.phoneVerified?"Verified":"Not Verified"})]})]})})]}),s.profile?.address&&e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5"}),"Address Information"]})}),e.jsx(j,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.profile?.address?.street&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Street"}),e.jsx("p",{className:"text-base",children:s.profile.address.street})]}),s.profile?.address?.city&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"City"}),e.jsx("p",{className:"text-base",children:s.profile.address.city})]}),s.profile?.address?.state&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"State"}),e.jsx("p",{className:"text-base",children:s.profile.address.state})]}),s.profile?.address?.zipCode&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Pincode"}),e.jsx("p",{className:"text-base",children:s.profile.address.zipCode})]})]})})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5"}),"User Preferences"]})}),e.jsxs(j,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Language"}),e.jsx("p",{className:"text-base",children:"Not available"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Currency"}),e.jsx("p",{className:"text-base",children:"Not available"})]})]}),s.profile?.preferences?.notifications&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Notification Preferences"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(n,{variant:s.profile.preferences.notifications.email?"default":"secondary",children:["Email: ",s.profile.preferences.notifications.email?"Enabled":"Disabled"]}),e.jsxs(n,{variant:s.profile.preferences.notifications.sms?"default":"secondary",children:["SMS: ",s.profile.preferences.notifications.sms?"Enabled":"Disabled"]}),e.jsxs(n,{variant:s.profile.preferences.notifications.push?"default":"secondary",children:["Push: ",s.profile.preferences.notifications.push?"Enabled":"Disabled"]})]})]})]})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5"}),"Account Timeline"]})}),e.jsx(j,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Created At"}),e.jsx("p",{className:"text-base",children:d.formatCreationDate(s.createdAt)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Last Updated"}),e.jsx("p",{className:"text-base",children:d.formatCreationDate(s.updatedAt)})]})]})})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsx(h,{children:"Quick Actions"})}),e.jsx(j,{children:e.jsx("div",{className:"flex gap-2 flex-wrap",children:e.jsx(v,{variant:"outline",size:"sm",onClick:()=>b(!1),children:"Close"})})})]})]})]})})]})},Pe=()=>{const f=z(),[i,u]=r.useState("");return e.jsxs("div",{className:"space-y-6 relative top-[60px]",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Users"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"View and manage system users"})]}),e.jsxs(v,{onClick:()=>f("/admin/users/add"),children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Add User"]})]}),e.jsxs("div",{className:"bg-card rounded-lg border p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx(q,{placeholder:"Search users...",value:i,onChange:g=>u(g.target.value),className:"max-w-md"})}),e.jsx(je,{searchQuery:i})]})]})};export{Pe as default};
