const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/paymentService-BFb4MCDt.js","assets/index-CiYV0Sy0.js","assets/ui-CEt46o3G.js","assets/router-2SVJvIbS.js","assets/vendor-Dazix4UH.js","assets/index-lz54DzMq.css","assets/vendorService-bcricvQk.js"])))=>i.map(i=>d[i]);
import{f as K,a as u,B as m,Y as x,z as Q,U as X,S as ee,_ as T}from"./index-CiYV0Sy0.js";import{j as e}from"./ui-CEt46o3G.js";import{r as o,d as se}from"./router-2SVJvIbS.js";import{C as h,a as p,b as N,d as g}from"./card-YvDMUmzt.js";import{a as te}from"./addonService-B7poRUX4.js";import{A as re}from"./arrow-left-ClppC_3T.js";import{A as ae,Z as k}from"./zap-CFGjvias.js";import{C as R}from"./circle-check-big-CdpP5k9T.js";import{S as y}from"./shield-CFIF9xqz.js";import{H as ie}from"./headphones-M8LB5oa-.js";import{S as ne}from"./share-2-BXLCoDth.js";import{V as le}from"./video-B8IjENdZ.js";import{C as oe}from"./camera-2k-Wb9vt.js";import"./vendor-Dazix4UH.js";const Se=()=>{const[l,v]=o.useState(1),[n,$]=o.useState(null),[c,B]=o.useState([]),[w,I]=o.useState([]),[i,V]=o.useState(null),[ce,P]=o.useState(!0),[de]=o.useState("monthly"),[S,C]=o.useState(!1),[A,_]=o.useState(!0),{toast:d}=K(),f=se(),L=[{id:"free",name:"FREE LISTING",price:0,description:"5 Properties/Products - Basic listing",icon:e.jsx(x,{className:"w-8 h-8 text-gray-600"}),features:["5 Property listings","Basic property details","Standard visibility","Email support"]},{id:"basic",name:"BASIC PLAN",price:199,description:"10 Properties + Top Rated + Verified Owner Badge",icon:e.jsx(Q,{className:"w-8 h-8 text-green-600"}),recommended:!0,features:["10 Property listings","Top Rated in Website","Verified Owner Badge","Priority email support","Enhanced visibility"]},{id:"standard",name:"STANDARD PLAN",price:499,description:"15 Properties + Benefits + 1 Poster with 6 leads",icon:e.jsx(k,{className:"w-8 h-8 text-blue-600"}),features:["15 Property listings","Top Rated in Website","Verified Owner Badge","1 Poster with 6 leads","Priority support","Enhanced marketing"]},{id:"premium",name:"PREMIUM PLAN",price:1999,description:"Unlimited Properties + 4 Posters with 20 leads",icon:e.jsx(y,{className:"w-8 h-8 text-purple-600"}),features:["Unlimited Property listings","Top Rated in Website","Verified Owner Badge","4 Posters with 20 leads","Priority phone & email support","Advanced analytics","Featured listings"]},{id:"enterprise",name:"ENTERPRISE PLAN",price:4999,description:"Unlimited + Videos + 30+ leads + Marketing Manager",icon:e.jsx(y,{className:"w-8 h-8 text-gold-600"}),features:["Unlimited Property listings","Top Rated in Website","Verified Owner Badge","4 Posters & 1 Video with 30+ leads","Consultation with Marketing Manager","Commission based revenue","24/7 dedicated support","Custom branding & API access"]}];o.useEffect(()=>{U(),M()},[]);const M=async()=>{try{P(!0);const s=await fetch("https://squares-9d84.onrender.com/api/vendors/subscription-status",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(s.ok){const t=await s.json();t.success&&t.data.hasActiveSubscription&&V(t.data.subscription)}}catch(s){console.error("Failed to load current subscription:",s)}finally{P(!1)}},E=(s,t)=>{const r={className:"w-6 h-6"};switch(s){case"photography":return t==="video"?e.jsx(le,{...r}):e.jsx(oe,{...r});case"marketing":return t==="search"?e.jsx(ee,{...r}):e.jsx(ne,{...r});case"technology":return e.jsx(k,{...r});case"support":return e.jsx(ie,{...r});case"crm":return e.jsx(X,{...r});default:return e.jsx(x,{...r})}},U=async()=>{try{_(!0);const s=await te.getAddons();I(s.filter(t=>t.isActive))}catch(s){console.error("Failed to load addons:",s),d({title:"Failed to load addons",description:"Using default addon services",variant:"destructive"})}finally{_(!1)}},Y=s=>s.price===0?s.id==="free"?"FREE":"Contact Us":`â‚¹${s.price.toLocaleString()}`,F=()=>c.reduce((s,t)=>s+t.price,0),b=()=>n?n.price+F():0,O=s=>{$(s)},z=s=>{B(t=>t.find(a=>a._id===s._id)?t.filter(a=>a._id!==s._id):[...t,s])},D=()=>{if(l===1&&!n){d({title:"Please select a plan",description:"You must select a subscription plan to continue",variant:"destructive"});return}if(l===1&&n?.price===0){d({title:"Enterprise Plan Selected",description:"Our team will contact you within 24 hours to discuss your requirements"}),f("/contact");return}v(s=>Math.min(s+1,3))},W=()=>{v(s=>Math.max(s-1,1))},H=async()=>{if(n){C(!0);try{const s={planId:n.id,addons:c.map(a=>a._id),billingCycle:"monthly",totalAmount:b()};console.log("Proceeding to payment with:",s);const{paymentService:t}=await T(async()=>{const{paymentService:a}=await import("./paymentService-BFb4MCDt.js");return{paymentService:a}},__vite__mapDeps([0,1,2,3,4,5])),r=await t.processSubscriptionPayment(s);if(r.success){d({title:"Payment Successful!",description:`Successfully subscribed to ${n.name}${c.length>0?` with ${c.length} addon(s)`:""}`});try{const{vendorService:a}=await T(async()=>{const{vendorService:j}=await import("./vendorService-bcricvQk.js");return{vendorService:j}},__vite__mapDeps([6,1,2,3,4,5]));await a.refreshSubscriptionData()}catch(a){console.warn("Failed to refresh subscription data:",a)}f("/vendor/subscription-manager")}else throw new Error(r.message||"Payment failed")}catch(s){console.error("Payment failed:",s),d({title:"Payment Failed",description:s instanceof Error?s.message:"Failed to process payment",variant:"destructive"})}finally{C(!1)}}},q=()=>e.jsx("div",{className:"flex items-center justify-center mb-8",children:[{step:1,label:"Choose Plan"},{step:2,label:"Add Services"},{step:3,label:"Payment"}].map(({step:s,label:t},r)=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium ${s<=l?"bg-blue-600 text-white":"bg-muted text-muted-foreground"}`,children:s}),e.jsx("span",{className:`text-xs mt-2 ${s<=l?"text-blue-600 font-medium":"text-muted-foreground"}`,children:t})]}),r<2&&e.jsx("div",{className:`w-16 h-0.5 mx-4 mt-2 ${s<l?"bg-blue-600":"bg-border"}`})]},s))}),Z=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-4",children:i?"Upgrade Your Subscription Plan":"Choose Your Subscription Plan"}),e.jsx("p",{className:"text-muted-foreground text-lg mb-8",children:i?`You currently have the ${i.planName}. Select a higher plan to upgrade.`:"Select the plan that best fits your business needs"}),e.jsx("div",{className:"text-center mb-8",children:e.jsx(m,{variant:"outline",className:"px-4 py-2 text-sm",children:"Monthly Billing - No Long-term Commitments"})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[L.filter(s=>s.id==="free"?!1:i?!i.planName?.toLowerCase()?.includes(s.name.toLowerCase()):!0).map(s=>{const t=i&&i.planName?.toLowerCase().includes(s.name.toLowerCase());return e.jsxs(h,{className:`relative cursor-pointer transition-all duration-200 hover:shadow-lg border-2 ${n?.id===s.id?"border-blue-600 shadow-lg bg-blue-50/50":"border-border hover:border-blue-300"} ${s.recommended?"border-yellow-400":""} ${t?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!t&&O(s),children:[s.recommended&&e.jsx(m,{className:"absolute -top-3 left-1/2 transform -translate-x-1/2 bg-yellow-600 hover:bg-yellow-600",children:"Most Popular"}),t&&e.jsx(m,{className:"absolute -top-3 right-4 bg-green-600 hover:bg-green-600",children:"Current Plan"}),e.jsxs(p,{className:"text-center pb-6",children:[e.jsx("div",{className:"flex justify-center mb-4",children:s.icon}),e.jsx(N,{className:"text-2xl font-bold",children:s.name}),e.jsxs("div",{className:"text-4xl font-bold text-blue-600 mt-4",children:[Y(s),s.price>0&&e.jsx("span",{className:"text-lg text-muted-foreground font-normal",children:"/month"})]}),e.jsx("p",{className:"text-muted-foreground mt-2",children:s.description})]}),e.jsx(g,{children:e.jsx("ul",{className:"space-y-4",children:s.features.map((r,a)=>{const j=typeof r=="string"?r:r.name;return e.jsxs("li",{className:"flex items-center",children:[e.jsx(R,{className:"w-5 h-5 text-green-600 mr-3 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-foreground",children:j})]},a)})})})]},s.id)}),i&&L.filter(s=>s.id==="free"?!1:!i.planName?.toLowerCase()?.includes(s.name.toLowerCase())).length===0&&e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(y,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-2xl font-bold mb-2",children:"You're on the highest plan!"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You currently have the best subscription plan available."}),e.jsx(u,{variant:"outline",onClick:()=>f("/vendor/subscription-manager"),children:"Manage Current Plan"})]})]})]}),G=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-4",children:"Enhance Your Plan"}),e.jsx("p",{className:"text-muted-foreground text-lg mb-8",children:i?.addons?.length>0?`Add more services to boost your property marketing. You currently have ${i.addons.length} addon(s).`:"Add optional services to boost your property marketing"})]}),A?e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(s=>e.jsxs(h,{className:"h-48 animate-pulse",children:[e.jsxs(p,{children:[e.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-6 bg-muted rounded w-1/2"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"h-3 bg-muted rounded w-full mb-2"}),e.jsx("div",{className:"h-3 bg-muted rounded w-2/3"})]})]},s))}):e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.filter(s=>i?.addons?!i.addons.some(t=>t._id===s._id):!0).map(s=>{const t=c.some(a=>a._id===s._id),r=i?.addons?.some(a=>a._id===s._id);return e.jsxs(h,{className:`cursor-pointer transition-all duration-200 hover:shadow-md border-2 ${t?"border-blue-600 bg-blue-50/50 shadow-md":"border-border hover:border-blue-300"} ${r?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!r&&z(s),children:[e.jsxs(p,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-muted",children:E(s.category,s.icon)}),e.jsxs("div",{children:[e.jsx(N,{className:"text-lg font-semibold",children:s.name}),e.jsx(m,{variant:"outline",className:"mt-1 capitalize text-xs",children:s.category})]})]}),r?e.jsx(m,{className:"bg-green-600 hover:bg-green-600 text-white",children:"Purchased"}):t?e.jsx(R,{className:"w-6 h-6 text-blue-600 flex-shrink-0"}):e.jsx(x,{className:"w-6 h-6 text-muted-foreground flex-shrink-0"})]}),e.jsxs("div",{className:"text-2xl font-bold text-blue-600 mt-2",children:["â‚¹",s.price.toLocaleString(),e.jsxs("span",{className:"text-sm text-muted-foreground font-normal",children:["/",s.billingType.replace("_"," ").replace("per property","per listing")]})]})]}),e.jsx(g,{children:e.jsx("p",{className:"text-muted-foreground text-sm leading-relaxed",children:s.description})})]},s._id)})}),!A&&w.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx(x,{className:"w-12 h-12 mx-auto mb-4"}),e.jsx("p",{className:"text-lg",children:"No addon services available at the moment."}),e.jsx("p",{className:"text-sm",children:"You can continue without addons or check back later."})]})})]}),J=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-4",children:"Payment Summary"}),e.jsx("p",{className:"text-muted-foreground text-lg mb-8",children:"Review your selection and complete payment"})]}),e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs(h,{children:[e.jsx(p,{children:e.jsx(N,{className:"text-xl",children:"Order Summary"})}),e.jsxs(g,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between py-4 border-b",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100",children:n?.icon}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-lg",children:[n?.name," Plan"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Billed monthly"})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-bold text-lg",children:["â‚¹",n?.price||0]})})]}),c.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Add-on Services"}),c.map(s=>e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-dashed",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-1.5 rounded bg-muted",children:E(s.category,s.icon)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:s.billingType.replace("_"," ")})]})]}),e.jsxs("p",{className:"font-semibold",children:["â‚¹",s.price.toLocaleString()]})]},s._id))]}),e.jsxs("div",{className:"flex items-center justify-between py-4 border-t-2 border-border",children:[e.jsx("span",{className:"text-xl font-bold",children:"Total Amount"}),e.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:["â‚¹",b().toLocaleString()]})]})]})]}),e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(u,{size:"lg",onClick:H,disabled:S,className:"min-w-[250px] h-12 text-lg",children:S?"Processing...":`Pay â‚¹${b().toLocaleString()}`}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"ðŸ”’ Secure payment powered by Razorpay"})]})]})]});return e.jsxs("div",{className:"space-y-8",children:[q(),l===1&&Z(),l===2&&G(),l===3&&J(),e.jsxs("div",{className:"flex justify-between pt-8",children:[e.jsxs(u,{variant:"outline",onClick:W,disabled:l===1,className:"flex items-center space-x-2",size:"lg",children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{children:"Previous"})]}),l<3&&e.jsxs(u,{onClick:D,className:"flex items-center space-x-2",size:"lg",children:[e.jsx("span",{children:"Next"}),e.jsx(ae,{className:"w-4 h-4"})]})]})]})};export{Se as default};
