import{D as c,t as a}from"./index-Bd1eLXM_.js";class l{baseUrl="https://api.akodefy.com/api";async makeRequest(t,e={}){const r=`${this.baseUrl}${t}`,o={headers:{"Content-Type":"application/json",...e.headers},...e},n=c.getToken();n&&(o.headers={...o.headers,Authorization:`Bearer ${n}`});try{const s=await fetch(r,o);if(!s.ok){const i=await s.json().catch(()=>({success:!1,message:`HTTP ${s.status}: ${s.statusText}`}));throw new Error(i.message||"An error occurred")}return await s.json()}catch(s){throw console.error("API request failed:",s),s}}async getPlans(t={}){try{const e=new URLSearchParams;Object.entries(t).forEach(([n,s])=>{s!=null&&s!==""&&e.append(n,String(s))});const r=`/plans${e.toString()?`?${e.toString()}`:""}`;return await this.makeRequest(r)}catch(e){const r=e instanceof Error?e.message:"Failed to fetch plans";throw a({title:"Error",description:r,variant:"destructive"}),e}}async getPlan(t){try{return await this.makeRequest(`/plans/${t}`)}catch(e){const r=e instanceof Error?e.message:"Failed to fetch plan";throw a({title:"Error",description:r,variant:"destructive"}),e}}async createPlan(t){try{const e=await this.makeRequest("/plans",{method:"POST",body:JSON.stringify(t)});return a({title:"Success",description:"Plan created successfully!"}),e}catch(e){const r=e instanceof Error?e.message:"Failed to create plan";throw a({title:"Error",description:r,variant:"destructive"}),e}}async updatePlan(t,e){try{const r=await this.makeRequest(`/plans/${t}`,{method:"PUT",body:JSON.stringify(e)});return a({title:"Success",description:"Plan updated successfully!"}),r}catch(r){const o=r instanceof Error?r.message:"Failed to update plan";throw a({title:"Error",description:o,variant:"destructive"}),r}}async deletePlan(t){try{await this.makeRequest(`/plans/${t}`,{method:"DELETE"}),a({title:"Success",description:"Plan deleted successfully!"})}catch(e){const r=e instanceof Error?e.message:"Failed to delete plan";throw a({title:"Error",description:r,variant:"destructive"}),e}}async togglePlanStatus(t){try{const e=await this.makeRequest(`/plans/${t}/toggle-status`,{method:"PATCH"});return a({title:"Success",description:"Plan status updated successfully!"}),e}catch(e){const r=e instanceof Error?e.message:"Failed to update plan status";throw a({title:"Error",description:r,variant:"destructive"}),e}}formatPrice(t){const e=t.currency==="INR"?"₹":t.currency==="USD"?"$":"€",r=t.billingPeriod==="monthly"?"/month":t.billingPeriod==="yearly"?"/year":"";return`${e}${t.price.toLocaleString()}${r}`}getPlanBadgeVariant(t){return t.isActive?t.isPopular?"default":"secondary":"destructive"}getFeatureNames(t){return Array.isArray(t)?t.map(e=>typeof e=="string"?e:e.name):[]}formatFeatures(t){const e=this.getFeatureNames(t);return e.length<=3?e.join(", "):`${e.slice(0,2).join(", ")} and ${e.length-2} more`}async getPriceHistory(t){try{return await this.makeRequest(`/plans/${t}/price-history`)}catch(e){const r=e instanceof Error?e.message:"Failed to fetch price history";throw a({title:"Error",description:r,variant:"destructive"}),e}}}const p=new l;export{p};
