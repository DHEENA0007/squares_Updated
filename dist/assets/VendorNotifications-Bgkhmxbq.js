import{j as e}from"./ui-BNZSgpjP.js";import{r as a}from"./router-D8v2YSKU.js";import{D as s,a2 as t,c0 as i,f as r,o as c,a as d,b as l,c as n,bA as o,d as m,e as x,aB as p,h,x as u,y as f,J as j,ad as g,am as N}from"./index-FHRTVVMJ.js";import{I as v}from"./info-CAKsuDov.js";import{f as y}from"./format-Bd33km8J.js";import"./vendor-BxThA0WO.js";const k=s("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),w=()=>{const{toast:s}=t(),[w,b]=a.useState([]),[_,M]=a.useState(!0),[A,C]=a.useState({page:1,limit:20,total:0,pages:1});a.useEffect(()=>{P()},[A.page]);const P=async()=>{M(!0);try{const e=await i.fetchNotifications(A.page,A.limit);b(e.notifications||[]),C(e.pagination||{page:1,limit:20,total:0,pages:1})}catch(e){s({title:"Error",description:"Failed to load notifications",variant:"destructive"})}finally{M(!1)}},z=a=>{switch(a){case"property_alert":case"lead_alert":return e.jsx(j,{className:"h-5 w-5 text-blue-500"});case"price_alert":return e.jsx(k,{className:"h-5 w-5 text-green-500"});case"new_message":case"inquiry_received":return e.jsx(N,{className:"h-5 w-5 text-purple-500"});default:return e.jsx(v,{className:"h-5 w-5 text-gray-500"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Notifications"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your alerts and updates"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(r,{variant:"outline",onClick:async()=>{try{await i.markAllAsRead(),b(e=>e.map(e=>({...e,read:!0}))),s({title:"Success",description:"All notifications marked as read"})}catch(e){s({title:"Error",description:"Failed to update notifications",variant:"destructive"})}},children:[e.jsx(c,{className:"mr-2 h-4 w-4"}),"Mark all as read"]})})]}),e.jsxs(d,{children:[e.jsxs(l,{children:[e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(o,{className:"h-5 w-5"}),"Recent Notifications"]}),e.jsxs(m,{children:["You have ",w.filter(e=>!e.read).length," unread notifications"]})]}),e.jsxs(x,{children:[e.jsx(p,{className:"h-[600px] pr-4",children:_?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):0===w.length?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No notifications found"}):e.jsx("div",{className:"space-y-4",children:w.map(a=>e.jsxs("div",{className:"flex gap-4 p-4 rounded-lg border "+(a.read?"bg-background":"bg-muted/50"),children:[e.jsx("div",{className:"mt-1",children:z(a.type)}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h4",{className:`text-sm font-semibold ${!a.read&&"text-primary"}`,children:a.title}),e.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(h,{className:"h-3 w-3"}),y(new Date(a.createdAt),"MMM d, h:mm a")]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.message}),"lead_alert"===a.type&&a.data&&e.jsxs("div",{className:"mt-3 p-3 bg-background rounded-md border text-sm space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:"Customer:"}),e.jsx("span",{children:a.data.customerName})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:"Phone:"}),e.jsx("a",{href:`tel:${a.data.customerPhone}`,className:"text-primary hover:underline",children:a.data.customerPhone})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:"Property:"}),e.jsx("span",{children:a.data.propertyTitle})]})]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[!a.read&&e.jsx(r,{variant:"ghost",size:"sm",className:"h-8 px-2 text-xs",onClick:()=>(async e=>{try{await i.markAsRead([e]),b(a=>a.map(a=>a._id===e?{...a,read:!0}:a)),s({title:"Marked as read",description:"Notification marked as read"})}catch(a){s({title:"Error",description:"Failed to update notification",variant:"destructive"})}})(a._id),children:"Mark as read"}),e.jsxs(r,{variant:"ghost",size:"sm",className:"h-8 px-2 text-xs text-destructive hover:text-destructive",onClick:()=>(async e=>{try{await i.deleteNotification(e),b(a=>a.filter(a=>a._id!==e)),s({title:"Deleted",description:"Notification deleted"})}catch(a){s({title:"Error",description:"Failed to delete notification",variant:"destructive"})}})(a._id),children:[e.jsx(g,{className:"h-3 w-3 mr-1"}),"Delete"]})]})]})]},a._id))})}),A.pages>1&&e.jsxs("div",{className:"flex justify-center gap-2 mt-4",children:[e.jsx(r,{variant:"outline",size:"sm",disabled:1===A.page,onClick:()=>C(e=>({...e,page:e.page-1})),children:"Previous"}),e.jsxs("span",{className:"flex items-center text-sm text-muted-foreground",children:["Page ",A.page," of ",A.pages]}),e.jsx(r,{variant:"outline",size:"sm",disabled:A.page===A.pages,onClick:()=>C(e=>({...e,page:e.page+1})),children:"Next"})]})]})]})]})};export{w as default};
