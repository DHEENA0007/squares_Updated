import{j as e}from"./ui-CEFKCYQo.js";import{r as a,d as s}from"./router-Bi51YGN-.js";import{D as t,W as i,Y as r,f as l,Z as n,_ as c,$ as d,a0 as o,B as u,a1 as h,a2 as m,a3 as p,a4 as x,a5 as y,a6 as j,L as v,I as g,S as f,r as N,s as C,v as w,w as b,a7 as _,a8 as F,j as S,u as P,a9 as A,a as k,e as O}from"./index-Ds-LUfCl.js";import{T,a as E,b as I,c as L,d as q,e as V}from"./table-BXEnq082.js";import{S as z}from"./switch-DabW_g-h.js";import{T as M}from"./trash-2-lrlF_EY_.js";import{C as D}from"./checkbox-DscVYI3N.js";import{A as U,a as $}from"./alert-CG1_Rq7d.js";import"./vendor-eVk5PToZ.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=t("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),R=()=>{const[s,t]=a.useState([]),[P,A]=a.useState([]),[k,O]=a.useState(!0),[D,U]=a.useState(!1),[$,R]=a.useState(!1),[B,Y]=a.useState(null),[K,Q]=a.useState(""),[W,Z]=a.useState(""),[G,H]=a.useState({name:"",value:"",category:"",icon:"",displayOrder:0}),{toast:X}=i();a.useEffect(()=>{ee()},[]);const ee=async()=>{try{O(!0);const[e,a]=await Promise.all([r.getAllPropertyTypes(!0),r.getPropertyTypeCategoryDetails()]);t(e);const s=Array.from(new Set(e.map(e=>e.category))).sort();A(s),!K&&s.length>0&&Q(s[0])}catch(e){X({title:"Error",description:"Failed to fetch property types",variant:"destructive"})}finally{O(!1)}},ae=()=>{if(!W.trim())return void X({title:"Error",description:"Please enter a category name",variant:"destructive"});const e=W.toLowerCase().replace(/\s+/g,"_");P.includes(e)?X({title:"Error",description:"This category already exists",variant:"destructive"}):(A([...P,e].sort()),Q(e),Z(""),R(!1),X({title:"Success",description:`Category "${W}" created successfully. You can now add property types to it.`}))},se=e=>s.filter(a=>a.category===e),te=e=>{e?(Y(e),H({name:e.name,value:e.value,category:e.category,icon:e.icon||"",displayOrder:e.displayOrder})):(Y(null),H({name:"",value:"",category:K,icon:"",displayOrder:se(K).length})),U(!0)},ie=()=>{U(!1),Y(null),H({name:"",value:"",category:"",icon:"",displayOrder:0})},re=async(e,a,s)=>{const t=se(s),i=t.findIndex(a=>a._id===e);if("up"===a&&0===i||"down"===a&&i===t.length-1)return;const l=[...t],n="up"===a?i-1:i+1;[l[i],l[n]]=[l[n],l[i]];try{await Promise.all(l.map((e,a)=>r.updatePropertyType(e._id,{displayOrder:a}))),ee(),X({title:"Success",description:"Property types reordered successfully"})}catch(c){X({title:"Error",description:"Failed to reorder property types",variant:"destructive"})}},le=e=>e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),ne=a=>{const s=se(a);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Manage ",le(a)," property types"]}),e.jsxs(l,{onClick:()=>te(),children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Add Property Type"]})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(T,{children:[e.jsx(E,{children:e.jsxs(I,{children:[e.jsx(L,{children:"Order"}),e.jsx(L,{children:"Name"}),e.jsx(L,{children:"Value"}),e.jsx(L,{children:"Status"}),e.jsx(L,{className:"text-right",children:"Actions"})]})}),e.jsx(q,{children:0===s.length?e.jsx(I,{children:e.jsx(V,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No property types found. Create your first property type to get started."})}):s.map((t,i)=>e.jsxs(I,{children:[e.jsx(V,{children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>re(t._id,"up",a),disabled:0===i,children:e.jsx(F,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>re(t._id,"down",a),disabled:i===s.length-1,children:e.jsx(S,{className:"h-4 w-4"})})]})}),e.jsx(V,{className:"font-medium",children:t.name}),e.jsx(V,{children:e.jsx("code",{className:"text-sm bg-muted px-2 py-1 rounded",children:t.value})}),e.jsx(V,{children:e.jsx(z,{checked:t.isActive,onCheckedChange:()=>(async(e,a)=>{try{await r.updatePropertyType(e,{isActive:!a}),X({title:"Success",description:`Property type ${a?"deactivated":"activated"} successfully`}),ee()}catch(s){X({title:"Error",description:"Failed to update property type status",variant:"destructive"})}})(t._id,t.isActive)})}),e.jsx(V,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>te(t),children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this property type? This action cannot be undone."))try{await r.deletePropertyType(e),X({title:"Success",description:"Property type deleted successfully"}),ee()}catch(a){X({title:"Error",description:"Failed to delete property type",variant:"destructive"})}})(t._id),children:e.jsx(M,{className:"h-4 w-4 text-destructive"})})]})})]},t._id))})]})})]})};return k?e.jsx("div",{className:"text-center py-8",children:"Loading property types..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Property Types"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage property type categories and their display order dynamically"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(l,{variant:"outline",onClick:()=>R(!0),children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"New Category"]})}),0===P.length?e.jsx("div",{className:"border rounded-lg p-8 text-center text-muted-foreground",children:"No categories found. Create your first category to get started."}):e.jsxs(c,{value:K,onValueChange:Q,children:[e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pb-2",children:e.jsx(d,{className:"inline-flex",children:P.map(a=>{const{total:s,active:t}=(e=>{const a=se(e),s=a.filter(e=>e.isActive).length;return{total:a.length,active:s}})(a);return e.jsx(o,{value:a,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:le(a)}),e.jsxs(u,{variant:"secondary",className:"ml-1",children:[t,"/",s]})]})},a)})})}),P.map(a=>e.jsx(h,{value:a,children:ne(a)},a))]}),e.jsx(m,{open:D,onOpenChange:U,children:e.jsxs(p,{children:[e.jsxs(x,{children:[e.jsx(y,{children:B?"Edit Property Type":"Add Property Type"}),e.jsx(j,{children:B?"Update the property type details below":"Create a new property type for your application"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"name",children:"Name"}),e.jsx(g,{id:"name",value:G.name,onChange:e=>H({...G,name:e.target.value}),placeholder:"e.g., Apartment"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"value",children:"Value (Unique ID)"}),e.jsx(g,{id:"value",value:G.value,onChange:e=>H({...G,value:e.target.value}),placeholder:"e.g., apartment",disabled:!!B}),B&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Value cannot be changed after creation"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"category",children:"Category *"}),e.jsxs(f,{value:G.category,onValueChange:e=>H({...G,category:e}),disabled:!!B,children:[e.jsx(N,{children:e.jsx(C,{})}),e.jsx(w,{children:P.map(a=>e.jsx(b,{value:a,children:le(a)},a))})]}),B&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Category cannot be changed after creation"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"icon",children:"Icon (Optional)"}),e.jsx(g,{id:"icon",value:G.icon,onChange:e=>H({...G,icon:e.target.value}),placeholder:"e.g., home"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"displayOrder",children:"Display Order"}),e.jsx(g,{id:"displayOrder",type:"number",value:G.displayOrder,onChange:e=>H({...G,displayOrder:parseInt(e.target.value)||0})})]})]}),e.jsxs(_,{children:[e.jsx(l,{variant:"outline",onClick:ie,children:"Cancel"}),e.jsx(l,{onClick:async()=>{try{B?(await r.updatePropertyType(B._id,G),X({title:"Success",description:"Property type updated successfully"})):(await r.createPropertyType(G),X({title:"Success",description:"Property type created successfully"})),ee(),ie()}catch(e){X({title:"Error",description:B?"Failed to update property type":"Failed to create property type",variant:"destructive"})}},children:B?"Update":"Create"})]})]})}),e.jsx(m,{open:$,onOpenChange:R,children:e.jsxs(p,{children:[e.jsxs(x,{children:[e.jsx(y,{children:"Create New Category"}),e.jsx(j,{children:"Create a new property type category. It will automatically be formatted as a unique identifier."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"categoryName",children:"Category Name"}),e.jsx(g,{id:"categoryName",value:W,onChange:e=>Z(e.target.value),placeholder:"e.g., Premium Properties",onKeyDown:e=>{"Enter"===e.key&&ae()}}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'This will be converted to lowercase with underscores (e.g., "Premium Properties" → "premium_properties")'})]}),W&&e.jsxs("div",{className:"p-3 bg-muted rounded-md",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Category Value:"}),e.jsx("code",{className:"text-sm bg-background px-2 py-1 rounded inline-block mt-1",children:W.toLowerCase().replace(/\s+/g,"_")})]})]}),e.jsxs(_,{children:[e.jsx(l,{variant:"outline",onClick:()=>{R(!1),Z("")},children:"Cancel"}),e.jsx(l,{onClick:ae,children:"Create Category"})]})]})})]})},B=()=>{const[s,t]=a.useState([]),[c,d]=a.useState([]),[o,h]=a.useState([]),[P,A]=a.useState({}),[k,O]=a.useState(!0),[U,$]=a.useState(!1),[R,B]=a.useState(null),[Y,K]=a.useState({name:"",category:"basic",icon:"",display_order:0}),{toast:Q}=i();a.useEffect(()=>{W()},[]);const W=async()=>{try{O(!0);const[e,a]=await Promise.all([r.getAllAmenities(!0),r.getAllPropertyTypes(!0)]);t(e),d(a);const s={};for(const t of e){const e=[];for(const s of a){(await r.getPropertyTypeAmenities(s.id)).some(e=>e.id===t.id)&&e.push(s.id)}s[t.id]=e}A(s)}catch(e){Q({title:"Error",description:"Failed to fetch data",variant:"destructive"})}finally{O(!1)}},Z=async e=>{if(e){B(e),K({name:e.name,category:e.category||"basic",icon:e.icon||"",display_order:e.display_order});try{const a=[];for(const s of c){(await r.getPropertyTypeAmenities(s.id)).some(a=>a.id===e.id)&&a.push(s.id)}h(a)}catch(a){h([])}}else B(null),K({name:"",category:"basic",icon:"",display_order:s.length}),h([]);$(!0)},G=()=>{$(!1),B(null),K({name:"",category:"basic",icon:"",display_order:0}),h([])},H=async(e,a)=>{const i=s.findIndex(a=>a.id===e);if("up"===a&&0===i||"down"===a&&i===s.length-1)return;const l=[...s],n="up"===a?i-1:i+1;[l[i],l[n]]=[l[n],l[i]];try{await Promise.all(l.map((e,a)=>r.updateAmenity(e.id,{display_order:a}))),t(l),Q({title:"Success",description:"Amenities reordered successfully"})}catch(c){Q({title:"Error",description:"Failed to reorder amenities",variant:"destructive"})}};return k?e.jsx("div",{className:"text-center py-8",children:"Loading amenities..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Amenities"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage amenities available for property listings"})]}),e.jsxs(l,{onClick:()=>Z(),children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Add Amenity"]})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(T,{children:[e.jsx(E,{children:e.jsxs(I,{children:[e.jsx(L,{children:"Order"}),e.jsx(L,{children:"Name"}),e.jsx(L,{children:"Category"}),e.jsx(L,{children:"Property Types"}),e.jsx(L,{children:"Status"}),e.jsx(L,{className:"text-right",children:"Actions"})]})}),e.jsx(q,{children:0===s.length?e.jsx(I,{children:e.jsx(V,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No amenities found. Create your first amenity to get started."})}):s.map((a,t)=>{const i=(P[a.id]||[]).map(e=>c.find(a=>a.id===e)?.name).filter(Boolean);return e.jsxs(I,{children:[e.jsx(V,{children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>H(a.id,"up"),disabled:0===t,children:e.jsx(F,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>H(a.id,"down"),disabled:t===s.length-1,children:e.jsx(S,{className:"h-4 w-4"})})]})}),e.jsx(V,{className:"font-medium",children:a.name}),e.jsx(V,{children:a.category?e.jsx(u,{variant:"outline",children:a.category}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(V,{children:i.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:i.map((a,s)=>e.jsx(u,{variant:"secondary",className:"text-xs",children:a},s))}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"No property types"})}),e.jsx(V,{children:e.jsx(z,{checked:a.is_active,onCheckedChange:()=>(async(e,a)=>{try{await r.updateAmenity(e,{is_active:!a}),Q({title:"Success",description:`Amenity ${a?"deactivated":"activated"} successfully`}),W()}catch(s){Q({title:"Error",description:"Failed to update amenity status",variant:"destructive"})}})(a.id,a.is_active)})}),e.jsx(V,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>Z(a),children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this amenity? This action cannot be undone."))try{await r.deleteAmenity(e),Q({title:"Success",description:"Amenity deleted successfully"}),W()}catch(a){Q({title:"Error",description:"Failed to delete amenity",variant:"destructive"})}})(a.id),children:e.jsx(M,{className:"h-4 w-4 text-destructive"})})]})})]},a.id)})})]})}),e.jsx(m,{open:U,onOpenChange:$,children:e.jsxs(p,{children:[e.jsxs(x,{children:[e.jsx(y,{children:R?"Edit Amenity":"Add Amenity"}),e.jsx(j,{children:R?"Update the amenity details below":"Create a new amenity for property listings"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"name",children:"Name"}),e.jsx(g,{id:"name",value:Y.name,onChange:e=>K({...Y,name:e.target.value}),placeholder:"e.g., Swimming Pool"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"category",children:"Category"}),e.jsxs(f,{value:Y.category,onValueChange:e=>K({...Y,category:e}),children:[e.jsx(N,{children:e.jsx(C,{})}),e.jsxs(w,{children:[e.jsx(b,{value:"basic",children:"Basic"}),e.jsx(b,{value:"luxury",children:"Luxury"}),e.jsx(b,{value:"security",children:"Security"}),e.jsx(b,{value:"recreational",children:"Recreational"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"icon",children:"Icon (Optional)"}),e.jsx(g,{id:"icon",value:Y.icon,onChange:e=>K({...Y,icon:e.target.value}),placeholder:"e.g., waves"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"display_order",children:"Display Order"}),e.jsx(g,{id:"display_order",type:"number",value:Y.display_order,onChange:e=>K({...Y,display_order:parseInt(e.target.value)||0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Property Types"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Select which property types can have this amenity"}),e.jsx("div",{className:"border rounded-lg p-3 space-y-2 max-h-48 overflow-y-auto",children:c.map(a=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{id:`pt-${a.id}`,checked:o.includes(a.id),onCheckedChange:e=>{h(e?[...o,a.id]:o.filter(e=>e!==a.id))}}),e.jsxs(v,{htmlFor:`pt-${a.id}`,className:"font-normal cursor-pointer",children:[a.name," ",e.jsx(u,{variant:"outline",className:"ml-2",children:a.category})]})]},a.id))})]})]}),e.jsxs(_,{children:[e.jsx(l,{variant:"outline",onClick:G,children:"Cancel"}),e.jsx(l,{onClick:async()=>{try{let e;if(R)await r.updateAmenity(R.id,Y),e=R.id;else{const a=await r.createAmenity(Y);e=a.id}for(const a of c){const s=o.includes(a.id),t=await r.getPropertyTypeAmenities(a.id),i=t.some(a=>a.id===e);if(s&&!i){const s=[...t.map(e=>e.id),e];await r.updatePropertyTypeAmenities(a.id,s)}else if(!s&&i){const s=t.filter(a=>a.id!==e).map(e=>e.id);await r.updatePropertyTypeAmenities(a.id,s)}}Q({title:"Success",description:R?"Amenity updated successfully":"Amenity created successfully"}),W(),G()}catch(e){Q({title:"Error",description:R?"Failed to update amenity":"Failed to create amenity",variant:"destructive"})}},children:R?"Update":"Create"})]})]})})]})},Y=()=>{const[s,t]=a.useState([]),[u,P]=a.useState([]),[A,k]=a.useState(!0),[O,D]=a.useState(!1),[U,$]=a.useState(!1),[R,B]=a.useState(null),[Y,K]=a.useState(""),[Q,W]=a.useState(""),[Z,G]=a.useState({filter_type:"",name:"",value:"",min_value:void 0,max_value:void 0,display_label:"",display_order:0}),{toast:H}=i();a.useEffect(()=>{X()},[]);const X=async()=>{try{k(!0);const e=await r.getAllFilterConfigurations(!0);t(e);const a=Array.from(new Set(e.map(e=>e.filterType))).sort();P(a),!Y&&a.length>0&&K(a[0])}catch(e){H({title:"Error",description:"Failed to fetch filters",variant:"destructive"})}finally{k(!1)}},ee=e=>s.filter(a=>a.filterType===e),ae=()=>{if(!Q.trim())return void H({title:"Error",description:"Please enter a filter type name",variant:"destructive"});const e=Q.toLowerCase().replace(/\s+/g,"_");u.includes(e)?H({title:"Error",description:"This filter type already exists",variant:"destructive"}):(P([...u,e].sort()),K(e),W(""),$(!1),H({title:"Success",description:`Filter type "${Q}" created. You can now add filter options for it.`}))},se=e=>{if(e)B(e),G({filter_type:e.filter_type,name:e.name,value:e.value,min_value:e.min_value,max_value:e.max_value,display_label:e.display_label,display_order:e.display_order});else{B(null);const e=ee(Y);G({filter_type:Y,name:"",value:"",min_value:void 0,max_value:void 0,display_label:"",display_order:e.length})}D(!0)},te=()=>{D(!1),B(null),G({filter_type:"bedroom",name:"",value:"",min_value:void 0,max_value:void 0,display_label:"",display_order:0})},ie=async(e,a,s)=>{const t=ee(s),i=t.findIndex(a=>a.id===e);if("up"===a&&0===i||"down"===a&&i===t.length-1)return;const l=[...t],n="up"===a?i-1:i+1;[l[i],l[n]]=[l[n],l[i]];try{await Promise.all(l.map((e,a)=>r.updateFilterConfiguration(e.id,{display_order:a}))),X(),H({title:"Success",description:"Filters reordered successfully"})}catch(c){H({title:"Error",description:"Failed to reorder filters",variant:"destructive"})}},re=a=>{const s=ee(a),t=()=>a.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase());return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Manage ",t()," filter options"]}),e.jsxs(l,{onClick:()=>se(),children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Add ",t()," Option"]})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(T,{children:[e.jsx(E,{children:e.jsxs(I,{children:[e.jsx(L,{children:"Order"}),e.jsx(L,{children:"Name"}),e.jsx(L,{children:"Display Label"}),e.jsx(L,{children:"Value"}),"budget"===a&&e.jsxs(e.Fragment,{children:[e.jsx(L,{children:"Min Value"}),e.jsx(L,{children:"Max Value"})]}),e.jsx(L,{children:"Status"}),e.jsx(L,{className:"text-right",children:"Actions"})]})}),e.jsx(q,{children:0===s.length?e.jsx(I,{children:e.jsx(V,{colSpan:"budget"===a?8:6,className:"text-center py-8 text-muted-foreground",children:"No filters found. Create your first filter to get started."})}):s.map((t,i)=>e.jsxs(I,{children:[e.jsx(V,{children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>ie(t.id,"up",a),disabled:0===i,children:e.jsx(F,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>ie(t.id,"down",a),disabled:i===s.length-1,children:e.jsx(S,{className:"h-4 w-4"})})]})}),e.jsx(V,{className:"font-medium",children:t.name}),e.jsx(V,{children:t.display_label||t.name}),e.jsx(V,{children:e.jsx("code",{className:"text-sm bg-muted px-2 py-1 rounded",children:t.value})}),"budget"===a&&e.jsxs(e.Fragment,{children:[e.jsx(V,{children:t.min_value?`₹${(t.min_value/1e5).toFixed(0)}L`:"-"}),e.jsx(V,{children:t.max_value?`₹${(t.max_value/1e5).toFixed(0)}L`:"-"})]}),e.jsx(V,{children:e.jsx(z,{checked:t.is_active,onCheckedChange:()=>(async(e,a)=>{try{await r.updateFilterConfiguration(e,{is_active:!a}),H({title:"Success",description:`Filter ${a?"deactivated":"activated"} successfully`}),X()}catch(s){H({title:"Error",description:"Failed to update filter status",variant:"destructive"})}})(t.id,t.is_active)})}),e.jsx(V,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>se(t),children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this filter? This action cannot be undone."))try{await r.deleteFilterConfiguration(e),H({title:"Success",description:"Filter deleted successfully"}),X()}catch(a){H({title:"Error",description:"Failed to delete filter",variant:"destructive"})}})(t.id),children:e.jsx(M,{className:"h-4 w-4 text-destructive"})})]})})]},t.id))})]})})]})};return A?e.jsx("div",{className:"text-center py-8",children:"Loading filters..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Filter Configurations"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage filter options for property search and filtering"})]}),e.jsxs(l,{onClick:()=>$(!0),children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"New Filter Type"]})]}),0===u.length?e.jsxs("div",{className:"border rounded-lg p-8 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"No filter types found. Create your first filter type to get started."}),e.jsxs(l,{onClick:()=>$(!0),children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Create First Filter Type"]})]}):e.jsxs(c,{value:Y,onValueChange:K,children:[e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto",children:e.jsx(d,{className:"inline-flex",children:u.map(a=>e.jsx(o,{value:a,children:a.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())},a))})}),u.map(a=>e.jsx(h,{value:a,children:re(a)},a))]}),e.jsx(m,{open:O,onOpenChange:D,children:e.jsxs(p,{children:[e.jsxs(x,{children:[e.jsx(y,{children:R?"Edit Filter":"Add Filter"}),e.jsx(j,{children:R?"Update the filter details below":"Create a new filter option"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"filter_type",children:"Filter Type"}),e.jsxs(f,{value:Z.filter_type,onValueChange:e=>G({...Z,filter_type:e}),disabled:!!R,children:[e.jsx(N,{children:e.jsx(C,{})}),e.jsx(w,{children:u.map(a=>e.jsx(b,{value:a,children:a.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())},a))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"name",children:"Name *"}),e.jsx(g,{id:"name",value:Z.name,onChange:e=>G({...Z,name:e.target.value}),placeholder:"e.g., For Sale",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"value",children:"Value (Unique ID) *"}),e.jsx(g,{id:"value",value:Z.value,onChange:e=>G({...Z,value:e.target.value}),placeholder:"e.g., sale",disabled:!!R,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"display_label",children:"Display Label (Optional)"}),e.jsx(g,{id:"display_label",value:Z.display_label,onChange:e=>G({...Z,display_label:e.target.value}),placeholder:"Defaults to Name if not provided"})]}),"budget"===Z.filter_type&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"min_value",children:"Min Value (₹)"}),e.jsx(g,{id:"min_value",type:"number",value:Z.min_value||"",onChange:e=>G({...Z,min_value:e.target.value?parseFloat(e.target.value):void 0}),placeholder:"e.g., 2000000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"max_value",children:"Max Value (₹)"}),e.jsx(g,{id:"max_value",type:"number",value:Z.max_value||"",onChange:e=>G({...Z,max_value:e.target.value?parseFloat(e.target.value):void 0}),placeholder:"e.g., 4000000"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"display_order",children:"Display Order"}),e.jsx(g,{id:"display_order",type:"number",value:Z.display_order,onChange:e=>G({...Z,display_order:parseInt(e.target.value)||0})})]})]}),e.jsxs(_,{children:[e.jsx(l,{variant:"outline",onClick:te,children:"Cancel"}),e.jsx(l,{onClick:async()=>{try{R?(await r.updateFilterConfiguration(R.id,Z),H({title:"Success",description:"Filter updated successfully"})):(await r.createFilterConfiguration(Z),H({title:"Success",description:"Filter created successfully"})),X(),te()}catch(e){H({title:"Error",description:R?"Failed to update filter":"Failed to create filter",variant:"destructive"})}},children:R?"Update":"Create"})]})]})}),e.jsx(m,{open:U,onOpenChange:$,children:e.jsxs(p,{children:[e.jsxs(x,{children:[e.jsx(y,{children:"Create New Filter Type"}),e.jsx(j,{children:"Create a new filter category to organize your property search filters"})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"newFilterTypeName",children:"Filter Type Name *"}),e.jsx(g,{id:"newFilterTypeName",value:Q,onChange:e=>W(e.target.value),placeholder:"e.g., Property Status, Location Type, Price Range",onKeyDown:e=>{"Enter"===e.key&&ae()}}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'This will be converted to lowercase with underscores (e.g., "property_status")'})]})}),e.jsxs(_,{children:[e.jsx(l,{variant:"outline",onClick:()=>{$(!1),W("")},children:"Cancel"}),e.jsx(l,{onClick:ae,children:"Create Filter Type"})]})]})})]})},K=()=>{const[s,t]=a.useState([]),[u,P]=a.useState(!0),[A,k]=a.useState(!1),[O,D]=a.useState(null),[U,$]=a.useState("main"),[R,B]=a.useState({name:"",value:"",displayLabel:"",category:"main",parentId:"",queryParams:"",displayOrder:0}),{toast:Y}=i();a.useEffect(()=>{K()},[]);const K=async()=>{try{P(!0);const e=await r.getAllNavigationItems(!0);t(e)}catch(e){Y({title:"Error",description:"Failed to fetch navigation items",variant:"destructive"})}finally{P(!1)}},Q=e=>{e?(D(e),B({name:e.name,value:e.value,displayLabel:e.displayLabel||"",category:e.category,parentId:e.parentId||"",queryParams:e.queryParams?JSON.stringify(e.queryParams):"",displayOrder:e.displayOrder})):(D(null),B({name:"",value:"",displayLabel:"",category:U,parentId:"",queryParams:"",displayOrder:Z(U).length})),k(!0)},W=()=>{k(!1),D(null),B({name:"",value:"",displayLabel:"",category:"main",parentId:"",queryParams:"",displayOrder:0})},Z=e=>s.filter(a=>a.category===e),G=async(e,a,s)=>{const t=Z(s),i=t.findIndex(a=>a._id===e);if("up"===a&&0===i||"down"===a&&i===t.length-1)return;const l=[...t],n="up"===a?i-1:i+1;[l[i],l[n]]=[l[n],l[i]];try{await Promise.all(l.map((e,a)=>r.updateNavigationItem(e._id,{displayOrder:a}))),K(),Y({title:"Success",description:"Navigation items reordered successfully"})}catch(c){Y({title:"Error",description:"Failed to reorder navigation items",variant:"destructive"})}},H=a=>{const s=Z(a);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Manage ",a," navigation items"]}),e.jsxs(l,{onClick:()=>Q(),children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Add Navigation Item"]})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(T,{children:[e.jsx(E,{children:e.jsxs(I,{children:[e.jsx(L,{children:"Order"}),e.jsx(L,{children:"Name"}),e.jsx(L,{children:"Display Label"}),e.jsx(L,{children:"Value"}),e.jsx(L,{children:"Query Params"}),e.jsx(L,{children:"Status"}),e.jsx(L,{className:"text-right",children:"Actions"})]})}),e.jsx(q,{children:0===s.length?e.jsx(I,{children:e.jsx(V,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No navigation items found. Create your first item to get started."})}):s.map((t,i)=>e.jsxs(I,{children:[e.jsx(V,{children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>G(t._id,"up",a),disabled:0===i,children:e.jsx(F,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>G(t._id,"down",a),disabled:i===s.length-1,children:e.jsx(S,{className:"h-4 w-4"})})]})}),e.jsx(V,{className:"font-medium",children:t.name}),e.jsx(V,{children:t.displayLabel||t.name}),e.jsx(V,{children:e.jsx("code",{className:"text-sm bg-muted px-2 py-1 rounded",children:t.value})}),e.jsx(V,{children:t.queryParams&&Object.keys(t.queryParams).length>0?e.jsx("code",{className:"text-xs bg-muted px-2 py-1 rounded",children:JSON.stringify(t.queryParams)}):"-"}),e.jsx(V,{children:e.jsx(z,{checked:t.isActive,onCheckedChange:()=>(async(e,a)=>{try{await r.updateNavigationItem(e,{isActive:!a}),Y({title:"Success",description:`Navigation item ${a?"deactivated":"activated"} successfully`}),K()}catch(s){Y({title:"Error",description:"Failed to update navigation item status",variant:"destructive"})}})(t._id,t.isActive)})}),e.jsx(V,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>Q(t),children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this navigation item? This action cannot be undone."))try{await r.deleteNavigationItem(e),Y({title:"Success",description:"Navigation item deleted successfully"}),K()}catch(a){Y({title:"Error",description:"Failed to delete navigation item",variant:"destructive"})}})(t._id),children:e.jsx(M,{className:"h-4 w-4 text-destructive"})})]})})]},t._id))})]})})]})};return u?e.jsx("div",{className:"text-center py-8",children:"Loading navigation..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Navigation Management"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage navigation structure, categories, and property types dynamically"})]}),e.jsxs(c,{value:U,onValueChange:$,children:[e.jsxs(d,{className:"grid w-full grid-cols-4",children:[e.jsx(o,{value:"main",children:"Main Nav"}),e.jsx(o,{value:"residential",children:"Residential"}),e.jsx(o,{value:"commercial",children:"Commercial"}),e.jsx(o,{value:"agricultural",children:"Agricultural"})]}),e.jsx(h,{value:"main",children:H("main")}),e.jsx(h,{value:"residential",children:H("residential")}),e.jsx(h,{value:"commercial",children:H("commercial")}),e.jsx(h,{value:"agricultural",children:H("agricultural")})]}),e.jsx(m,{open:A,onOpenChange:k,children:e.jsxs(p,{className:"max-w-2xl",children:[e.jsxs(x,{children:[e.jsx(y,{children:O?"Edit Navigation Item":"Add Navigation Item"}),e.jsx(j,{children:"Configure navigation item with display name, value, and query parameters"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"name",children:"Name *"}),e.jsx(g,{id:"name",value:R.name,onChange:e=>B({...R,name:e.target.value}),placeholder:"e.g., Flat / Apartment",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"value",children:"Value *"}),e.jsx(g,{id:"value",value:R.value,onChange:e=>B({...R,value:e.target.value}),placeholder:"e.g., apartment",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"displayLabel",children:"Display Label (Optional)"}),e.jsx(g,{id:"displayLabel",value:R.displayLabel,onChange:e=>B({...R,displayLabel:e.target.value}),placeholder:"Defaults to Name if not provided"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"category",children:"Category *"}),e.jsxs(f,{value:R.category,onValueChange:e=>B({...R,category:e}),children:[e.jsx(N,{children:e.jsx(C,{})}),e.jsxs(w,{children:[e.jsx(b,{value:"main",children:"Main Navigation"}),e.jsx(b,{value:"residential",children:"Residential"}),e.jsx(b,{value:"commercial",children:"Commercial"}),e.jsx(b,{value:"agricultural",children:"Agricultural"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"displayOrder",children:"Display Order"}),e.jsx(g,{id:"displayOrder",type:"number",value:R.displayOrder,onChange:e=>B({...R,displayOrder:parseInt(e.target.value)||0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"queryParams",children:"Query Parameters (JSON)"}),e.jsx(g,{id:"queryParams",value:R.queryParams,onChange:e=>B({...R,queryParams:e.target.value}),placeholder:'{"listingType": "sale", "propertyType": "apartment"}'}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Optional: JSON object for URL query parameters"})]})]}),e.jsxs(_,{children:[e.jsx(l,{variant:"outline",onClick:W,children:"Cancel"}),e.jsx(l,{onClick:async()=>{try{let a;if(R.queryParams&&R.queryParams.trim())try{a=JSON.parse(R.queryParams)}catch(e){return void Y({title:"Error",description:"Invalid JSON format for query parameters",variant:"destructive"})}const s={name:R.name,value:R.value,displayLabel:R.displayLabel||void 0,category:R.category,parentId:R.parentId||void 0,queryParams:a,displayOrder:R.displayOrder};O?(await r.updateNavigationItem(O._id,s),Y({title:"Success",description:"Navigation item updated successfully"})):(await r.createNavigationItem(s),Y({title:"Success",description:"Navigation item created successfully"})),K(),W()}catch(a){Y({title:"Error",description:O?"Failed to update navigation item":"Failed to create navigation item",variant:"destructive"})}},children:O?"Update":"Create"})]})]})})]})},Q=()=>{const{isSuperAdmin:t}=P(),i=s(),[r,l]=a.useState("property-management");return a.useEffect(()=>{t||i("/admin/dashboard")},[t,i]),t?e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(A,{className:"h-8 w-8"}),"Filter Management"]}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage property types, amenities, and filters dynamically"})]})}),e.jsx(U,{children:e.jsx($,{children:"Changes made here will affect all property listings, filters, and search functionality across the application. Please review changes carefully before saving."})}),e.jsx(k,{children:e.jsx(O,{className:"pt-6",children:e.jsxs(c,{value:r,onValueChange:l,className:"w-full",children:[e.jsxs(d,{className:"grid w-full grid-cols-3",children:[e.jsx(o,{value:"property-management",children:"Property Management"}),e.jsx(o,{value:"filter-configuration",children:"Filter Configuration"}),e.jsx(o,{value:"navigation-management",children:"Navigation Management"})]}),e.jsx(h,{value:"property-management",className:"mt-6",children:e.jsxs(c,{defaultValue:"property-types",className:"w-full",children:[e.jsxs(d,{className:"grid w-full grid-cols-2",children:[e.jsx(o,{value:"property-types",children:"Property Types"}),e.jsx(o,{value:"amenities",children:"Amenities"})]}),e.jsx(h,{value:"property-types",className:"mt-6",children:e.jsx(R,{})}),e.jsx(h,{value:"amenities",className:"mt-6",children:e.jsx(B,{})})]})}),e.jsx(h,{value:"filter-configuration",className:"mt-6",children:e.jsx(Y,{})}),e.jsx(h,{value:"navigation-management",className:"mt-6",children:e.jsx(K,{})})]})})})]}):null};export{Q as default};
