import{j as e}from"./ui-DOY6021Z.js";import{r as a}from"./router-2SVJvIbS.js";import{a as n,b as o,c as m,e as l,ad as N,M as L,I as v,q as U,r as R,s as V,v as $,w as q,B as z,U as H,f as A,E as G}from"./index-SPvHGBGF.js";import{T as J}from"./textarea-CVqyUzcD.js";import{C as P}from"./checkbox-BLKtZrMn.js";import{D as Q,f as W,a as Y,b as K,c as X}from"./dialog-LNpiSwLW.js";import{S as Z}from"./smartphone-CKkw2O7L.js";import{S as ee}from"./send-Znhivxwv.js";import"./vendor-Dazix4UH.js";const xe=()=>{const[se,ae]=a.useState("push"),[x,M]=a.useState("all_users"),[c,j]=a.useState(""),[r,p]=a.useState(""),[f,S]=a.useState(""),[g,y]=a.useState(""),[d,w]=a.useState(!1),[i,h]=a.useState(["push"]),[ie,te]=a.useState(!1),[C,T]=a.useState(!1),b=[{value:"all_users",label:"All Users",count:15420},{value:"customers",label:"Customers Only",count:12850},{value:"vendors",label:"Vendors/Builders",count:1240},{value:"active_users",label:"Active Users (Last 30 days)",count:8650},{value:"premium_users",label:"Premium Subscribers",count:890},{value:"city_specific",label:"City Specific",count:0},{value:"custom",label:"Custom Audience",count:0}],D=[{id:"push",label:"Push Notifications",icon:N,description:"Mobile and web push notifications"},{id:"email",label:"Email",icon:L,description:"Email notifications"},{id:"sms",label:"SMS",icon:Z,description:"Text message notifications"}],E=[{_id:"1",name:"New Properties Alert",subject:"New Properties in Your Area!",content:"Discover amazing new properties that match your preferences. Check them out now!",type:"promotional",channels:["push","email"]},{_id:"2",name:"Price Drop Alert",subject:"Price Drop Alert - Save Big!",content:"Great news! Properties you're watching have reduced their prices. Don't miss out!",type:"alert",channels:["push","email","sms"]},{_id:"3",name:"System Maintenance",subject:"Scheduled Maintenance Notice",content:"We'll be performing system maintenance on [DATE]. The platform will be unavailable for 2 hours.",type:"informational",channels:["email","push"]}],I=(s,t)=>{h(t?[...i,s]:i.filter(u=>u!==s))},_=s=>{j(s.subject),p(s.content),h(s.channels)},B=async()=>{if(!c.trim()||!r.trim()||i.length===0){alert("Please fill in all required fields and select at least one channel");return}T(!0);try{const s={subject:c,message:r,targetAudience:x,channels:i,isScheduled:d,scheduledDate:d?`${f}T${g}`:null};(await fetch("/api/admin/notifications/send",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify(s)})).ok?(alert("Notification sent successfully!"),j(""),p(""),h(["push"]),w(!1),S(""),y("")):alert("Failed to send notification")}catch(s){console.error("Failed to send notification:",s),alert("Failed to send notification")}finally{T(!1)}},k=()=>b.find(t=>t.value===x)||b[0];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Send Notifications"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Send push notifications and emails for marketing campaigns"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(n,{children:[e.jsx(o,{children:e.jsx(m,{children:"Quick Templates"})}),e.jsx(l,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:E.map(s=>e.jsxs("div",{className:"p-3 border rounded-lg cursor-pointer hover:bg-accent transition-colors",onClick:()=>_(s),children:[e.jsx("h4",{className:"font-medium text-sm mb-1",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:s.subject}),e.jsx("div",{className:"flex gap-1 mt-2",children:s.channels.map(t=>{const F=D.find(O=>O.id===t)?.icon||N;return e.jsx(F,{className:"w-3 h-3 text-muted-foreground"},t)})})]},s._id))})})]}),e.jsxs(n,{children:[e.jsx(o,{children:e.jsx(m,{children:"Notification Content"})}),e.jsxs(l,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Subject/Title *"}),e.jsx(v,{placeholder:"Enter notification subject...",value:c,onChange:s=>j(s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Message Content *"}),e.jsx(J,{placeholder:"Enter your notification message...",value:r,onChange:s=>p(s.target.value),rows:6})]})]})]}),e.jsxs(n,{children:[e.jsx(o,{children:e.jsx(m,{children:"Delivery Channels *"})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-3",children:D.map(s=>{const t=s.icon;return e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(P,{id:s.id,checked:i.includes(s.id),onCheckedChange:u=>I(s.id,u)}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(t,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("label",{htmlFor:s.id,className:"text-sm font-medium cursor-pointer",children:s.label})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.description})]},s.id)})})})]}),e.jsxs(n,{children:[e.jsx(o,{children:e.jsx(m,{children:"Scheduling"})}),e.jsxs(l,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{id:"schedule",checked:d,onCheckedChange:s=>w(s)}),e.jsx("label",{htmlFor:"schedule",className:"text-sm font-medium cursor-pointer",children:"Schedule for later"})]}),d&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Date"}),e.jsx(v,{type:"date",value:f,onChange:s=>S(s.target.value),min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Time"}),e.jsx(v,{type:"time",value:g,onChange:s=>y(s.target.value)})]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(n,{children:[e.jsx(o,{children:e.jsx(m,{children:"Target Audience"})}),e.jsxs(l,{className:"space-y-4",children:[e.jsxs(U,{value:x,onValueChange:M,children:[e.jsx(R,{children:e.jsx(V,{})}),e.jsx($,{children:b.map(s=>e.jsx(q,{value:s.value,children:e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("span",{children:s.label}),s.count>0&&e.jsx(z,{variant:"secondary",className:"ml-2",children:s.count.toLocaleString()})]})},s.value))})]}),e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(H,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium text-sm",children:"Estimated Reach"})]}),e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[k().count.toLocaleString()," users"]})]})]})]}),e.jsxs(n,{children:[e.jsx(o,{children:e.jsx(m,{children:"Preview"})}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs(Q,{children:[e.jsx(W,{asChild:!0,children:e.jsxs(A,{variant:"outline",className:"w-full",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Preview Notification"]})}),e.jsxs(Y,{children:[e.jsx(K,{children:e.jsx(X,{children:"Notification Preview"})}),e.jsxs("div",{className:"space-y-4",children:[i.includes("push")&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Push Notification"}),e.jsxs("div",{className:"p-3 border rounded-lg bg-gray-50 max-w-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(N,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium text-sm",children:"NinetyNine Acres"})]}),e.jsx("div",{className:"font-medium text-sm mb-1",children:c||"Subject"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:r||"Message content will appear here..."})]})]}),i.includes("email")&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Email"}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"border-b pb-2 mb-3",children:[e.jsx("div",{className:"font-medium",children:c||"Subject"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"from: noreply@ninetyniineacres.com"})]}),e.jsx("div",{className:"text-sm whitespace-pre-wrap",children:r||"Message content will appear here..."})]})]})]})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Channels:"}),e.jsx("span",{children:i.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Recipients:"}),e.jsx("span",{children:k().count.toLocaleString()})]}),d&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Scheduled:"}),e.jsxs("span",{children:[f," ",g]})]})]})]})})]}),e.jsx(n,{children:e.jsx(l,{className:"pt-6",children:e.jsx(A,{onClick:B,disabled:C||!c.trim()||!r.trim()||i.length===0,className:"w-full",children:C?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Sending..."]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4"}),d?"Schedule Notification":"Send Now"]})})})})]})]})]})};export{xe as default};
