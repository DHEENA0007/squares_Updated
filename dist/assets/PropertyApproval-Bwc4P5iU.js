import{j as e}from"./ui-DYmpZ3pJ.js";import{r as t}from"./router-2SVJvIbS.js";import{B as A,a as f,e as v,C as N,ah as S,h as B,f as r,E as D,a7 as R}from"./index-BbgqWuYN.js";import{T as b}from"./textarea-Cl1lQCIh.js";import{D as c,f as o,a as d,b as x,c as m}from"./dialog-DsX3mE8Q.js";import{C as T}from"./calendar-BL1izdXI.js";import"./vendor-Dazix4UH.js";const V=()=>{const[i,y]=t.useState([]),[w,h]=t.useState(!0),[k,z]=t.useState(null),[l,j]=t.useState(""),[g,p]=t.useState(""),n=async()=>{h(!0);try{const s=await fetch("/api/admin/properties/pending-approval",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(s.ok){const a=await s.json();y(a.properties)}}catch(s){console.error("Failed to fetch properties:",s)}finally{h(!1)}};t.useEffect(()=>{n()},[]);const C=async s=>{try{(await fetch(`/api/admin/properties/${s}/approve`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({notes:g})})).ok&&(p(""),n())}catch(a){console.error("Failed to approve property:",a)}},P=async s=>{if(!l.trim()){alert("Please provide a reason for rejection");return}try{(await fetch(`/api/admin/properties/${s}/reject`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({reason:l})})).ok&&(j(""),n())}catch(a){console.error("Failed to reject property:",a)}};return w?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Property Approval"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Final approval for property listings awaiting publication"})]}),e.jsxs(A,{variant:"outline",className:"bg-orange-100 text-orange-800",children:[i.length," Pending Approval"]})]}),i.length===0?e.jsx(f,{children:e.jsx(v,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(N,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"All Caught Up!"}),e.jsx("p",{className:"text-muted-foreground",children:"No properties are currently pending approval."})]})})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:i.map(s=>e.jsx(f,{className:"hover:shadow-lg transition-shadow",children:e.jsxs(v,{className:"pt-6",children:[e.jsx("div",{className:"w-full h-48 bg-gray-200 rounded-lg overflow-hidden mb-4",children:s.images&&s.images.length>0?e.jsx("img",{src:s.images[0],alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:e.jsx(S,{className:"w-12 h-12 text-gray-400"})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-1",children:s.title}),e.jsxs("div",{className:"flex items-center text-muted-foreground text-sm",children:[e.jsx(B,{className:"w-4 h-4 mr-1"}),e.jsxs("span",{children:[s.location.city,", ",s.location.state]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-bold text-primary",children:["â‚¹",s.price.toLocaleString()]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Price"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-bold",children:[s.bedrooms,"BR"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Bedrooms"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold",children:s.area}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Sq ft"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Vendor: ",s.vendor.name]}),e.jsxs("div",{className:"flex items-center text-muted-foreground",children:[e.jsx(T,{className:"w-4 h-4 mr-1"}),e.jsx("span",{children:new Date(s.createdAt).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(c,{children:[e.jsx(o,{asChild:!0,children:e.jsxs(r,{variant:"outline",size:"sm",className:"flex-1",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"View Details"]})}),e.jsxs(d,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsx(x,{children:e.jsx(m,{children:s.title})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.images&&s.images.map((a,u)=>e.jsx("img",{src:a,alt:`Property ${u+1}`,className:"w-full h-48 object-cover rounded-lg"},u))}),e.jsx("p",{className:"text-muted-foreground",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Property Details"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsxs("li",{children:["Type: ",s.propertyType]}),e.jsxs("li",{children:["Bedrooms: ",s.bedrooms]}),e.jsxs("li",{children:["Bathrooms: ",s.bathrooms]}),e.jsxs("li",{children:["Area: ",s.area," sq ft"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Vendor Information"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsxs("li",{children:["Name: ",s.vendor.name]}),e.jsxs("li",{children:["Email: ",s.vendor.email]})]})]})]})]})]})]}),e.jsxs(c,{children:[e.jsx(o,{asChild:!0,children:e.jsxs(r,{size:"sm",className:"bg-green-600 hover:bg-green-700",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Approve"]})}),e.jsxs(d,{children:[e.jsx(x,{children:e.jsx(m,{children:"Approve Property"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{children:['Are you sure you want to approve "',s.title,'"?']}),e.jsx(b,{placeholder:"Add approval notes (optional)...",value:g,onChange:a=>p(a.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(r,{variant:"outline",children:"Cancel"}),e.jsx(r,{className:"bg-green-600 hover:bg-green-700",onClick:()=>C(s._id),children:"Approve Property"})]})]})]})]}),e.jsxs(c,{children:[e.jsx(o,{asChild:!0,children:e.jsxs(r,{variant:"destructive",size:"sm",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Reject"]})}),e.jsxs(d,{children:[e.jsx(x,{children:e.jsx(m,{children:"Reject Property"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{children:['Please provide a reason for rejecting "',s.title,'":']}),e.jsx(b,{placeholder:"Reason for rejection (required)...",value:l,onChange:a=>j(a.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(r,{variant:"outline",children:"Cancel"}),e.jsx(r,{variant:"destructive",onClick:()=>P(s._id),children:"Reject Property"})]})]})]})]})]})]})]})},s._id))})]})};export{V as default};
