import{y as i}from"./index-BbgqWuYN.js";class c{baseUrl="https://squares-v2.onrender.com/api";async makeRequest(e,t={}){const o=`${this.baseUrl}${e}`,s={headers:{"Content-Type":"application/json",...t.headers},...t},a=i.getToken();a&&(s.headers={...s.headers,Authorization:`Bearer ${a}`});try{const r=await fetch(o,s);if(!r.ok){const n=await r.json().catch(()=>({success:!1,message:`HTTP ${r.status}: ${r.statusText}`}));throw new Error(n.message||"An error occurred")}return await r.json()}catch(r){throw console.error("API request failed:",r),r}}async getCustomerDashboardData(){try{return await this.makeRequest("/customer/dashboard")}catch(e){return console.error("Failed to fetch customer dashboard data:",e),{success:!0,data:{stats:{propertiesViewed:0,propertiesViewedChange:"+0 this week",savedFavorites:0,savedFavoritesChange:"+0 new",activeInquiries:0,activeInquiriesChange:"0 pending response",myProperties:0,myPropertiesChange:"0 active listing"},recentActivities:[],recommendedProperties:[],quickStats:{favoritesCount:0,messagesCount:0,propertiesCount:0,unreadMessages:0}}}}}async getCustomerStats(){try{const e=await this.makeRequest("/dashboard/customer/stats");if(e.success&&e.data)return e.data;throw new Error("Failed to fetch customer stats")}catch(e){return console.error("Failed to fetch customer stats:",e),{propertiesViewed:0,propertiesViewedChange:"+0 this week",savedFavorites:0,savedFavoritesChange:"+0 new",activeInquiries:0,activeInquiriesChange:"0 pending response",myProperties:0,myPropertiesChange:"0 active listing"}}}async getRecentActivities(){try{const e=await this.makeRequest("/customer/activities");if(e.success&&e.data)return e.data;throw new Error("Failed to fetch recent activities")}catch(e){return console.error("Failed to fetch recent activities:",e),[]}}async getRecommendedProperties(e=6){try{const t=await this.makeRequest(`/customer/recommended-properties?limit=${e}`);if(t.success&&t.data)return t.data;throw new Error("Failed to fetch recommended properties")}catch(t){return console.error("Failed to fetch recommended properties:",t),[]}}async getQuickStats(){try{const e=await this.makeRequest("/customer/quick-stats");if(e.success&&e.data)return e.data;throw new Error("Failed to fetch quick stats")}catch(e){return console.error("Failed to fetch quick stats:",e),{favoritesCount:0,messagesCount:0,propertiesCount:0,unreadMessages:0}}}formatPrice(e,t){return t==="rent"?`₹${e.toLocaleString("en-IN")}/month`:t==="lease"?`₹${e.toLocaleString("en-IN")}/year`:e>=1e7?`₹${(e/1e7).toFixed(1)} Cr`:e>=1e5?`₹${(e/1e5).toFixed(1)} Lac`:`₹${e.toLocaleString("en-IN")}`}formatTimeAgo(e){const t=new Date(e),s=new Date().getTime()-t.getTime(),a=Math.floor(s/(1e3*60)),r=Math.floor(a/60),n=Math.floor(r/24);return a<1?"Just now":a<60?`${a} min ago`:r<24?`${r} hour${r>1?"s":""} ago`:n<7?`${n} day${n>1?"s":""} ago`:t.toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"})}getActivityIcon(e){return{favorite:"Heart",inquiry:"MessageSquare",search:"Search",property_posted:"Home",property_updated:"Edit"}[e]||"Activity"}getDaysRemaining(e){const t=new Date(e),o=new Date,s=t.getTime()-o.getTime();return Math.max(0,Math.ceil(s/(1e3*60*60*24)))}async trackPropertyView(e){try{await this.makeRequest("/dashboard/customer/track-view",{method:"POST",body:JSON.stringify({propertyId:e})})}catch(t){console.error("Failed to track property view:",t)}}async trackSearchActivity(e,t){try{await this.makeRequest("/dashboard/customer/track-search",{method:"POST",body:JSON.stringify({searchQuery:e,filters:t})})}catch(o){console.error("Failed to track search activity:",o)}}}const h=new c;export{h as c};
