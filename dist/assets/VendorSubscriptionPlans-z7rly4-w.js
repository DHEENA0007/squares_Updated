const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/paymentService-BjbjsdCg.js","assets/index-CV77Hym3.js","assets/ui-DHQhougw.js","assets/router-Bi51YGN-.js","assets/vendor-eVk5PToZ.js","assets/vendorService-BBU9_Mqe.js","assets/reviewsService-BQH4s__s.js"])))=>i.map(i=>d[i]);
import{$ as e,f as s,A as t,B as a,a as r,b as i,c as n,e as l,C as c,a9 as d,aq as o,U as m,as as x,G as u,_ as p}from"./index-CV77Hym3.js";import{j as h}from"./ui-DHQhougw.js";import{r as j,d as g}from"./router-Bi51YGN-.js";import{a as b}from"./addonService-C5oBZK4p.js";import{A as f}from"./arrow-right-DY8SDkqr.js";import{S as N}from"./shield-DhOisX9k.js";import{Z as v}from"./zap-B0OhpgVx.js";import{S as y}from"./share-2-bacMo3Ld.js";import{V as w}from"./video-D9BB_bB4.js";import{C as P}from"./camera-CBOG7LcH.js";import"./vendor-eVk5PToZ.js";const S=()=>{const[S,_]=j.useState(1),[C,A]=j.useState(null),[E,k]=j.useState([]),[L,R]=j.useState([]),[$,B]=j.useState(null),[T,M]=j.useState(!0),[I]=j.useState("monthly"),[V,O]=j.useState(!1),[U,Y]=j.useState(!0),{toast:z}=e(),F=g(),D=[{id:"free",name:"FREE LISTING",price:0,description:"5 Properties/Products - Basic listing",icon:h.jsx(d,{className:"w-8 h-8 text-gray-600"}),features:["5 Property listings","Basic property details","Standard visibility","Email support"]},{id:"basic",name:"BASIC PLAN",price:199,description:"10 Properties + Top Rated + Verified Owner Badge",icon:h.jsx(o,{className:"w-8 h-8 text-green-600"}),recommended:!0,features:["10 Property listings","Top Rated in Website","Verified Owner Badge","Priority email support","Enhanced visibility"]},{id:"standard",name:"STANDARD PLAN",price:499,description:"15 Properties + Benefits + 1 Poster with 6 leads",icon:h.jsx(v,{className:"w-8 h-8 text-blue-600"}),features:["15 Property listings","Top Rated in Website","Verified Owner Badge","1 Poster with 6 leads","Priority support","Enhanced marketing"]},{id:"premium",name:"PREMIUM PLAN",price:1999,description:"Unlimited Properties + 4 Posters with 20 leads",icon:h.jsx(N,{className:"w-8 h-8 text-purple-600"}),features:["Unlimited Property listings","Top Rated in Website","Verified Owner Badge","4 Posters with 20 leads","Priority phone & email support","Advanced analytics","Featured listings"]},{id:"enterprise",name:"ENTERPRISE PLAN",price:4999,description:"Unlimited + Videos + 30+ leads + Marketing Manager",icon:h.jsx(N,{className:"w-8 h-8 text-gold-600"}),features:["Unlimited Property listings","Top Rated in Website","Verified Owner Badge","4 Posters & 1 Video with 30+ leads","Consultation with Marketing Manager","Commission based revenue","24/7 dedicated support","Custom branding & API access"]}];j.useEffect(()=>{G(),W()},[]);const W=async()=>{try{M(!0);const e=await fetch("https://api.buildhomemartsquares.com/api/vendors/subscription-status",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(e.ok){const s=await e.json();s.success&&s.data.hasActiveSubscription&&B(s.data.subscription)}}catch(e){}finally{M(!1)}},q=(e,s)=>{const t={className:"w-6 h-6"};switch(e){case"photography":return"video"===s?h.jsx(w,{...t}):h.jsx(P,{...t});case"marketing":return"search"===s?h.jsx(u,{...t}):h.jsx(y,{...t});case"technology":return h.jsx(v,{...t});case"support":return h.jsx(x,{...t});case"crm":return h.jsx(m,{...t});default:return h.jsx(d,{...t})}},G=async()=>{try{Y(!0);const e=await b.getAddons();R(e.filter(e=>e.isActive))}catch(e){z({title:"Failed to load addons",description:"Using default addon services",variant:"destructive"})}finally{Y(!1)}},Q=e=>0===e.price?"free"===e.id?"FREE":"Contact Us":`â‚¹${e.price.toLocaleString()}`,Z=()=>C?C.price+E.reduce((e,s)=>e+s.price,0):0,H=async()=>{if(C){O(!0);try{const s={planId:C.id,addons:E.map(e=>e._id),billingCycle:"monthly",totalAmount:Z()},{paymentService:t}=await p(async()=>{const{paymentService:e}=await import("./paymentService-BjbjsdCg.js");return{paymentService:e}},__vite__mapDeps([0,1,2,3,4])),a=await t.processSubscriptionPayment(s);if(!a.success)throw new Error(a.message||"Payment failed");z({title:"Payment Successful!",description:`Successfully subscribed to ${C.name}${E.length>0?` with ${E.length} addon(s)`:""}`});try{const{vendorService:e}=await p(async()=>{const{vendorService:e}=await import("./vendorService-BBU9_Mqe.js");return{vendorService:e}},__vite__mapDeps([5,1,2,3,4,6]));await e.refreshSubscriptionData()}catch(e){}F("/vendor/subscription-manager")}catch(s){z({title:"Payment Failed",description:s instanceof Error?s.message:"Failed to process payment",variant:"destructive"})}finally{O(!1)}}};return h.jsxs("div",{className:"space-y-8",children:[h.jsx("div",{className:"flex items-center justify-center mb-8",children:[{step:1,label:"Choose Plan"},{step:2,label:"Add Services"},{step:3,label:"Payment"}].map(({step:e,label:s},t)=>h.jsxs("div",{className:"flex items-center",children:[h.jsxs("div",{className:"flex flex-col items-center",children:[h.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium "+(e<=S?"bg-blue-600 text-white":"bg-muted text-muted-foreground"),children:e}),h.jsx("span",{className:"text-xs mt-2 "+(e<=S?"text-blue-600 font-medium":"text-muted-foreground"),children:s})]}),t<2&&h.jsx("div",{className:"w-16 h-0.5 mx-4 mt-2 "+(e<S?"bg-blue-600":"bg-border")})]},e))}),1===S&&h.jsxs("div",{className:"space-y-8",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("h1",{className:"text-3xl font-bold text-foreground mb-4",children:$?"Upgrade Your Subscription Plan":"Choose Your Subscription Plan"}),h.jsx("p",{className:"text-muted-foreground text-lg mb-8",children:$?`You currently have the ${$.planName}. Select a higher plan to upgrade.`:"Select the plan that best fits your business needs"}),h.jsx("div",{className:"text-center mb-8",children:h.jsx(a,{variant:"outline",className:"px-4 py-2 text-sm",children:"Monthly Billing - No Long-term Commitments"})})]}),h.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[D.filter(e=>{if("free"===e.id)return!1;if($){const s=$.planName?.toLowerCase();return!s?.includes(e.name.toLowerCase())}return!0}).map(e=>{const s=$&&$.planName?.toLowerCase().includes(e.name.toLowerCase());return h.jsxs(r,{className:`relative cursor-pointer transition-all duration-200 hover:shadow-lg border-2 ${C?.id===e.id?"border-blue-600 shadow-lg bg-blue-50/50":"border-border hover:border-blue-300"} ${e.recommended?"border-yellow-400":""} ${s?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!s&&(e=>{A(e)})(e),children:[e.recommended&&h.jsx(a,{className:"absolute -top-3 left-1/2 transform -translate-x-1/2 bg-yellow-600 hover:bg-yellow-600",children:"Most Popular"}),s&&h.jsx(a,{className:"absolute -top-3 right-4 bg-green-600 hover:bg-green-600",children:"Current Plan"}),h.jsxs(i,{className:"text-center pb-6",children:[h.jsx("div",{className:"flex justify-center mb-4",children:e.icon}),h.jsx(n,{className:"text-2xl font-bold",children:e.name}),h.jsxs("div",{className:"text-4xl font-bold text-blue-600 mt-4",children:[Q(e),e.price>0&&h.jsx("span",{className:"text-lg text-muted-foreground font-normal",children:"/month"})]}),h.jsx("p",{className:"text-muted-foreground mt-2",children:e.description})]}),h.jsx(l,{children:h.jsx("ul",{className:"space-y-4",children:e.features.map((e,s)=>{const t="string"==typeof e?e:e.name;return h.jsxs("li",{className:"flex items-center",children:[h.jsx(c,{className:"w-5 h-5 text-green-600 mr-3 flex-shrink-0"}),h.jsx("span",{className:"text-sm text-foreground",children:t})]},s)})})})]},e.id)}),$&&0===D.filter(e=>{if("free"===e.id)return!1;const s=$.planName?.toLowerCase();return!s?.includes(e.name.toLowerCase())}).length&&h.jsxs("div",{className:"col-span-full text-center py-12",children:[h.jsx(N,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),h.jsx("h3",{className:"text-2xl font-bold mb-2",children:"You're on the highest plan!"}),h.jsx("p",{className:"text-gray-600 mb-6",children:"You currently have the best subscription plan available."}),h.jsx(s,{variant:"outline",onClick:()=>F("/vendor/subscription-manager"),children:"Manage Current Plan"})]})]})]}),2===S&&h.jsxs("div",{className:"space-y-8",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("h1",{className:"text-3xl font-bold text-foreground mb-4",children:"Enhance Your Plan"}),h.jsx("p",{className:"text-muted-foreground text-lg mb-8",children:$?.addons?.length>0?`Add more services to boost your property marketing. You currently have ${$.addons.length} addon(s).`:"Add optional services to boost your property marketing"})]}),U?h.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(e=>h.jsxs(r,{className:"h-48 animate-pulse",children:[h.jsxs(i,{children:[h.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),h.jsx("div",{className:"h-6 bg-muted rounded w-1/2"})]}),h.jsxs(l,{children:[h.jsx("div",{className:"h-3 bg-muted rounded w-full mb-2"}),h.jsx("div",{className:"h-3 bg-muted rounded w-2/3"})]})]},e))}):h.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:L.filter(e=>!$?.addons||!$.addons.some(s=>s._id===e._id)).map(e=>{const s=E.some(s=>s._id===e._id),t=$?.addons?.some(s=>s._id===e._id);return h.jsxs(r,{className:`cursor-pointer transition-all duration-200 hover:shadow-md border-2 ${s?"border-blue-600 bg-blue-50/50 shadow-md":"border-border hover:border-blue-300"} ${t?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!t&&(e=>{k(s=>s.find(s=>s._id===e._id)?s.filter(s=>s._id!==e._id):[...s,e])})(e),children:[h.jsxs(i,{className:"pb-3",children:[h.jsxs("div",{className:"flex items-start justify-between",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("div",{className:"p-2 rounded-lg bg-muted",children:q(e.category,e.icon)}),h.jsxs("div",{children:[h.jsx(n,{className:"text-lg font-semibold",children:e.name}),h.jsx(a,{variant:"outline",className:"mt-1 capitalize text-xs",children:e.category})]})]}),t?h.jsx(a,{className:"bg-green-600 hover:bg-green-600 text-white",children:"Purchased"}):s?h.jsx(c,{className:"w-6 h-6 text-blue-600 flex-shrink-0"}):h.jsx(d,{className:"w-6 h-6 text-muted-foreground flex-shrink-0"})]}),h.jsxs("div",{className:"text-2xl font-bold text-blue-600 mt-2",children:["â‚¹",e.price.toLocaleString(),h.jsxs("span",{className:"text-sm text-muted-foreground font-normal",children:["/",e.billingType.replace("_"," ").replace("per property","per listing")]})]})]}),h.jsx(l,{children:h.jsx("p",{className:"text-muted-foreground text-sm leading-relaxed",children:e.description})})]},e._id)})}),!U&&0===L.length&&h.jsx("div",{className:"text-center py-12",children:h.jsxs("div",{className:"text-muted-foreground",children:[h.jsx(d,{className:"w-12 h-12 mx-auto mb-4"}),h.jsx("p",{className:"text-lg",children:"No addon services available at the moment."}),h.jsx("p",{className:"text-sm",children:"You can continue without addons or check back later."})]})})]}),3===S&&h.jsxs("div",{className:"space-y-8",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("h1",{className:"text-3xl font-bold text-foreground mb-4",children:"Payment Summary"}),h.jsx("p",{className:"text-muted-foreground text-lg mb-8",children:"Review your selection and complete payment"})]}),h.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[h.jsxs(r,{children:[h.jsx(i,{children:h.jsx(n,{className:"text-xl",children:"Order Summary"})}),h.jsxs(l,{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center justify-between py-4 border-b",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("div",{className:"p-2 rounded-lg bg-blue-100",children:C?.icon}),h.jsxs("div",{children:[h.jsxs("h4",{className:"font-semibold text-lg",children:[C?.name," Plan"]}),h.jsx("p",{className:"text-sm text-muted-foreground",children:"Billed monthly"})]})]}),h.jsx("div",{className:"text-right",children:h.jsxs("p",{className:"font-bold text-lg",children:["â‚¹",C?.price||0]})})]}),E.length>0&&h.jsxs("div",{className:"space-y-4",children:[h.jsx("h4",{className:"font-semibold text-lg",children:"Add-on Services"}),E.map(e=>h.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-dashed",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("div",{className:"p-1.5 rounded bg-muted",children:q(e.category,e.icon)}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium",children:e.name}),h.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:e.billingType.replace("_"," ")})]})]}),h.jsxs("p",{className:"font-semibold",children:["â‚¹",e.price.toLocaleString()]})]},e._id))]}),h.jsxs("div",{className:"flex items-center justify-between py-4 border-t-2 border-border",children:[h.jsx("span",{className:"text-xl font-bold",children:"Total Amount"}),h.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:["â‚¹",Z().toLocaleString()]})]})]})]}),h.jsxs("div",{className:"text-center space-y-4",children:[h.jsx(s,{size:"lg",onClick:H,disabled:V,className:"min-w-[250px] h-12 text-lg",children:V?"Processing...":`Pay â‚¹${Z().toLocaleString()}`}),h.jsx("p",{className:"text-sm text-muted-foreground",children:"ðŸ”’ Secure payment powered by Razorpay"})]})]})]}),h.jsxs("div",{className:"flex justify-between pt-8",children:[h.jsxs(s,{variant:"outline",onClick:()=>{_(e=>Math.max(e-1,1))},disabled:1===S,className:"flex items-center space-x-2",size:"lg",children:[h.jsx(t,{className:"w-4 h-4"}),h.jsx("span",{children:"Previous"})]}),S<3&&h.jsxs(s,{onClick:()=>{if(1!==S||C)return 1===S&&0===C?.price?(z({title:"Enterprise Plan Selected",description:"Our team will contact you within 24 hours to discuss your requirements"}),void F("/contact")):void _(e=>Math.min(e+1,3));z({title:"Please select a plan",description:"You must select a subscription plan to continue",variant:"destructive"})},className:"flex items-center space-x-2",size:"lg",children:[h.jsx("span",{children:"Next"}),h.jsx(f,{className:"w-4 h-4"})]})]})]})};export{S as default};
