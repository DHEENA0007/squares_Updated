import{j as e}from"./ui-s1SEoZIF.js";import{e as s,d as t,r as a,L as r}from"./router-D8v2YSKU.js";import{bP as i,aN as l,t as n,aQ as c,bE as o,f as d,A as m,k as x,a1 as p,bO as h,B as u,Q as j,a as f,e as N,b as g,c as y,aL as v,aM as b,aK as w,x as k,g as S,y as C,am as F,E as P}from"./index-DvBXyKtT.js";import{g as $,a as T}from"./propertyUtils-41DuwCMc.js";import{f as L}from"./favoriteService-BpBBvlp_.js";import{vendorService as A}from"./vendorService--N0j1E2K.js";import{P as E,a as _}from"./PropertyContactDialog-Droa4NNB.js";import{E as D}from"./EnterprisePropertyContactDialog-yHtEGUM9.js";import{S as q}from"./share-2-DSSF0p3O.js";import{E as z}from"./external-link-BTu_sqwM.js";import"./vendor-BxThA0WO.js";import"./reviewsService-C63_b63b.js";import"./messageService-BAJa4yjz.js";import"./uploadService-C_cH8Ofp.js";import"./send-DHhY3ZQe.js";import"./indian-rupee-CBNa_Qcv.js";const I=()=>{const{id:I}=s(),M=t(),{isConnected:O}=i(),[B,U]=a.useState(null),[Q,V]=a.useState(!0),[J,K]=a.useState(!1),[R,W]=a.useState(!1),[Y,G]=a.useState(0),[H,X]=a.useState(!1),[Z,ee]=a.useState(!1),[se,te]=a.useState(!1),[ae,re]=a.useState(!1),[ie,le]=a.useState(null),[ne,ce]=a.useState(!1),oe=a.useCallback(async()=>{if(I)try{V(!0);const s=await l.getProperty(I);if(s.success){U(s.data.property);const t=await L.isFavorite(I);if(K(t),s.data.property.vendor?._id||s.data.property.owner?._id)try{ce(!0);const e=s.data.property.vendor?._id||s.data.property.owner?._id,t=await A.isVendorEnterpriseProperty(e);re(t.isEnterprise),le(t.whatsappNumber)}catch(e){re(!1),le(null)}finally{ce(!1)}}else n({title:"Error",description:"Property not found",variant:"destructive"}),M("/customer/search")}catch(e){n({title:"Error",description:"Failed to load property details",variant:"destructive"}),M("/customer/search")}finally{V(!1)}},[I,M]);a.useEffect(()=>{oe()},[oe]),c("property_updated",a.useCallback(e=>{e.propertyId===I&&oe()},[I,oe])),c("property_favorited",a.useCallback(e=>{e.propertyId===I&&K("add"===e.action)},[I]));const de=async()=>{if(B)try{W(!0),J?(await L.removeFromFavorites(B._id),K(!1),n({title:"Removed from favorites",description:"Property has been removed from your favorites"})):(await L.addToFavorites(B._id),K(!0),n({title:"Added to favorites",description:"Property has been added to your favorites"}))}catch(e){n({title:"Error",description:"Failed to update favorites",variant:"destructive"})}finally{W(!1)}},me=async()=>{const e=`${window.location.origin}/v3/property/${I}`;if(navigator.share&&B)try{await navigator.share({title:B.title,text:`Check out this property: ${B.title}`,url:e})}catch(s){navigator.clipboard.writeText(e),n({title:"Link copied",description:"Property link has been copied to clipboard"})}else navigator.clipboard.writeText(e),n({title:"Link copied",description:"Property link has been copied to clipboard"})},xe=e=>{if(!e)return"N/A";if("object"==typeof e){if(e.builtUp)return`${e.builtUp} ${e.unit||"sq ft"}`;if(e.plot)return`${e.plot} ${e.unit||"sq ft"}`;if(e.carpet)return`${e.carpet} ${e.unit||"sq ft"}`}return"number"==typeof e?`${e} sq ft`:"N/A"},pe=e=>!!e&&("object"==typeof e?!!(e.builtUp||e.plot||e.carpet):"number"==typeof e&&e>0),he=e=>{const s=e.area;let t=0;return"object"==typeof s&&null!==s?t=s.builtUp||s.carpet||s.plot||0:"number"==typeof s&&(t=s),0===t?0:Math.round(e.price/t)};return Q?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading property details..."})]})}):B?e.jsxs("div",{className:"min-h-screen bg-background pt-20 pb-8",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>M(-1),children:e.jsx(m,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:B.title}),e.jsxs("div",{className:"flex items-center text-muted-foreground mt-1",children:[e.jsx(x,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"text-sm",children:(e=>{const s=e.address;if("string"==typeof s)return s;const t=[];return s.street&&t.push(s.street),s.locationName&&t.push(s.locationName),s.city&&t.push(s.city),s.district&&t.push(s.district),s.state&&t.push(s.state),s.pincode&&t.push(s.pincode),t.join(", ")})(B)})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{variant:"outline",onClick:de,disabled:R,children:[e.jsx(p,{className:"w-4 h-4 mr-2 "+(J?"fill-red-500 text-red-500":"")}),J?"Favorited":"Add to Favorites"]}),e.jsxs(d,{variant:"outline",onClick:me,children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Share"]}),e.jsxs(d,{onClick:()=>{const e=[B._id];M(`/customer/compare?properties=${e.join(",")}`)},children:[e.jsx(h,{className:"w-4 h-4 mr-2"}),"Compare"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{className:`${(e=>{switch(e.toLowerCase()){case"available":return"bg-green-600";case"sold":return"bg-red-600";case"rented":return"bg-blue-600";case"pending":return"bg-yellow-600";default:return"bg-gray-600"}})(B.status)} text-white`,children:B.status}),B.featured&&e.jsxs(u,{variant:"secondary",children:[e.jsx(j,{className:"w-3 h-3 mr-1"}),"Featured"]}),B.verified&&e.jsx(u,{className:"bg-green-600 text-white",children:"Verified"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-primary",children:(ue=B.price,je=B.listingType,"rent"===je?`₹${ue.toLocaleString("en-IN")}/month`:"lease"===je?`₹${ue.toLocaleString("en-IN")}/year`:ue>=1e7?`₹${(ue/1e7).toFixed(1)} Cr`:ue>=1e5?`₹${(ue/1e5).toFixed(1)} Lac`:`₹${ue.toLocaleString("en-IN")}`)}),he(B)>0&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["₹",he(B),"/sq ft"]})]})]}),B.images&&B.images.length>0&&e.jsx(f,{children:e.jsxs(N,{className:"p-0",children:[e.jsx("div",{className:"aspect-video bg-muted rounded-lg overflow-hidden",children:e.jsx("img",{src:"string"==typeof B.images[Y]?B.images[Y]:B.images[Y].url,alt:B.title,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.src="/placeholder-property.jpg"}})}),B.images.length>1&&e.jsx("div",{className:"flex gap-2 p-4 overflow-x-auto",children:B.images.map((s,t)=>e.jsx("button",{onClick:()=>G(t),className:"flex-shrink-0 w-20 h-16 rounded-lg overflow-hidden border-2 "+(t===Y?"border-primary":"border-transparent"),children:e.jsx("img",{src:"string"==typeof s?s:s.url,alt:`Property image ${t+1}`,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.src="/placeholder-property.jpg"}})},t))})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(f,{children:[e.jsx(g,{children:e.jsxs(y,{className:"flex items-center",children:[e.jsx(o,{className:"w-5 h-5 mr-2"}),"Property Overview"]})}),e.jsxs(N,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[B.bedrooms&&B.bedrooms>0&&e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx(v,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-2xl font-bold",children:B.bedrooms}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bedrooms"})]}),B.bathrooms&&B.bathrooms>0&&e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx(b,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-2xl font-bold",children:B.bathrooms}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bathrooms"})]}),pe(B.area)&&e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx(w,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-2xl font-bold",children:xe(B.area).split(" ")[0]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sq Ft"})]}),B.type&&e.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-4 bg-muted rounded-lg",children:[e.jsx(o,{className:"w-6 h-6 mb-2 text-primary"}),e.jsx("p",{className:"text-2xl font-bold capitalize",children:B.type}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Type"})]})]}),B.description&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-muted-foreground leading-relaxed",children:B.description})]})]})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(y,{children:"Property Details"})}),e.jsx(N,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[B.type&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Property Type:"}),e.jsx("span",{className:"font-medium capitalize",children:B.type})]}),B.listingType&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Listing Type:"}),e.jsx("span",{className:"font-medium capitalize",children:B.listingType})]}),B.bedrooms&&B.bedrooms>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Bedrooms:"}),e.jsx("span",{className:"font-medium",children:B.bedrooms})]}),B.bathrooms&&B.bathrooms>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Bathrooms:"}),e.jsx("span",{className:"font-medium",children:B.bathrooms})]}),B.floor&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Floor:"}),e.jsx("span",{className:"font-medium",children:B.floor})]}),B.totalFloors&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Floors:"}),e.jsx("span",{className:"font-medium",children:B.totalFloors})]}),B.furnishing&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Furnishing:"}),e.jsx("span",{className:"font-medium capitalize",children:B.furnishing.replace("-"," ")})]})]}),e.jsxs("div",{className:"space-y-3",children:[pe(B.area)&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Area:"}),e.jsx("span",{className:"font-medium",children:xe(B.area)})]}),B.status&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx("span",{className:"font-medium capitalize",children:B.status})]}),B.facing&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Facing:"}),e.jsx("span",{className:"font-medium capitalize",children:B.facing})]}),B.parkingSpaces&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Parking:"}),e.jsx("span",{className:"font-medium",children:B.parkingSpaces})]}),B.age&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Age:"}),e.jsxs("span",{className:"font-medium",children:[B.age," years"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Listed On:"}),e.jsx("span",{className:"font-medium",children:new Date(B.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Property ID:"}),e.jsx("span",{className:"font-medium text-xs break-all text-right",children:B._id})]})]})]})})]}),B.amenities&&B.amenities.length>0&&e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(y,{children:"Amenities"})}),e.jsx(N,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:B.amenities.map((s,t)=>e.jsxs("div",{className:"flex items-center p-3 bg-muted rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mr-3"}),e.jsx("span",{className:"text-sm",children:s})]},t))})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(f,{children:[e.jsx(g,{children:e.jsxs(y,{className:"flex items-center",children:[e.jsx(k,{className:"w-5 h-5 mr-2"}),"Contact Information"]})}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-medium",children:$(B.owner)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:T(B)})]}),e.jsx(S,{}),e.jsxs("div",{className:"space-y-3",children:[!ne&&!ae&&e.jsxs(e.Fragment,{children:[e.jsxs(d,{className:"w-full",onClick:()=>ee(!0),children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Call Owner"]}),e.jsxs(d,{variant:"outline",className:"w-full",onClick:()=>X(!0),children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Send Message"]})]}),!ne&&ae&&e.jsxs(d,{className:"w-full bg-green-600 hover:bg-green-700 text-white",onClick:()=>te(!0),children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"WhatsApp Contact"]}),ne&&e.jsxs(d,{disabled:!0,className:"w-full",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Loading..."]})]})]})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsxs(y,{className:"flex items-center",children:[e.jsx(P,{className:"w-5 h-5 mr-2"}),"Property Stats"]})}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Views"}),e.jsx("span",{className:"font-semibold",children:B.views||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Listed"}),e.jsxs("span",{className:"font-semibold",children:[Math.floor((Date.now()-new Date(B.createdAt).getTime())/864e5)," days ago"]})]})]})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(y,{children:"Quick Actions"})}),e.jsxs(N,{className:"space-y-3",children:[B.virtualTour&&e.jsxs(d,{variant:"outline",className:"w-full justify-start",onClick:()=>window.open(B.virtualTour,"_blank"),children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Virtual Tour"]}),e.jsxs(d,{variant:"outline",className:"w-full justify-start",onClick:de,disabled:R,children:[e.jsx(p,{className:"w-4 h-4 mr-2 "+(J?"fill-red-500 text-red-500":"")}),J?"Remove from Favorites":"Add to Favorites"]}),e.jsxs(d,{variant:"outline",className:"w-full justify-start",onClick:()=>{const e=[B._id];M(`/customer/compare?properties=${e.join(",")}`)},children:[e.jsx(h,{className:"w-4 h-4 mr-2"}),"Compare Property"]}),e.jsxs(d,{variant:"outline",className:"w-full justify-start",onClick:me,children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Share Property"]})]})]})]})]})]}),e.jsx(E,{open:H,onOpenChange:X,property:B,onMessageSent:()=>{n({title:"Message sent",description:"Your inquiry has been sent to the property owner"})}}),e.jsx(_,{open:Z,onOpenChange:ee,property:B}),e.jsx(D,{open:se,onOpenChange:te,property:B,whatsappNumber:ie})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(o,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Property Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"The property you're looking for doesn't exist."}),e.jsx(r,{to:"/customer/search",children:e.jsxs(d,{children:[e.jsx(m,{className:"w-4 h-4 mr-2"}),"Back to Search"]})})]})});var ue,je};export{I as default};
