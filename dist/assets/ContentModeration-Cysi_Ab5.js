import{j as e}from"./ui-BHyUY8Z8.js";import{r as a}from"./router-2SVJvIbS.js";import{G as V,W as q,aC as G,Y as H,I as J,$ as P,a0 as U,a1 as u,am as K,a as R,e as D,b as Q,c as W,B as j,d as X,z as S,f as c,E as Y,C as Z,Z as ee,J as k,K as T,O as A,Q as B,R as E,q as se,ap as te,a9 as ae,at as re}from"./index-Bd1eLXM_.js";import{I as ne}from"./image-D3HrDOW5.js";import"./vendor-Dazix4UH.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g=V("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]),me=()=>{const[m,I]=a.useState([]),[O,v]=a.useState(!0),[p,$]=a.useState(""),[r,F]=a.useState("pending"),[t,d]=a.useState(null),[_,N]=a.useState(!1),[z,l]=a.useState(!1),[n,f]=a.useState("approve"),[b,x]=a.useState(""),[o,y]=a.useState({}),{toast:i}=q();a.useEffect(()=>{h()},[r,p]);const h=async()=>{try{v(!0);const s=await fetch(`/api/subadmin/content/reports?status=${r}&search=${p}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(s.ok){const C=await s.json();I(C.data.reports)}else i({title:"Error",description:"Failed to fetch content reports",variant:"destructive"})}catch{i({title:"Error",description:"Error fetching content reports",variant:"destructive"})}finally{v(!1)}};G("content_reported",s=>{i({title:"New Report",description:"New content has been reported for moderation"}),r==="pending"&&h()});const L=async()=>{if(t)try{y({...o,[t._id]:!0});const s=n==="approve"?"resolve":"dismiss";(await fetch(`/api/subadmin/content/reports/${t._id}/${s}`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({note:b})})).ok?(i({title:"Success",description:`Report ${n==="approve"?"resolved":"dismissed"} successfully`}),l(!1),x(""),d(null),h()):i({title:"Error",description:"Failed to process report",variant:"destructive"})}catch{i({title:"Error",description:"Failed to process report",variant:"destructive"})}finally{y({...o,[t._id]:!1})}},M=s=>{switch(s){case"property":return e.jsx(ne,{className:"h-4 w-4"});case"review":return e.jsx(re,{className:"h-4 w-4"});case"message":return e.jsx(ae,{className:"h-4 w-4"});case"user":return e.jsx(S,{className:"h-4 w-4"});default:return e.jsx(g,{className:"h-4 w-4"})}},w=s=>{switch(s){case"property":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"review":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"message":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200";case"user":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}};return O&&m.length===0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Content Moderation"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Review and moderate reported content"})]}),e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-32 bg-gray-200 rounded-lg"},s))})]}):e.jsxs("div",{className:"p-6 space-y-6 mt-16",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Content Moderation"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Review and moderate reported content"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(J,{placeholder:"Search reports...",value:p,onChange:s=>$(s.target.value),className:"pl-10"})]}),e.jsxs(P,{value:r,onValueChange:F,children:[e.jsxs(U,{children:[e.jsx(u,{value:"pending",children:"Pending"}),e.jsx(u,{value:"resolved",children:"Resolved"}),e.jsx(u,{value:"dismissed",children:"Dismissed"})]}),e.jsx(K,{value:r,className:"space-y-4 mt-6",children:m.length===0?e.jsx(R,{children:e.jsxs(D,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(g,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"No Reports Found"}),e.jsx("p",{className:"text-muted-foreground text-center",children:r==="pending"?"All reports have been reviewed. Great job!":`No ${r} reports to display`})]})}):m.map(s=>e.jsxs(R,{className:"border-l-4 border-l-orange-500",children:[e.jsx(Q,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"text-lg",children:"Content Report"}),e.jsx(j,{className:w(s.type),children:e.jsxs("span",{className:"flex items-center gap-1",children:[M(s.type),s.type.charAt(0).toUpperCase()+s.type.slice(1)]})})]}),e.jsxs(X,{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(S,{className:"h-3 w-3"}),"Reported by: ",s.reportedBy.name]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(g,{className:"h-3 w-3"}),"Reason: ",s.reason]})]}),e.jsx("p",{className:"text-sm mt-2",children:s.description})]})]}),e.jsx("div",{className:"text-right ml-4",children:e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(s.createdAt).toLocaleDateString()})})]})}),e.jsx(D,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>{d(s),N(!0)},children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"View Details"]}),r==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(c,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>{d(s),f("approve"),l(!0)},disabled:o[s._id],children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Resolve"]}),e.jsxs(c,{variant:"secondary",size:"sm",onClick:()=>{d(s),f("dismiss"),l(!0)},disabled:o[s._id],children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Dismiss"]})]})]})})]},s._id))})]}),e.jsx(k,{open:_,onOpenChange:N,children:e.jsxs(T,{className:"max-w-3xl",children:[e.jsxs(A,{children:[e.jsx(B,{children:"Content Report Details"}),e.jsx(E,{children:"Detailed information about the reported content"})]}),t&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Report Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Type"}),e.jsx(j,{className:w(t.type),children:t.type})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Status"}),e.jsx(j,{children:t.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Reported By"}),e.jsx("p",{children:t.reportedBy.name}),e.jsx("p",{className:"text-xs",children:t.reportedBy.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Date"}),e.jsx("p",{children:new Date(t.createdAt).toLocaleString()})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Reason"}),e.jsx("p",{className:"text-sm",children:t.reason})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-sm",children:t.description})]}),t.content&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Reported Content"}),e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[t.content.title&&e.jsx("p",{className:"font-medium",children:t.content.title}),t.content.description&&e.jsx("p",{className:"text-sm mt-2",children:t.content.description}),t.content.text&&e.jsx("p",{className:"text-sm mt-2",children:t.content.text})]})]})]})]})}),e.jsx(k,{open:z,onOpenChange:l,children:e.jsxs(T,{children:[e.jsxs(A,{children:[e.jsx(B,{children:n==="approve"?"Resolve Report":"Dismiss Report"}),e.jsx(E,{children:n==="approve"?"Add a note about the resolution (optional)":"Add a note about why this report is being dismissed (optional)"})]}),e.jsx(se,{placeholder:"Add a note...",value:b,onChange:s=>x(s.target.value),rows:4}),e.jsxs(te,{children:[e.jsx(c,{variant:"outline",onClick:()=>{l(!1),x("")},children:"Cancel"}),e.jsx(c,{onClick:L,disabled:o[t?._id||""],className:n==="approve"?"bg-green-600 hover:bg-green-700":"",children:n==="approve"?"Resolve":"Dismiss"})]})]})})]})};export{me as default};
