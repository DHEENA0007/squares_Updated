import{j as e}from"./ui-BNZSgpjP.js";import{bY as s,u as r,E as t,a1 as a,am as i,J as o,bZ as n,aO as l,f as d,al as c,$ as m,a as x,e as h,b as u,c as p,d as g,B as f,k as v}from"./index-DNDw84E8.js";import{d as j,r as b,L as N}from"./router-D8v2YSKU.js";import{c as w}from"./customerDashboardService-mhiGhnpT.js";import{T as y}from"./trending-up-DytUkH_w.js";import{A as k}from"./arrow-right-D2VJ2GOL.js";import"./vendor-BxThA0WO.js";const C=()=>{const{isConnected:C,lastEvent:S}=s(),{user:P}=r(),q=j(),[F,M]=b.useState(!0),[A,V]=b.useState(!1),[I,z]=b.useState({propertiesViewed:0,propertiesViewedChange:"Loading...",savedFavorites:0,savedFavoritesChange:"Loading...",activeInquiries:0,activeInquiriesChange:"Loading...",myProperties:0,myPropertiesChange:"Loading..."}),[E,L]=b.useState([]),[T,_]=b.useState([]),[R,B]=b.useState({favoritesCount:0,messagesCount:0,propertiesCount:0,unreadMessages:0}),D=[{title:"Properties Viewed",value:I.propertiesViewed.toString(),change:I.propertiesViewedChange,icon:t,color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-100 dark:bg-blue-900/20",link:"/customer/search"},{title:"Saved Favorites",value:I.savedFavorites.toString(),change:I.savedFavoritesChange,icon:a,color:"text-red-600 dark:text-red-400",bgColor:"bg-red-100 dark:bg-red-900/20",link:"/customer/favorites"},{title:"Active Inquiries",value:I.activeInquiries.toString(),change:I.activeInquiriesChange,icon:i,color:"text-green-600 dark:text-green-400",bgColor:"bg-green-100 dark:bg-green-900/20",link:"/customer/messages"},{title:"My Properties",value:I.myProperties.toString(),change:I.myPropertiesChange,icon:o,color:"text-orange-600 dark:text-orange-400",bgColor:"bg-orange-100 dark:bg-orange-900/20",link:"/customer/owned-properties"}],$=b.useCallback(async()=>{try{M(!0);const[e,s,r,t]=await Promise.all([w.getCustomerDashboardData(),w.getRecentActivities(),w.getRecommendedProperties(6),w.getQuickStats()]);if(e.success)e.data.stats&&z(e.data.stats),e.data.recentActivities&&L(e.data.recentActivities),e.data.recommendedProperties&&_(e.data.recommendedProperties),e.data.quickStats&&B(e.data.quickStats);else{L(s),_(r),B(t);const e=await w.getCustomerStats();e&&z(e)}}catch(e){}finally{M(!1)}},[]),H=b.useCallback(async()=>{V(!0),await $(),V(!1)},[$]);b.useEffect(()=>{$()},[$]);const Y=b.useCallback(()=>{H()},[H]),W=b.useCallback(()=>{H()},[H]);n({refreshStats:Y,refreshProperties:W}),l("property_viewed",b.useCallback(e=>{z(e=>({...e,propertiesViewed:e.propertiesViewed+1,propertiesViewedChange:"+1 new view"}))},[])),l("favorite_added",b.useCallback(e=>{z(e=>({...e,savedFavorites:e.savedFavorites+1,savedFavoritesChange:"+1 new favorite"})),B(e=>({...e,favoritesCount:e.favoritesCount+1}))},[])),l("favorite_removed",b.useCallback(e=>{z(e=>({...e,savedFavorites:Math.max(0,e.savedFavorites-1),savedFavoritesChange:"-1 favorite removed"})),B(e=>({...e,favoritesCount:Math.max(0,e.favoritesCount-1)}))},[])),l("property_inquiry",b.useCallback(e=>{z(e=>({...e,activeInquiries:e.activeInquiries+1,activeInquiriesChange:"+1 new inquiry"}))},[])),l("new_message",e=>{B(e=>({...e,messagesCount:e.messagesCount+1,unreadMessages:e.unreadMessages+1}))});const Q=e=>{e.propertyId?q(`/customer/property/${e.propertyId}`):"inquiry"===e.type?q("/customer/messages"):"search"===e.type&&q("/customer/search")};return e.jsxs("div",{className:"space-y-8 animate-fade-in-responsive mt-8 pb-10",children:[e.jsxs("div",{className:"dashboard-header-responsive flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx(N,{to:"/customer/dashboard",children:e.jsxs("h1",{className:"dashboard-title-responsive text-3xl font-bold tracking-tight hover:underline cursor-pointer",children:["Welcome back",P?.profile?.firstName?`, ${P.profile.firstName}`:"","!"]})}),e.jsx("p",{className:"text-body-responsive text-muted-foreground mt-2",children:"Here's what's happening with your property journey today."})]}),e.jsxs("div",{className:"flex flex-row gap-3 w-full md:w-auto",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:H,disabled:A,className:"btn-responsive touch-friendly h-10",children:[e.jsx(c,{className:"w-4 h-4 mr-2 "+(A?"animate-spin":"")}),e.jsx("span",{className:"hidden sm:inline",children:A?"Refreshing...":"Refresh"}),e.jsx("span",{className:"sm:hidden",children:"â†»"})]}),e.jsx(N,{to:"/customer/search",children:e.jsxs(d,{className:"btn-responsive w-full sm:w-auto touch-friendly h-10 shadow-sm hover:shadow-md transition-all",children:[e.jsx(m,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-responsive-sm",children:"Search Properties"})]})})]})]}),F&&e.jsx(x,{className:"border-dashed",children:e.jsx(h,{className:"flex items-center justify-center h-48",children:e.jsxs("div",{className:"flex flex-col items-center gap-3 text-muted-foreground",children:[e.jsx(c,{className:"w-8 h-8 animate-spin text-primary"}),e.jsx("span",{className:"text-lg font-medium",children:"Loading dashboard data..."})]})})}),!F&&e.jsx("div",{className:"grid-dashboard animate-slide-up-responsive gap-6",children:D.map(s=>{const r=s.icon;return e.jsx(N,{to:s.link,children:e.jsxs(x,{className:"stats-card-responsive hover:shadow-lg hover:border-primary/20 transition-all duration-300 group cursor-pointer",children:[e.jsxs(u,{className:"flex flex-row items-center justify-between pb-2 space-y-0",children:[e.jsx(p,{className:"text-sm font-medium text-muted-foreground group-hover:text-foreground transition-colors",children:s.title}),e.jsx("div",{className:`p-2.5 rounded-xl ${s.bgColor} group-hover:scale-110 transition-transform duration-300`,children:e.jsx(r,{className:`w-5 h-5 ${s.color}`})})]}),e.jsxs(h,{children:[e.jsx("div",{className:"text-3xl font-bold tracking-tight",children:s.value}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2 font-medium flex items-center gap-1",children:[s.change.includes("+")?e.jsx(y,{className:"w-3 h-3 text-green-500"}):null,e.jsx("span",{className:s.change.includes("+")?"text-green-600":"",children:s.change})]})]})]})},s.title)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs(x,{className:"lg:col-span-2 shadow-sm hover:shadow-md transition-shadow duration-300 flex flex-col h-[350px]",children:[e.jsx(u,{className:"border-b bg-muted/5 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(p,{className:"text-lg",children:"Recent Activity"}),e.jsx(g,{className:"mt-0.5 text-xs",children:"Your latest interactions"})]}),e.jsx(d,{variant:"ghost",size:"sm",className:"hidden sm:flex h-8 text-xs",onClick:()=>q("/customer/profile"),children:"View All"})]})}),e.jsx(h,{className:"p-0 flex-1 overflow-hidden",children:!F&&E.length>0?e.jsx("div",{className:"divide-y h-full overflow-y-auto",children:E.map(s=>{const r=(t=s.icon,{Heart:a,MessageSquare:i,Search:m,Home:o,Edit:y}[t]||y);var t;return e.jsxs("div",{className:"flex items-start gap-3 p-3 hover:bg-muted/50 transition-colors cursor-pointer group",onClick:()=>Q(s),children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-full mt-0.5 shrink-0 group-hover:bg-primary/20 transition-colors",children:e.jsx(r,{className:"w-3.5 h-3.5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground leading-none mb-1 group-hover:text-primary transition-colors",children:s.message}),s.property&&e.jsx("p",{className:"text-xs text-muted-foreground truncate mb-0.5",children:s.property}),e.jsx("p",{className:"text-[10px] text-muted-foreground/80",children:w.formatTimeAgo(s.time)})]}),e.jsx(d,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-primary shrink-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:e=>{e.stopPropagation(),Q(s)},children:e.jsx(k,{className:"w-3.5 h-3.5"})})]},s._id)})}):F?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(c,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{className:"text-sm",children:"Loading activities..."})]})}):e.jsxs("div",{className:"text-center py-8 px-4 h-full flex flex-col items-center justify-center",children:[e.jsx("div",{className:"bg-muted/30 w-12 h-12 rounded-full flex items-center justify-center mb-3",children:e.jsx(y,{className:"w-6 h-6 text-muted-foreground"})}),e.jsx("h3",{className:"text-sm font-medium text-foreground",children:"No recent activity"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 max-w-xs",children:"Start browsing properties to see your activity here"}),e.jsx(d,{variant:"outline",size:"sm",className:"mt-3 h-8 text-xs",onClick:()=>q("/customer/search"),children:"Browse Properties"})]})})]}),e.jsxs(x,{className:"h-fit shadow-sm hover:shadow-md transition-shadow duration-300",children:[e.jsxs(u,{className:"border-b bg-muted/5 py-4",children:[e.jsx(p,{className:"text-lg",children:"Quick Actions"}),e.jsx(g,{className:"mt-0.5 text-xs",children:"Frequently used features"})]}),e.jsxs(h,{className:"p-4 space-y-3",children:[e.jsx(N,{to:"/customer/favorites",className:"block",children:e.jsxs(d,{variant:"outline",className:"w-full justify-between h-12 hover:border-primary/50 hover:bg-primary/5 group",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-red-100 dark:bg-red-900/20 p-1.5 rounded-md mr-3 group-hover:scale-110 transition-transform",children:e.jsx(a,{className:"w-4 h-4 text-red-600 dark:text-red-400"})}),e.jsx("span",{children:"My Favorites"})]}),e.jsx(f,{variant:"secondary",className:"bg-muted group-hover:bg-background",children:R.favoritesCount})]})}),e.jsx(N,{to:"/customer/messages",className:"block",children:e.jsxs(d,{variant:"outline",className:"w-full justify-between h-12 hover:border-primary/50 hover:bg-primary/5 group",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/20 p-1.5 rounded-md mr-3 group-hover:scale-110 transition-transform",children:e.jsx(i,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),e.jsx("span",{children:"Messages"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[R.unreadMessages>0&&e.jsxs(f,{className:"bg-red-500 text-white hover:bg-red-600",children:[R.unreadMessages," new"]}),e.jsx(f,{variant:"secondary",className:"bg-muted group-hover:bg-background",children:R.messagesCount})]})]})}),e.jsx(N,{to:"/customer/owned-properties",className:"block",children:e.jsxs(d,{variant:"outline",className:"w-full justify-between h-12 hover:border-primary/50 hover:bg-primary/5 group",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-orange-100 dark:bg-orange-900/20 p-1.5 rounded-md mr-3 group-hover:scale-110 transition-transform",children:e.jsx(o,{className:"w-4 h-4 text-orange-600 dark:text-orange-400"})}),e.jsx("span",{children:"My Properties"})]}),e.jsx(f,{variant:"secondary",className:"bg-muted group-hover:bg-background",children:R.propertiesCount})]})})]})]})]}),!F&&e.jsxs(x,{className:"shadow-sm hover:shadow-md transition-shadow duration-300",children:[e.jsx(u,{className:"border-b bg-muted/5",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx(p,{className:"text-xl",children:"Recommended for You"}),e.jsx(g,{className:"mt-1",children:"Properties matching your preferences"})]}),e.jsx(N,{to:"/customer/search",children:e.jsxs(d,{variant:"ghost",className:"group",children:["View All",e.jsx(k,{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform"})]})})]})}),e.jsx(h,{className:"p-6",children:T.length>0?e.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:T.map(s=>e.jsxs(N,{to:`/customer/property/${s._id}`,className:"group bg-card border border-border/60 rounded-xl overflow-hidden hover:shadow-lg transition-all duration-300 flex flex-col sm:flex-row h-auto",children:[e.jsxs("div",{className:"w-full sm:w-56 h-48 sm:h-auto relative shrink-0 bg-muted overflow-hidden",children:[s.image?e.jsx("img",{src:s.image,alt:s.title,className:"absolute top-0 left-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-105",onError:e=>{e.currentTarget.style.display="none",e.currentTarget.parentElement?.classList.add("flex","items-center","justify-center");const s=document.createElement("div");s.innerHTML='<svg class="w-12 h-12 text-muted-foreground/20" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>',e.currentTarget.parentElement?.appendChild(s)}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-muted/50",children:e.jsx(o,{className:"w-12 h-12 text-muted-foreground/20"})}),e.jsx("div",{className:"absolute top-2 right-2 sm:hidden",children:e.jsx(d,{size:"icon",variant:"secondary",className:"rounded-full h-7 w-7 shadow-sm bg-white/90 hover:bg-white text-muted-foreground hover:text-red-500",onClick:e=>{e.preventDefault(),e.stopPropagation()},children:e.jsx(a,{className:"w-3.5 h-3.5"})})})]}),e.jsxs("div",{className:"flex-1 p-3.5 flex flex-col justify-between min-w-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-start gap-3",children:[e.jsxs("div",{className:"space-y-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-base sm:text-lg text-foreground line-clamp-1 group-hover:text-primary transition-colors",children:s.title}),e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[e.jsx(v,{className:"w-3 h-3 mr-1 text-muted-foreground/70 shrink-0"}),e.jsx("span",{className:"truncate",children:s.location})]})]}),e.jsx("div",{className:"text-right shrink-0",children:e.jsx("div",{className:"text-lg font-bold text-primary",children:s.price})})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[e.jsx(f,{variant:"outline",className:"bg-primary/5 text-primary border-primary/20 text-[10px] px-1.5 py-0 h-5",children:"sale"===s.listingType?"Sale":"Rent"}),s.propertyType&&e.jsx(f,{variant:"secondary",className:"bg-muted text-muted-foreground text-[10px] px-1.5 py-0 h-5",children:s.propertyType}),e.jsx(f,{variant:"outline",className:"border-green-200 text-green-700 bg-green-50 text-[10px] px-1.5 py-0 h-5",children:"Verified"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 py-2 border-y border-border/40",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[e.jsx("span",{className:"text-[9px] text-muted-foreground uppercase font-bold",children:"Beds"}),e.jsx("span",{className:"text-xs font-semibold text-foreground",children:s.bedrooms})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center text-center border-l border-border/40",children:[e.jsx("span",{className:"text-[9px] text-muted-foreground uppercase font-bold",children:"Baths"}),e.jsx("span",{className:"text-xs font-semibold text-foreground",children:s.bathrooms})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center text-center border-l border-border/40",children:[e.jsx("span",{className:"text-[9px] text-muted-foreground uppercase font-bold",children:"Area"}),e.jsx("span",{className:"text-xs font-semibold text-foreground",children:s.area})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"flex -space-x-1.5",children:[1,2,3].map(s=>e.jsxs("div",{className:"w-5 h-5 rounded-full border border-background bg-muted flex items-center justify-center text-[8px] font-medium text-muted-foreground",children:["U",s]},s))}),e.jsx("span",{className:"text-[10px] text-muted-foreground font-medium",children:"+12"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{variant:"outline",size:"icon",className:"h-8 w-8 rounded-md border-border hover:bg-muted hover:text-red-500 hidden sm:flex",onClick:e=>{e.preventDefault(),e.stopPropagation()},children:e.jsx(a,{className:"w-4 h-4"})}),e.jsx(d,{className:"h-8 px-3 bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm text-xs font-medium rounded-md",children:"Details"})]})]})]})]},s._id))}):e.jsxs("div",{className:"text-center py-16 bg-muted/10 rounded-xl border border-dashed",children:[e.jsx("div",{className:"bg-muted/30 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(o,{className:"w-10 h-10 text-muted-foreground"})}),e.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"No recommendations yet"}),e.jsx("p",{className:"text-muted-foreground mt-2 max-w-md mx-auto mb-6",children:"We need to know more about your preferences. Start browsing and marking favorites to get personalized recommendations."}),e.jsx(N,{to:"/customer/search",children:e.jsxs(d,{size:"lg",className:"shadow-md hover:shadow-lg transition-all",children:[e.jsx(m,{className:"w-5 h-5 mr-2"}),"Browse Properties"]})})]})})]})]})};export{C as default};
