const e="https://app.buildhomemartsquares.com/api";const a=new class{getAuthHeaders(){const e=localStorage.getItem("token");return e?{Authorization:`Bearer ${e}`}:{}}async uploadSingle(a,t="avatars"){const o=new FormData;o.append("file",a),o.append("folder",t);const n=await fetch(`${e}/upload/single`,{method:"POST",headers:this.getAuthHeaders(),body:o});if(!n.ok){const e=await n.json().catch(()=>({message:"Upload failed"}));throw new Error(e.message||"Failed to upload file")}return await n.json()}async uploadMultiple(a,t="general"){const o=new FormData;a.forEach(e=>o.append("files",e)),o.append("folder",t);const n=await fetch(`${e}/upload/multiple`,{method:"POST",headers:this.getAuthHeaders(),body:o});if(!n.ok){const e=await n.json().catch(()=>({message:"Upload failed"}));throw new Error(e.message||"Failed to upload files")}return await n.json()}async deleteFile(a){const t=await fetch(`${e}/upload/${encodeURIComponent(a)}`,{method:"DELETE",headers:{"Content-Type":"application/json",...this.getAuthHeaders()}});if(!t.ok){const e=await t.json().catch(()=>({message:"Delete failed"}));throw new Error(e.message||"Failed to delete file")}return await t.json()}async uploadAvatar(e){return(await this.uploadSingle(e,"avatars")).data.url}validateImageFile(e){return["image/jpeg","image/jpg","image/png","image/webp"].includes(e.type)?e.size>5242880?{valid:!1,error:"Image size must be less than 5MB"}:{valid:!0}:{valid:!1,error:"Please upload a valid image file (JPEG, PNG, or WebP)"}}async compressImage(e,a=800){return new Promise((t,o)=>{const n=new FileReader;n.readAsDataURL(e),n.onload=n=>{const r=new Image;r.src=n.target?.result,r.onload=()=>{const n=document.createElement("canvas");let s=r.width,i=r.height;s>a&&(i=i*a/s,s=a),n.width=s,n.height=i;const l=n.getContext("2d");l?.drawImage(r,0,0,s,i),n.toBlob(a=>{if(a){const o=new File([a],e.name,{type:"image/jpeg",lastModified:Date.now()});t(o)}else o(new Error("Canvas to Blob conversion failed"))},"image/jpeg",.8)},r.onerror=()=>o(new Error("Image loading failed"))},n.onerror=()=>o(new Error("File reading failed"))})}};export{a as u};
