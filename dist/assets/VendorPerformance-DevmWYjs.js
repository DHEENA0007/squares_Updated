import{j as e,a5 as s,a6 as a}from"./ui-BNZSgpjP.js";import{r as l}from"./router-D8v2YSKU.js";import{an as r,a2 as t,aP as n,aQ as c,a as i,b as d,c as o,p as x,e as m,Q as h,$ as j,I as f,B as p,f as g,E as u,a4 as N,a5 as v,a6 as b,a7 as w,a8 as y}from"./index-Z2ZeqOLK.js";import{T as R,a as S,b as P,c as T,d as $,e as A}from"./table-CpGlDsC8.js";import{T as k}from"./trending-up-DGCFiuLi.js";import"./vendor-BxThA0WO.js";const E=l.forwardRef(({className:l,value:t,...n},c)=>e.jsx(s,{ref:c,className:r("relative h-4 w-full overflow-hidden rounded-full bg-secondary",l),...n,children:e.jsx(a,{className:"h-full w-full flex-1 bg-primary transition-all rounded-full",style:{transform:`translateX(-${100-(t||0)}%)`}})}));E.displayName=s.displayName;const C=()=>{const[s,a]=l.useState([]),[r,C]=l.useState(!0),[D,V]=l.useState(""),[M,z]=l.useState(null),[F,I]=l.useState(!1),[L,B]=l.useState("performanceScore"),[O,Q]=l.useState(null),{toast:G}=t();l.useEffect(()=>{J()},[D,L]);const J=async()=>{try{C(!0);const e=await n(`/subadmin/vendors/performance?search=${D}&sortBy=${L}`),s=(await c(e)).data.vendors||[];a(s),D||Q({totalVendors:s.length,topPerformers:s.filter(e=>e.performanceScore>=80).length,averageRating:s.length>0?s.reduce((e,s)=>e+s.averageRating,0)/s.length:0})}catch(e){G({title:"Error",description:e.message||"Error fetching vendor metrics",variant:"destructive"}),a([])}finally{C(!1)}},X=e=>e>=80?"text-green-600":e>=60?"text-yellow-600":"text-red-600",_=e=>e>=80?{label:"Excellent",variant:"default",class:"bg-green-600"}:e>=60?{label:"Good",variant:"secondary",class:"bg-yellow-600"}:{label:"Needs Improvement",variant:"destructive",class:"bg-red-600"},q=e=>e<60?`${Math.round(e)} mins`:e<1440?`${Math.round(e/60)} hrs`:`${Math.round(e/1440)} days`;return r&&0===s.length?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Vendor Performance"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Track and analyze vendor performance metrics"})]}),e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-40 bg-gray-200 rounded-lg"},s))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Vendor Performance"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Track and analyze vendor performance metrics"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(i,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Total Vendors"}),e.jsx(x,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:O?.totalVendors||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active property vendors"})]})]}),e.jsxs(i,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Top Performers"}),e.jsx(k,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:O?.topPerformers||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Excellent performance (80%+)"})]})]}),e.jsxs(i,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Average Rating"}),e.jsx(h,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:O?.averageRating.toFixed(1)||"0.0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Overall vendor ratings"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(f,{placeholder:"Search vendors by name or email...",value:D,onChange:e=>V(e.target.value),className:"pl-10"})]}),e.jsxs("select",{value:L,onChange:e=>B(e.target.value),className:"px-4 py-2 border rounded-md bg-background w-full sm:w-auto",children:[e.jsx("option",{value:"performanceScore",children:"Sort by Performance"}),e.jsx("option",{value:"totalProperties",children:"Sort by Properties"}),e.jsx("option",{value:"averageRating",children:"Sort by Rating"})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(R,{children:[e.jsx(S,{children:e.jsxs(P,{children:[e.jsx(T,{className:"w-[80px]",children:"Rank"}),e.jsx(T,{children:"Vendor"}),e.jsx(T,{children:"Performance"}),e.jsx(T,{children:"Properties"}),e.jsx(T,{children:"Rating"}),e.jsx(T,{children:"Response"}),e.jsx(T,{className:"text-right",children:"Actions"})]})}),e.jsx($,{children:0===s.length?e.jsx(P,{children:e.jsx(A,{colSpan:7,className:"h-24 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(x,{className:"h-8 w-8 text-muted-foreground mb-2"}),e.jsx("p",{children:"No vendors found"})]})})}):s.map((s,a)=>{const l=_(s.performanceScore);return e.jsxs(P,{children:[e.jsxs(A,{className:"font-medium",children:["#",a+1]}),e.jsx(A,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.email})]})}),e.jsx(A,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`text-lg font-bold ${X(s.performanceScore)}`,children:[s.performanceScore,"%"]}),e.jsx(p,{className:`${l.class} text-white hover:${l.class}`,children:l.label})]})}),e.jsx(A,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-sm",children:[s.activeProperties," / ",s.totalProperties," Active"]}),e.jsx(E,{value:s.totalProperties>0?s.activeProperties/s.totalProperties*100:0,className:"h-1.5 w-[100px]"})]})}),e.jsx(A,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(h,{className:"h-4 w-4 fill-yellow-500 text-yellow-500"}),e.jsx("span",{children:s.averageRating.toFixed(1)}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",s.totalReviews,")"]})]})}),e.jsx(A,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-sm",children:[s.responseRate,"% Rate"]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[q(s.averageResponseTime)," Avg"]})]})}),e.jsx(A,{className:"text-right",children:e.jsxs(g,{variant:"ghost",size:"sm",onClick:()=>{z(s),I(!0)},children:[e.jsx(u,{className:"h-4 w-4 mr-2"}),"Details"]})})]},s._id)})})]})}),e.jsx(N,{open:F,onOpenChange:I,children:e.jsxs(v,{className:"max-w-3xl mx-4 sm:mx-auto max-h-[85vh] overflow-y-auto",children:[e.jsxs(b,{children:[e.jsxs(w,{className:"text-lg sm:text-xl",children:[M?.name," - Performance Details"]}),e.jsx(y,{className:"text-sm",children:"Comprehensive performance metrics and statistics"})]}),M&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Contact Information"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Email:"})," ",e.jsx("span",{className:"break-words",children:M.email})]}),M.phone&&e.jsxs("li",{children:[e.jsx("strong",{children:"Phone:"})," ",M.phone]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Joined:"})," ",new Date(M.joinedDate).toLocaleDateString()]}),M.lastActive&&e.jsxs("li",{children:[e.jsx("strong",{children:"Last Active:"})," ",new Date(M.lastActive).toLocaleDateString()]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Performance Score"}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-3xl sm:text-5xl font-bold ${X(M.performanceScore)}`,children:[M.performanceScore,"%"]}),e.jsx(p,{className:`mt-2 ${_(M.performanceScore).class}`,children:_(M.performanceScore).label})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Property Statistics"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-muted p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:M.totalProperties}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total"})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-950 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-green-600",children:M.activeProperties}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active"})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-950 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-red-600",children:M.rejectedProperties}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Rejected"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Customer Engagement"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-sm",children:"Average Rating"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 fill-yellow-500 text-yellow-500 flex-shrink-0"}),e.jsxs("span",{className:"font-semibold",children:[M.averageRating.toFixed(1)," / 5.0"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-sm",children:"Total Reviews"}),e.jsx("span",{className:"font-semibold",children:M.totalReviews})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-sm",children:"Total Messages"}),e.jsx("span",{className:"font-semibold",children:M.totalMessages})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-sm",children:"Response Rate"}),e.jsxs("span",{className:"font-semibold",children:[M.responseRate,"%"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-sm",children:"Average Response Time"}),e.jsx("span",{className:"font-semibold",children:q(M.averageResponseTime)})]})]})]})]})]})})]})};export{C as default};
