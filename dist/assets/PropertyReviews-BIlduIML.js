import{j as e}from"./ui-BNZSgpjP.js";import{r as s}from"./router-D8v2YSKU.js";import{u as a,a2 as t,aS as r,aT as l,aR as i,a as n,e as c,$ as d,I as o,f as m,aj as x,B as p,L as h,q as j,r as u,s as f,v,w as g,aP as N,C as b,bP as y,bQ as w,aM as C,aN as k,aL as S,E as A,_ as F,a4 as P,a5 as R,a6 as T,a7 as $,a8 as V,T as _,ae as E,k as L,g as z,a3 as D}from"./index-AgUnwITA.js";import{C as I}from"./checkbox-Igk13eF4.js";import{T as O,a as q,b as Q,c as B,d as U,e as M}from"./table-DK1Ni377.js";import{V as W}from"./VirtualTourViewer-D9SuT141.js";import{I as J}from"./indian-rupee-CWKyVbhh.js";import"./vendor-BxThA0WO.js";import"./external-link-B2JJpmpu.js";const G=e=>{if(!e)return y;const s="object"==typeof e?e.url:e;if(!s||"string"!=typeof s)return y;if(s.startsWith("http://")||s.startsWith("https://"))return s;const a=s.startsWith("/api")?s.substring(4):s;return`${"https://app.buildhomemartsquares.com/api".replace("/api","")}${a}`},H=()=>{const{user:H}=a(),[K,X]=s.useState([]),[Y,Z]=s.useState(!0),[ee,se]=s.useState(""),[ae,te]=s.useState(1),[re,le]=s.useState(1),[ie,ne]=s.useState(null),[ce,de]=s.useState(!1),[oe,me]=s.useState(!1),[xe,pe]=s.useState(!1),[he,je]=s.useState(""),[ue,fe]=s.useState({}),{toast:ve}=t(),[ge,Ne]=s.useState("all"),[be,ye]=s.useState("all"),[we,Ce]=s.useState("pending"),[ke,Se]=s.useState(""),[Ae,Fe]=s.useState(""),[Pe,Re]=s.useState(!1),[Te,$e]=s.useState([]),[Ve,_e]=s.useState([]),[Ee,Le]=s.useState([]);s.useEffect(()=>{(async()=>{try{const[e,s,a]=await Promise.all([D.getAllPropertyTypes(),D.getFilterConfigurationsByType("listing_type"),D.getFilterConfigurationsByType("property_status")]);$e(e),_e(s),Le(a)}catch(e){}})()},[]);const ze=()=>H?.profile?.firstName&&H?.profile?.lastName?`${H.profile.firstName} ${H.profile.lastName}`:H?.profile?.firstName?H.profile.firstName:H?.email?H.email:"",[De,Ie]=s.useState(ze()),[Oe,qe]=s.useState({documentsVerified:!1,locationVerified:!1,priceReasonable:!1,imagesQuality:!1,descriptionComplete:!1,ownershipConfirmed:!1}),[Qe,Be]=s.useState("");s.useEffect(()=>{const e=ze();e&&Ie(e)},[H]),s.useEffect(()=>{Ue()},[ae,ee,ge,be,we,ke,Ae]);const Ue=async()=>{try{Z(!0);const e=new URLSearchParams;e.append("page",ae.toString()),ee&&e.append("search",ee),ge&&"all"!==ge&&e.append("type",ge),be&&"all"!==be&&e.append("listingType",be),we&&"all"!==we&&e.append("status",we),ke&&e.append("startDate",ke),Ae&&e.append("endDate",Ae);const s=await r(`/subadmin/properties/pending?${e.toString()}`),a=await l(s);X(a.data.properties||[]),le(a.data.totalPages||1)}catch(e){ve({title:"Error",description:e.message||"Error fetching properties",variant:"destructive"}),X([])}finally{Z(!1)}};i("property_created",e=>{ve({title:"New Property",description:"A new property has been submitted for review"}),Ue()}),i("property_updated",e=>{Ue()});const Me=()=>{qe({documentsVerified:!1,locationVerified:!1,priceReasonable:!1,imagesQuality:!1,descriptionComplete:!1,ownershipConfirmed:!1}),Be(""),Ie(ze()),je("")},We=e=>`â‚¹${e.toLocaleString("en-IN")}`,Je=e=>e.builtUp?`${e.builtUp} ${e.unit}`:e.plot?`${e.plot} ${e.unit}`:e.carpet?`${e.carpet} ${e.unit}`:"N/A";return Y&&0===K.length?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Property Reviews"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Review and approve property listings"})]}),e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-32 bg-gray-200 rounded-lg"},s))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Property Reviews"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Review and approve property listings"})]}),e.jsx(n,{children:e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(o,{placeholder:"Search properties by title or city...",value:ee,onChange:e=>se(e.target.value),className:"pl-10"})]}),e.jsxs(m,{variant:"outline",onClick:()=>Re(!Pe),className:"flex items-center gap-2",children:[e.jsx(x,{className:"h-4 w-4"}),"Filters",("all"!==ge||"all"!==be||"all"!==we||ke||Ae)&&e.jsx(p,{variant:"secondary",className:"ml-1",children:["all"!==ge,"all"!==be,"all"!==we,ke,Ae].filter(Boolean).length})]})]}),Pe&&e.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap gap-3 pt-3 border-t",children:[e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(h,{className:"text-xs text-muted-foreground",children:"Property Type"}),e.jsxs(j,{value:ge,onValueChange:Ne,children:[e.jsx(u,{className:"w-full sm:w-[150px]",children:e.jsx(f,{placeholder:"All Types"})}),e.jsxs(v,{children:[e.jsx(g,{value:"all",children:"All Types"}),Te.map(s=>e.jsx(g,{value:s.value,children:s.name},s._id))]})]})]}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(h,{className:"text-xs text-muted-foreground",children:"Listing Type"}),e.jsxs(j,{value:be,onValueChange:ye,children:[e.jsx(u,{className:"w-full sm:w-[130px]",children:e.jsx(f,{placeholder:"All"})}),e.jsxs(v,{children:[e.jsx(g,{value:"all",children:"All"}),Ve.length>0?Ve.map(s=>e.jsx(g,{value:s.value,children:s.displayLabel||s.name},s._id)):e.jsxs(e.Fragment,{children:[e.jsx(g,{value:"sale",children:"Sale"}),e.jsx(g,{value:"rent",children:"Rent"}),e.jsx(g,{value:"lease",children:"Lease"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(h,{className:"text-xs text-muted-foreground",children:"Status"}),e.jsxs(j,{value:we,onValueChange:Ce,children:[e.jsx(u,{className:"w-full sm:w-[150px]",children:e.jsx(f,{placeholder:"All Statuses"})}),e.jsxs(v,{children:[e.jsx(g,{value:"all",children:"All Statuses"}),e.jsx(g,{value:"pending",children:"Pending"}),e.jsx(g,{value:"available",children:"Approved"}),e.jsx(g,{value:"rejected",children:"Rejected"}),e.jsx(g,{value:"sold",children:"Sold"}),e.jsx(g,{value:"rented",children:"Rented"}),e.jsx(g,{value:"leased",children:"Leased"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(h,{className:"text-xs text-muted-foreground",children:"From Date"}),e.jsx(o,{type:"date",value:ke,onChange:e=>Se(e.target.value),className:"w-full sm:w-[150px]"})]}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(h,{className:"text-xs text-muted-foreground",children:"To Date"}),e.jsx(o,{type:"date",value:Ae,onChange:e=>Fe(e.target.value),className:"w-full sm:w-[150px]"})]}),("all"!==ge||"all"!==be||"all"!==we||ke||Ae)&&e.jsx("div",{className:"flex items-end",children:e.jsxs(m,{variant:"ghost",size:"sm",onClick:()=>{Ne("all"),ye("all"),Ce("pending"),Se(""),Fe("")},className:"text-muted-foreground hover:text-foreground",children:[e.jsx(N,{className:"h-4 w-4 mr-1"}),"Clear Filters"]})})]})]})})}),e.jsx(n,{children:e.jsx(c,{className:"p-0",children:0===K.length?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(b,{className:"h-12 w-12 text-green-500 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"No Pending Properties"}),e.jsx("p",{className:"text-muted-foreground text-center",children:"All properties have been reviewed. Great job!"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(O,{children:[e.jsx(q,{children:e.jsxs(Q,{className:"bg-muted/50",children:[e.jsx(B,{className:"w-[60px] text-center",children:"S.No."}),e.jsx(B,{className:"w-[80px]",children:"Image"}),e.jsx(B,{children:"Property"}),e.jsx(B,{children:"Location"}),e.jsx(B,{className:"text-center",children:"Type"}),e.jsx(B,{className:"text-right",children:"Price"}),e.jsx(B,{children:"Owner"}),e.jsx(B,{className:"text-center",children:"Date"}),e.jsx(B,{className:"text-center w-[200px]",children:"Actions"})]})}),e.jsx(U,{children:K.map((s,a)=>e.jsxs(Q,{className:"hover:bg-muted/30",children:[e.jsx(M,{className:"text-center font-medium",children:10*(ae-1)+a+1}),e.jsx(M,{className:"p-2",children:e.jsx("div",{className:"w-16 h-16 rounded-md overflow-hidden bg-muted flex-shrink-0",children:s.images&&s.images.length>0?e.jsx("img",{src:G(s.images[0]),alt:s.title,className:"w-full h-full object-cover",onError:e=>{e.target.src=y}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(w,{className:"h-6 w-6 text-muted-foreground"})})})}),e.jsx(M,{children:e.jsxs("div",{className:"max-w-[200px]",children:[e.jsx("p",{className:"font-medium text-sm truncate",title:s.title,children:s.title}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[s.bedrooms>0&&e.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-0.5",children:[e.jsx(C,{className:"h-3 w-3"})," ",s.bedrooms]}),s.bathrooms>0&&e.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-0.5 ml-2",children:[e.jsx(k,{className:"h-3 w-3"})," ",s.bathrooms]}),(s.area.builtUp||s.area.plot||s.area.carpet)&&e.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-0.5 ml-2",children:[e.jsx(S,{className:"h-3 w-3"})," ",Je(s.area)]})]})]})}),e.jsx(M,{children:e.jsxs("div",{className:"max-w-[150px]",children:[e.jsx("p",{className:"text-sm truncate",title:`${s.address.city}, ${s.address.state}`,children:s.address.city}),e.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:[s.address.district?`${s.address.district}, `:"",s.address.state]})]})}),e.jsx(M,{className:"text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx(p,{variant:"outline",className:"text-xs capitalize",children:s.type}),e.jsx(p,{variant:"sale"===s.listingType?"default":"secondary",className:"text-xs",children:"sale"===s.listingType?"Sale":"rent"===s.listingType?"Rent":"Lease"})]})}),e.jsx(M,{className:"text-right",children:e.jsx("p",{className:"font-bold text-primary text-sm",children:We(s.price)})}),e.jsx(M,{children:e.jsxs("div",{className:"max-w-[150px]",children:[e.jsx("p",{className:"text-sm font-medium truncate",title:s.owner?.profile?.firstName?`${s.owner.profile.firstName} ${s.owner.profile.lastName||""}`:s.owner.name,children:s.owner?.profile?.firstName?`${s.owner.profile.firstName} ${s.owner.profile.lastName||""}`:s.owner.name||"N/A"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",title:s.owner.email,children:s.owner.email})]})}),e.jsx(M,{className:"text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(s.createdAt).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"2-digit"})})}),e.jsx(M,{children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:()=>{ne(s),pe(!0)},className:"h-8 px-2",title:"View Details",children:e.jsx(A,{className:"h-4 w-4"})}),e.jsx(m,{size:"sm",onClick:()=>(e=>{ne(e),Me(),de(!0)})(s),disabled:ue[s._id],className:"h-8 px-2 bg-green-600 hover:bg-green-700",title:"Approve",children:e.jsx(b,{className:"h-4 w-4"})}),e.jsx(m,{variant:"destructive",size:"sm",onClick:()=>(e=>{ne(e),Me(),me(!0)})(s),disabled:ue[s._id],className:"h-8 px-2",title:"Reject",children:e.jsx(F,{className:"h-4 w-4"})})]})})]},s._id))})]})})})}),K.length>0&&e.jsx(n,{children:e.jsx(c,{className:"py-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",10*(ae-1)+1," to ",Math.min(10*ae,10*(ae-1)+K.length)," of ",10*re," properties"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{variant:"outline",size:"sm",disabled:1===ae,onClick:()=>te(1),children:"First"}),e.jsx(m,{variant:"outline",size:"sm",disabled:1===ae,onClick:()=>te(ae-1),children:"Previous"}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,re)},(s,a)=>{let t;return t=re<=5||ae<=3?a+1:ae>=re-2?re-4+a:ae-2+a,e.jsx(m,{variant:ae===t?"default":"outline",size:"sm",onClick:()=>te(t),className:"w-8 h-8 p-0",children:t},t)})}),e.jsx(m,{variant:"outline",size:"sm",disabled:ae===re,onClick:()=>te(ae+1),children:"Next"}),e.jsx(m,{variant:"outline",size:"sm",disabled:ae===re,onClick:()=>te(re),children:"Last"})]})]})})}),e.jsx(P,{open:ce,onOpenChange:de,children:e.jsxs(R,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(T,{children:[e.jsx($,{children:"Approve Property"}),e.jsxs(V,{children:['Complete the verification checklist and provide your approval for "',ie?.title,'".']})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Approver Name"}),e.jsx("div",{className:"p-3 rounded-md bg-muted border border-border mt-1",children:e.jsx("p",{className:"font-medium text-sm",children:De||"Loading..."})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically set from your logged-in account"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(h,{className:"text-base font-semibold",children:"Verification Checklist"}),e.jsxs("div",{className:"space-y-3 border rounded-lg p-4 bg-muted/30",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{id:"documents-approve",checked:Oe.documentsVerified,onCheckedChange:e=>qe({...Oe,documentsVerified:e})}),e.jsx("label",{htmlFor:"documents-approve",className:"text-sm font-medium cursor-pointer",children:"All required documents are verified"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{id:"location-approve",checked:Oe.locationVerified,onCheckedChange:e=>qe({...Oe,locationVerified:e})}),e.jsx("label",{htmlFor:"location-approve",className:"text-sm font-medium cursor-pointer",children:"Property location is verified and accurate"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{id:"price-approve",checked:Oe.priceReasonable,onCheckedChange:e=>qe({...Oe,priceReasonable:e})}),e.jsx("label",{htmlFor:"price-approve",className:"text-sm font-medium cursor-pointer",children:"Price is reasonable and competitive"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{id:"images-approve",checked:Oe.imagesQuality,onCheckedChange:e=>qe({...Oe,imagesQuality:e})}),e.jsx("label",{htmlFor:"images-approve",className:"text-sm font-medium cursor-pointer",children:"Images are of good quality and relevant"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{id:"description-approve",checked:Oe.descriptionComplete,onCheckedChange:e=>qe({...Oe,descriptionComplete:e})}),e.jsx("label",{htmlFor:"description-approve",className:"text-sm font-medium cursor-pointer",children:"Description is complete and accurate"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{id:"ownership-approve",checked:Oe.ownershipConfirmed,onCheckedChange:e=>qe({...Oe,ownershipConfirmed:e})}),e.jsx("label",{htmlFor:"ownership-approve",className:"text-sm font-medium cursor-pointer",children:"Ownership is confirmed and legitimate"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"handwritten-comments-approve",children:"Approval Notes & Comments"}),e.jsx(_,{id:"handwritten-comments-approve",placeholder:"Type your handwritten comments or notes here...",value:Qe,onChange:e=>Be(e.target.value),className:"mt-1 min-h-[120px] font-handwriting",rows:6}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Add any additional observations, recommendations, or special notes"})]})]}),e.jsxs(E,{children:[e.jsx(m,{variant:"outline",onClick:()=>de(!1),children:"Cancel"}),e.jsx(m,{className:"bg-green-600 hover:bg-green-700",onClick:async()=>{if(ie&&De.trim())try{fe({...ue,[ie._id]:!0});const e=await r(`/subadmin/properties/${ie._id}/approve`,{method:"POST",body:JSON.stringify({approver:De,notes:Qe})});await l(e),ve({title:"Success",description:"Property approved successfully"}),de(!1),Me(),ne(null),Ue()}catch(e){ve({title:"Error",description:e.message||"Failed to approve property",variant:"destructive"})}finally{fe({...ue,[ie._id]:!1})}else ve({title:"Error",description:"Approver name is required",variant:"destructive"})},disabled:!De.trim()||ue[ie?._id||""],children:ue[ie?._id||""]?"Approving...":"Approve Property"})]})]})}),e.jsx(P,{open:oe,onOpenChange:me,children:e.jsxs(R,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(T,{children:[e.jsx($,{children:"Reject Property"}),e.jsxs(V,{children:['Complete the form and provide a reason for rejecting "',ie?.title,'". The vendor will be notified.']})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Approver Name"}),e.jsx("div",{className:"p-3 rounded-md bg-muted border border-border mt-1",children:e.jsx("p",{className:"font-medium text-sm",children:De||"Loading..."})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically set from your logged-in account"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(h,{className:"text-base font-semibold",children:"Issues Found (Check applicable items)"}),e.jsxs("div",{className:"space-y-3 border rounded-lg p-4 bg-muted/30",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{id:"documents-reject",checked:Oe.documentsVerified,onCheckedChange:e=>qe({...Oe,documentsVerified:e})}),e.jsx("label",{htmlFor:"documents-reject",className:"text-sm font-medium cursor-pointer",children:"Documents are incomplete or invalid"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{id:"location-reject",checked:Oe.locationVerified,onCheckedChange:e=>qe({...Oe,locationVerified:e})}),e.jsx("label",{htmlFor:"location-reject",className:"text-sm font-medium cursor-pointer",children:"Property location is incorrect or unclear"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{id:"price-reject",checked:Oe.priceReasonable,onCheckedChange:e=>qe({...Oe,priceReasonable:e})}),e.jsx("label",{htmlFor:"price-reject",className:"text-sm font-medium cursor-pointer",children:"Price is unreasonable or suspicious"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{id:"images-reject",checked:Oe.imagesQuality,onCheckedChange:e=>qe({...Oe,imagesQuality:e})}),e.jsx("label",{htmlFor:"images-reject",className:"text-sm font-medium cursor-pointer",children:"Images are poor quality or irrelevant"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{id:"description-reject",checked:Oe.descriptionComplete,onCheckedChange:e=>qe({...Oe,descriptionComplete:e})}),e.jsx("label",{htmlFor:"description-reject",className:"text-sm font-medium cursor-pointer",children:"Description is incomplete or misleading"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{id:"ownership-reject",checked:Oe.ownershipConfirmed,onCheckedChange:e=>qe({...Oe,ownershipConfirmed:e})}),e.jsx("label",{htmlFor:"ownership-reject",className:"text-sm font-medium cursor-pointer",children:"Ownership cannot be confirmed"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"rejection-reason",children:"Rejection Reason *"}),e.jsx(_,{id:"rejection-reason",placeholder:"Enter the detailed reason for rejection...",value:he,onChange:e=>je(e.target.value),className:"mt-1",rows:4})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"handwritten-comments-reject",children:"Additional Comments"}),e.jsx(_,{id:"handwritten-comments-reject",placeholder:"Type your handwritten comments or notes here...",value:Qe,onChange:e=>Be(e.target.value),className:"mt-1 min-h-[120px] font-handwriting",rows:6}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Add any additional feedback or suggestions for the vendor"})]})]}),e.jsxs(E,{children:[e.jsx(m,{variant:"outline",onClick:()=>me(!1),children:"Cancel"}),e.jsx(m,{variant:"destructive",onClick:async()=>{if(ie&&he.trim()&&De.trim())try{fe({...ue,[ie._id]:!0});const e=await r(`/subadmin/properties/${ie._id}/reject`,{method:"POST",body:JSON.stringify({reason:he,approver:De,notes:Qe})});await l(e),ve({title:"Success",description:"Property rejected successfully"}),me(!1),Me(),ne(null),Ue()}catch(e){ve({title:"Error",description:"Failed to reject property",variant:"destructive"})}finally{fe({...ue,[ie._id]:!1})}else ve({title:"Error",description:"Approver name and rejection reason are required",variant:"destructive"})},disabled:!he.trim()||!De.trim()||ue[ie?._id||""],children:ue[ie?._id||""]?"Rejecting...":"Reject Property"})]})]})}),e.jsx(P,{open:xe,onOpenChange:pe,children:e.jsxs(R,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(T,{children:[e.jsx($,{className:"text-2xl",children:ie?.title}),e.jsx(V,{children:e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(L,{className:"w-4 h-4"}),ie?.address.street,", ",ie?.address.city,", ",ie?.address.state," - ",ie?.address.pincode||ie?.address.zipCode]})})]}),ie&&e.jsxs("div",{className:"space-y-6 mt-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(p,{variant:"available"===ie.status?"default":"pending"===ie.status?"outline":"destructive",children:["Status: ",ie.status]}),e.jsx(p,{variant:"secondary",className:"capitalize",children:ie.type?ie.type.replace("_"," "):"property"}),e.jsxs(p,{variant:"sale"===ie.listingType?"default":"outline",children:["For ","sale"===ie.listingType?"Sale":"Rent"]}),ie.featured&&e.jsx(p,{variant:"default",children:"Featured"}),ie.verified&&e.jsx(p,{variant:"default",children:"Verified"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Price"}),e.jsx("p",{className:"font-semibold",children:We(ie.price)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Area"}),e.jsx("p",{className:"font-semibold",children:Je(ie.area)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Bedrooms"}),e.jsx("p",{className:"font-semibold",children:ie.bedrooms||"N/A"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Bathrooms"}),e.jsx("p",{className:"font-semibold",children:ie.bathrooms||"N/A"})]})]})]}),e.jsx(z,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:ie.description})]}),ie.amenities&&ie.amenities.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(z,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Amenities"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ie.amenities.map((s,a)=>e.jsx(p,{variant:"outline",className:"capitalize",children:s.replace("_"," ")},a))})]})]}),e.jsx(z,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Owner Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Name"}),e.jsx("p",{className:"font-medium",children:ie.owner?.profile?.firstName&&ie.owner?.profile?.lastName?`${ie.owner.profile.firstName} ${ie.owner.profile.lastName}`:ie.owner.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Email"}),e.jsx("p",{className:"font-medium",children:ie.owner?.email})]}),ie.owner?.profile?.phone&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Phone"}),e.jsx("p",{className:"font-medium",children:ie.owner.profile.phone})]})]})]}),ie.images&&ie.images.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(z,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Images"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:ie.images.map((s,a)=>{const t="object"==typeof s?s:{};return e.jsxs("div",{className:"relative aspect-video rounded-lg overflow-hidden border",children:[e.jsx("img",{src:G(s),alt:t.caption||`Property ${a+1}`,className:"w-full h-full object-cover",onError:e=>{e.target.src=y}}),t.isPrimary&&e.jsx(p,{className:"absolute top-2 left-2",variant:"default",children:"Primary"})]},a)})})]})]}),ie.videos&&ie.videos.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(z,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Videos"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ie.videos.map((s,a)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"relative aspect-video rounded-lg overflow-hidden border bg-black",children:s.url&&(s.url.includes("youtube.com")||s.url.includes("youtu.be"))?e.jsx("iframe",{src:s.url.replace("watch?v=","embed/").replace("youtu.be/","youtube.com/embed/"),className:"w-full h-full",allowFullScreen:!0,title:s.caption||`Video ${a+1}`}):e.jsx("video",{src:s.url,controls:!0,className:"w-full h-full object-contain",poster:s.thumbnail})}),s.caption&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.caption})]},a))})]})]}),ie.virtualTour&&e.jsxs(e.Fragment,{children:[e.jsx(z,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Virtual Tour"}),e.jsx(W,{url:ie.virtualTour})]})]}),"rejected"===ie.status&&ie.rejectionReason&&e.jsxs(e.Fragment,{children:[e.jsx(z,{}),e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-red-700 mb-2",children:"Rejection Reason"}),e.jsx("p",{className:"text-sm text-red-600",children:ie.rejectionReason})]})]})]})]})})]})};export{H as default};
