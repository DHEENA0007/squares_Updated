import{j as e}from"./ui-BNZSgpjP.js";import{r as s,d as t,L as a}from"./router-D8v2YSKU.js";import{a2 as i,G as l,a3 as r,ac as d,L as c,q as n,r as o,s as m,v as x,w as h,I as p,l as u,f as g,A as j,J as v,a as b,e as N,B as y,bS as f,o as C,j as w,aP as F,k as P,T as S,aO as A}from"./index-AgUnwITA.js";import{C as T}from"./checkbox-Igk13eF4.js";import{R as L,a as k}from"./radio-group-CpH2jnWh.js";import{A as U,a as E}from"./alert-CCpzKqmA.js";import{vendorService as R}from"./vendorService-D3bgDE6C.js";import{P as D}from"./PincodeAutocomplete-B3l3LVgK.js";import{s as I,c as V,d as B}from"./sanitize-BQqf2LN8.js";import{L as $}from"./lock-sdngF3Ea.js";import{C as O}from"./camera-Bntoy2nt.js";import{I as M}from"./indian-rupee-CWKyVbhh.js";import"./vendor-BxThA0WO.js";import"./reviewsService-C_afqTUu.js";import"./purify.es-DKmS7_S0.js";const W=({propertyTypeId:t,values:a,onChange:u,errors:g={},onValidationChange:j})=>{const[v,b]=s.useState([]),[N,y]=s.useState(!1),{toast:f}=i();s.useEffect(()=>{if(!j||0===v.length)return;const e={};v.forEach(s=>{if(s.isRequired){const t=a[s.fieldName];(!t||"string"==typeof t&&""===t.trim())&&(e[s.fieldName]=`${s.fieldLabel} is required`)}});const s=0===Object.keys(e).length;j(s,e)},[a,v,j]),s.useEffect(()=>{if(!t)return void b([]);(async()=>{try{y(!0);const e=await r.getPropertyTypeFields(t,!1);b(e.sort((e,s)=>e.displayOrder-s.displayOrder))}catch(e){f({title:"Error",description:"Failed to load property fields",variant:"destructive"}),b([])}finally{y(!1)}})()},[t,f]);return N?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(l,{className:"h-6 w-6 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Loading property fields..."})]}):0===v.length?null:e.jsx("div",{className:"space-y-4 md:space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",children:v.map(s=>(s=>{const t=a[s.fieldName]??"",i=g[s.fieldName];switch(s.fieldType){case"text":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:s.fieldName,className:"text-sm md:text-base",children:[s.fieldLabel,s.isRequired&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),e.jsx(p,{id:s.fieldName,value:t,onChange:e=>u(s.fieldName,e.target.value),placeholder:`Enter ${s.fieldLabel.toLowerCase()}`,className:"text-sm md:text-base "+(i?"border-destructive":"")}),i&&e.jsx("p",{className:"text-xs text-destructive",children:i})]},s._id);case"number":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:s.fieldName,className:"text-sm md:text-base",children:[s.fieldLabel,s.isRequired&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),e.jsx(p,{id:s.fieldName,type:"number",value:t,onChange:e=>u(s.fieldName,e.target.value),placeholder:`Enter ${s.fieldLabel.toLowerCase()}`,className:"text-sm md:text-base "+(i?"border-destructive":"")}),i&&e.jsx("p",{className:"text-xs text-destructive",children:i})]},s._id);case"select":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:s.fieldName,className:"text-sm md:text-base",children:[s.fieldLabel,s.isRequired&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),e.jsxs(n,{value:t,onValueChange:e=>u(s.fieldName,e),children:[e.jsx(o,{className:"text-sm md:text-base "+(i?"border-destructive":""),children:e.jsx(m,{placeholder:`Select ${s.fieldLabel.toLowerCase()}`})}),e.jsx(x,{children:s.fieldOptions?.map(s=>e.jsx(h,{value:s,className:"text-sm md:text-base",children:s},s))})]}),i&&e.jsx("p",{className:"text-xs text-destructive",children:i})]},s._id);case"multiselect":const a=Array.isArray(t)?t:[];return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{className:"text-sm md:text-base",children:[s.fieldLabel,s.isRequired&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.fieldOptions?.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{id:`${s.fieldName}-${t}`,checked:a.includes(t),onCheckedChange:e=>{const i=e?[...a,t]:a.filter(e=>e!==t);u(s.fieldName,i)}}),e.jsx(c,{htmlFor:`${s.fieldName}-${t}`,className:"text-sm font-normal cursor-pointer",children:t})]},t))}),i&&e.jsx("p",{className:"text-xs text-destructive",children:i})]},s._id);case"boolean":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(d,{id:s.fieldName,checked:!0===t||"true"===t,onCheckedChange:e=>u(s.fieldName,e)}),e.jsxs(c,{htmlFor:s.fieldName,className:"text-sm md:text-base cursor-pointer",children:[s.fieldLabel,s.isRequired&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]})]}),i&&e.jsx("p",{className:"text-xs text-destructive",children:i})]},s._id);default:return null}})(s))})})},q=async(e,s)=>{const t=new FormData;t.append("file",e),t.append("folder",s);try{const e=await fetch("https://app.buildhomemartsquares.com/api/upload/single",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},body:t});if(!e.ok)throw new Error("Failed to upload file");const s=await e.json();if(!s.success)throw new Error(s.message||"Upload failed");return s.data.url}catch(a){throw new Error("Failed to upload file")}},Y=()=>{const d=t(),{toast:Y}=i(),[_,z]=s.useState(1),[G,H]=s.useState(!1),[K,J]=s.useState(!0),[Q,X]=s.useState({maxProperties:0,currentProperties:0,canAddMore:!1,planName:"",features:[],maxPropertyImages:10,isUnlimited:!1}),[Z,ee]=s.useState(!1),[se,te]=s.useState({title:"",description:"",propertyType:"",listingType:"",address:"",country:"India",countryCode:"IN",state:"",stateCode:"",district:"",districtCode:"",city:"",cityCode:"",taluk:"",locationName:"",pincode:"",bedrooms:"",bathrooms:"",floor:"",totalFloors:"",furnishing:"",age:"",builtUpArea:"",carpetArea:"",plotArea:"",price:"",priceNegotiable:!1,maintenanceCharges:"",securityDeposit:"",amenities:[],images:[],videos:[],virtualTour:"",availability:"",possession:"",facing:"",parkingSpaces:"",roadWidth:"",cornerPlot:""}),[ae,ie]=s.useState([]),[le,re]=s.useState([]),[de,ce]=s.useState(!1),[ne,oe]=s.useState(!1),[me,xe]=s.useState(!1),[he,pe]=s.useState([]),[ue,ge]=s.useState(!0),[je,ve]=s.useState([]),[be,Ne]=s.useState(!0),[ye,fe]=s.useState(""),[Ce,we]=s.useState({}),[Fe,Pe]=s.useState({}),[Se,Ae]=s.useState([]),[Te,Le]=s.useState(!0),[ke,Ue]=s.useState([]),[Ee,Re]=s.useState(!0),[De,Ie]=s.useState([]),[Ve,Be]=s.useState(!0),$e=s.useRef(null);s.useRef(null);const[Oe,Me]=s.useState({country:"India",state:"",district:"",city:""}),[We,qe]=s.useState([]),[Ye,_e]=s.useState([]),[ze,Ge]=s.useState([]),[He,Ke]=s.useState({states:!1,districts:!1,cities:!1,pincode:!1});s.useEffect(()=>{(async()=>{Ke(e=>({...e,states:!0}));try{await u.initialize();const e=u.getStates();qe(e)}catch(e){Y({title:"Error",description:"Failed to load location data. Please refresh the page.",variant:"destructive"})}finally{Ke(e=>({...e,states:!1}))}})()},[]),s.useEffect(()=>{(async()=>{try{ge(!0);const e=(await r.getFilterConfigurationsByType("listing_type",!1)).map(e=>({id:e._id,name:e.name,value:e.value,displayLabel:e.displayLabel}));pe(e)}catch(e){Y({title:"Error",description:"Failed to load listing types. Please refresh the page.",variant:"destructive"})}finally{ge(!1)}})()},[]),s.useEffect(()=>{(async()=>{try{Ne(!0);const e=(await r.getAllPropertyTypes(!1)).sort((e,s)=>(e.displayOrder||0)-(s.displayOrder||0)).map(e=>({id:e._id,value:e.value,label:e.name}));ve(e)}catch(e){Y({title:"Error",description:"Failed to load property types. Using default types.",variant:"destructive"}),ve([{id:"",value:"apartment",label:"Apartment"},{id:"",value:"villa",label:"Villa"},{id:"",value:"house",label:"House"},{id:"",value:"commercial",label:"Commercial"},{id:"",value:"plot",label:"Plot"},{id:"",value:"land",label:"Land"},{id:"",value:"office",label:"Office Space"},{id:"",value:"pg",label:"PG (Paying Guest)"}])}finally{Ne(!1)}})()},[]),s.useEffect(()=>{if(se.state){Ke(e=>({...e,districts:!0}));try{const e=u.getDistricts(se.state);_e(e),te(e=>({...e,district:"",city:"",pincode:""})),Me(e=>({...e,district:"",city:""})),Ge([])}catch(e){Y({title:"Error",description:"Failed to load districts. Please try again.",variant:"destructive"})}finally{Ke(e=>({...e,districts:!1}))}}else _e([])},[se.state]),s.useEffect(()=>{if(se.state&&se.district){Ke(e=>({...e,cities:!0}));try{const e=u.getCities(se.state,se.district);Ge(e),te(e=>({...e,city:"",pincode:""})),Me(e=>({...e,city:""}))}catch(e){Y({title:"Error",description:"Failed to load cities. Please try again.",variant:"destructive"})}finally{Ke(e=>({...e,cities:!1}))}}else Ge([])},[se.state,se.district]),s.useEffect(()=>{se.state&&Me(e=>({...e,state:se.state}))},[se.state]),s.useEffect(()=>{se.district&&Me(e=>({...e,district:se.district}))},[se.district]),s.useEffect(()=>{se.city&&Me(e=>({...e,city:se.city}))},[se.city]),s.useEffect(()=>{const e=[];Oe.city&&e.push(Oe.city),Oe.district&&e.push(Oe.district),Oe.state&&e.push(Oe.state),se.pincode&&e.push(se.pincode),e.length>0&&!se.address.trim()&&te(s=>({...s,address:e.join(", ")}))},[Oe,se.pincode]);const Je=s.useCallback(async()=>{J(!0);try{const e=await R.getSubscriptionLimits();if(X(e),H(e.canAddMore),!e.canAddMore){const s=e.isUnlimited||null===e.maxProperties||-1===e.maxProperties?"∞ (unlimited)":e.maxProperties;Y({title:"Property Limit Reached",description:`You have reached your ${e.planName} plan limit of ${s} properties. Please upgrade to add more.`,variant:"destructive"})}}catch(e){H(!1),Y({title:"Configuration Error",description:"Unable to verify subscription limits. Please contact administrator.",variant:"destructive"})}finally{J(!1)}},[Y]);s.useEffect(()=>{Je()},[Je]);const Qe=[{id:1,title:"Basic Details",description:"Property type and listing details"},{id:2,title:"Location",description:"Address and location information"},{id:3,title:"Property Details",description:"Specifications and measurements"},{id:4,title:"Pricing",description:"Price and financial details"},{id:5,title:"Amenities",description:"Features and facilities"},{id:6,title:"Media",description:"Photos, videos, and virtual tours"},{id:7,title:"Review",description:"Review and submit listing"}];s.useEffect(()=>{(async()=>{try{Le(!0);const e=(await r.getAllAmenities(!1)).sort((e,s)=>(e.displayOrder||0)-(s.displayOrder||0)).map(e=>e.name);Ae(e)}catch(e){Y({title:"Warning",description:"Failed to load amenities. Using default list.",variant:"destructive"}),Ae(["Swimming Pool","Gym/Fitness Center","Parking","Security","Garden/Park","Playground","Clubhouse","Power Backup","Elevator","WiFi","CCTV Surveillance","Intercom","Water Supply","Waste Management","Fire Safety","Visitor Parking"])}finally{Le(!1)}})()},[]),s.useEffect(()=>{(async()=>{try{Re(!0);const e=(await r.getFilterConfigurationsByType("facing",!1)).sort((e,s)=>(e.displayOrder||0)-(s.displayOrder||0)).map(e=>({value:e.value,label:e.displayLabel||e.name}));Ue(e)}catch(e){Ue([{value:"north",label:"North"},{value:"south",label:"South"},{value:"east",label:"East"},{value:"west",label:"West"},{value:"north-east",label:"North-East"},{value:"north-west",label:"North-West"},{value:"south-east",label:"South-East"},{value:"south-west",label:"South-West"}])}finally{Re(!1)}})()},[]),s.useEffect(()=>{(async()=>{try{Be(!0);const e=(await r.getFilterConfigurationsByType("parking_spaces",!1)).sort((e,s)=>(e.displayOrder||0)-(s.displayOrder||0)).map(e=>({value:e.value,label:e.displayLabel||e.name}));Ie(e)}catch(e){Ie([{value:"0",label:"No Parking"},{value:"1",label:"1 Car"},{value:"2",label:"2 Cars"},{value:"3",label:"3+ Cars"}])}finally{Be(!1)}})()},[]);const Xe=e=>{z(e)},Ze=async e=>{if(!e||0===e.length)return;const s=Array.from(e),t=Q.maxPropertyImages,a=ae.length,i=t-a;if(a>=t)Y({title:"Maximum Images Reached",description:`You can only upload a maximum of ${t} images per property (${Q.planName} plan)`,variant:"destructive"});else if(s.length>i)Y({title:"Too Many Images",description:`You can only upload ${i} more image(s). Maximum limit is ${t} images for ${Q.planName} plan`,variant:"destructive"});else{ce(!0);try{const e=[];for(const t of s){if(!t.type.startsWith("image/")){Y({title:"Invalid File Type",description:`${t.name} is not a valid image file`,variant:"destructive"});continue}const s=10485760;if(t.size>s){Y({title:"File Too Large",description:`${t.name} is too large. Maximum size is 10MB`,variant:"destructive"});continue}const a=URL.createObjectURL(t);e.push({id:Date.now()+Math.random(),name:t.name,url:a,file:t})}e.length>0&&(ie(s=>[...s,...e]),Y({title:"Images Added",description:`${e.length} image(s) ready for upload (${a+e.length}/${t})`}))}catch(l){Y({title:"Upload Error",description:l instanceof Error?l.message:"Failed to process images",variant:"destructive"})}finally{ce(!1)}}},es=e=>{const s=e.target.files;s&&s.length>0&&Ze(s),e.target.value=""};s.useEffect(()=>()=>{ae.forEach(e=>{e.url.startsWith("blob:")&&URL.revokeObjectURL(e.url)}),le.forEach(e=>{e.url.startsWith("blob:")&&URL.revokeObjectURL(e.url)})},[ae,le]);const ss=e=>{e.preventDefault(),e.stopPropagation(),xe(!0)},ts=e=>{e.preventDefault(),e.stopPropagation(),xe(!1)},as=async e=>{e.preventDefault(),e.stopPropagation(),xe(!1);const s=e.dataTransfer.files;s&&s.length>0&&await Ze(s)};return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-4 md:space-y-6 px-4 md:px-0",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e.jsx(g,{variant:"ghost",size:"icon",onClick:()=>d("/vendor/properties"),children:e.jsx(j,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl md:text-3xl font-bold flex items-center gap-2",children:[e.jsx(v,{className:"w-6 h-6 md:w-8 md:h-8 text-primary"}),"Add New Property"]}),e.jsx("p",{className:"text-sm md:text-base text-muted-foreground mt-1",children:"List your property and connect with potential buyers/tenants"})]})]})}),K&&e.jsx(b,{children:e.jsx(N,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"Checking subscription status..."})]})})}),!K&&!G&&e.jsx(b,{className:"border-amber-200 bg-amber-50/50",children:e.jsx(N,{className:"p-6",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx($,{className:"w-8 h-8 text-amber-600"})}),e.jsxs("div",{children:[0===Q.maxProperties?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold text-amber-900 mb-2",children:"Subscription Required"}),e.jsx("p",{className:"text-amber-700 mb-4",children:"To add properties, you need an active subscription plan."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold text-amber-900 mb-2",children:"Property Limit Reached"}),e.jsxs("p",{className:"text-amber-700 mb-4",children:["You have reached your ",Q.planName," plan limit of ",Q.isUnlimited||null===Q.maxProperties||-1===Q.maxProperties?"∞ (unlimited)":Q.maxProperties," properties."]}),e.jsxs("p",{className:"text-sm text-amber-600 mb-2",children:["Current: ",Q.currentProperties,"/",Q.isUnlimited||null===Q.maxProperties||-1===Q.maxProperties?"∞":Q.maxProperties," properties used"]})]}),e.jsxs("div",{className:"bg-amber-100 border border-amber-200 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-amber-800 font-medium mb-2",children:"Available Subscription Plans:"}),e.jsxs("div",{className:"text-left space-y-2 text-sm text-amber-700",children:[e.jsxs("div",{className:"flex justify-between items-center p-2 bg-white rounded border",children:[e.jsxs("span",{children:[e.jsx("strong",{children:"FREE LISTING"})," - 5 Properties"]}),e.jsx(y,{variant:"secondary",className:"text-xs",children:"Current"})]}),e.jsxs("div",{className:"flex justify-between items-center p-2 bg-white rounded border",children:[e.jsxs("span",{children:[e.jsx("strong",{children:"₹199"})," - 10 Properties + Top Rated + Verified Badge"]}),e.jsx(y,{className:"text-xs bg-green-600",children:"Popular"})]}),e.jsx("div",{className:"flex justify-between items-center p-2 bg-white rounded border",children:e.jsxs("span",{children:[e.jsx("strong",{children:"₹499"})," - 15 Properties + 1 Poster + 6 Leads"]})}),e.jsx("div",{className:"flex justify-between items-center p-2 bg-white rounded border",children:e.jsxs("span",{children:[e.jsx("strong",{children:"₹1999"})," - Unlimited + 4 Posters + 20 Leads"]})}),e.jsxs("div",{className:"flex justify-between items-center p-2 bg-white rounded border",children:[e.jsxs("span",{children:[e.jsx("strong",{children:"₹4999"})," - Unlimited + Videos + Marketing Manager + 30+ Leads"]}),e.jsx(y,{className:"text-xs bg-purple-600",children:"Premium"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsx(a,{to:"/vendor/subscription-plans",children:e.jsxs(g,{className:"bg-amber-600 hover:bg-amber-700 text-white",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Upgrade Plan"]})}),e.jsx(g,{variant:"outline",onClick:()=>{Je()},disabled:K,children:K?"Checking...":"Refresh Status"}),e.jsx(g,{variant:"outline",onClick:()=>d("/vendor/properties"),children:"Back to Properties"})]})]})})}),!K&&G&&e.jsx(e.Fragment,{children:e.jsx(b,{children:e.jsxs(N,{className:"p-4 md:p-6",children:[e.jsxs("div",{className:"relative mb-6 md:mb-8",children:[e.jsx("div",{className:"hidden md:block absolute top-4 md:top-5 left-0 right-0 h-0.5 bg-muted-foreground/30"}),e.jsx("div",{className:"hidden md:block absolute top-4 md:top-5 left-0 h-0.5 bg-primary transition-all duration-300",style:{width:(_-1)/(Qe.length-1)*100+"%"}}),e.jsx("div",{className:"md:hidden overflow-x-auto pb-2",children:e.jsx("div",{className:"flex items-center gap-4 min-w-max px-2",children:Qe.map((s,t)=>e.jsxs("div",{className:"flex flex-col items-center flex-shrink-0 w-16 cursor-pointer",onClick:()=>Xe(s.id),children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center border-2 mb-2 "+(_>=s.id?"bg-primary border-primary text-primary-foreground":"border-muted-foreground text-muted-foreground bg-background"),children:_>s.id?e.jsx(C,{className:"w-4 h-4"}):s.id}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-xs font-medium leading-tight whitespace-nowrap",children:s.title})})]},s.id))})}),e.jsx("div",{className:"hidden md:flex items-center justify-between relative",children:Qe.map((s,t)=>e.jsxs("div",{className:"flex flex-col items-center flex-1 max-w-24 md:max-w-32 cursor-pointer",onClick:()=>Xe(s.id),children:[e.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-full flex items-center justify-center border-2 mb-2 relative z-10 "+(_>=s.id?"bg-primary border-primary text-primary-foreground":"border-muted-foreground text-muted-foreground bg-background"),children:_>s.id?e.jsx(C,{className:"w-4 h-4 md:w-5 md:h-5"}):s.id}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs md:text-sm font-medium",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground hidden md:block",children:s.description})]})]},s.id))})]}),e.jsx("div",{className:"min-h-80 md:min-h-96",children:(()=>{switch(_){case 1:return e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"title",className:"text-sm md:text-base",children:"Property Title *"}),e.jsx(p,{id:"title",placeholder:"e.g., Luxury 3BHK Apartment in Bandra",value:se.title,onChange:e=>te(s=>({...s,title:e.target.value})),className:"text-sm md:text-base"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"propertyType",className:"text-sm md:text-base",children:"Property Type *"}),e.jsxs(n,{value:se.propertyType,onValueChange:e=>{const s=je.find(s=>s.value===e);te(s=>({...s,propertyType:e})),fe(s?.id||""),we({})},disabled:be,children:[e.jsx(o,{className:"text-sm md:text-base",children:e.jsx(m,{placeholder:be?"Loading property types...":"Select property type"})}),e.jsx(x,{children:be?e.jsx(h,{value:"loading",disabled:!0,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{className:"h-4 w-4 animate-spin"}),"Loading..."]})}):0===je.length?e.jsx(h,{value:"no-types",disabled:!0,children:"No property types available"}):je.map(s=>e.jsx(h,{value:s.value,className:"text-sm md:text-base",children:s.label},s.value))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-sm md:text-base",children:"Listing Type *"}),e.jsx(L,{value:se.listingType,onValueChange:e=>te(s=>({...s,listingType:e})),disabled:ue||0===he.length,children:ue?e.jsxs("div",{className:"flex items-center justify-center p-4",children:[e.jsx(l,{className:"h-5 w-5 animate-spin"}),e.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Loading listing types..."})]}):0===he.length?e.jsx("div",{className:"p-3 rounded-lg border bg-muted/30",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"No listing types configured. Please contact administrator."})}):e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:he.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{value:s.value,id:s.value}),e.jsx(c,{htmlFor:s.value,className:"text-sm md:text-base",children:s.displayLabel||s.name})]},s.id))})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"description",className:"text-sm md:text-base",children:"Property Description"}),e.jsx(S,{id:"description",placeholder:"Describe your property in detail...",rows:3,value:se.description,onChange:e=>te(s=>({...s,description:e.target.value})),className:"text-sm md:text-base resize-none"})]})]});case 2:return e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"border border-primary/20 rounded-lg p-4 md:p-6 bg-transparent",children:[e.jsxs("div",{className:"mb-3 md:mb-4",children:[e.jsxs("h3",{className:"text-base md:text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4 md:w-5 md:h-5 text-primary"}),"Property Location"]}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1",children:"Select your property location and pincode"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"state",className:"text-sm md:text-base",children:"State *"}),e.jsxs(n,{value:se.state,onValueChange:e=>{te(s=>({...s,state:e,stateCode:e}))},disabled:He.states,children:[e.jsx(o,{className:"text-sm md:text-base",children:e.jsx(m,{placeholder:He.states?"Loading states...":"Select state"})}),e.jsx(x,{children:We.map(s=>e.jsx(h,{value:s,className:"text-sm md:text-base",children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"district",className:"text-sm md:text-base",children:"District *"}),e.jsxs(n,{value:se.district,onValueChange:e=>{te(s=>({...s,district:e,districtCode:e}))},disabled:!se.state||He.districts,children:[e.jsx(o,{className:"text-sm md:text-base",children:e.jsx(m,{placeholder:se.state?He.districts?"Loading districts...":"Select district":"Select state first"})}),e.jsx(x,{children:Ye.map(s=>e.jsx(h,{value:s,className:"text-sm md:text-base",children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2 sm:col-span-2 lg:col-span-1",children:[e.jsx(c,{htmlFor:"city",className:"text-sm md:text-base",children:"City *"}),e.jsxs(n,{value:se.city,onValueChange:e=>{te(s=>({...s,city:e,cityCode:e}))},disabled:!se.district||He.cities,children:[e.jsx(o,{className:"text-sm md:text-base",children:e.jsx(m,{placeholder:se.district?He.cities?"Loading cities...":"Select city":"Select district first"})}),e.jsx(x,{children:ze.map(s=>e.jsx(h,{value:s,className:"text-sm md:text-base",children:s},s))})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"pincode",className:"text-sm md:text-base",children:"PIN Code *"}),e.jsx(D,{value:se.pincode,onChange:async(e,s)=>{if(te(s=>({...s,pincode:e})),s)try{if(s.state&&We.includes(s.state.toUpperCase())){const e=s.state.toUpperCase(),t=u.getDistricts(e),a=s.district?t.find(e=>e.toUpperCase()===s.district.toUpperCase()):null;let i=null;if(a&&s.city){const t=u.getCities(e,a);i=t.find(e=>e.toUpperCase()===s.city.toUpperCase())}te(s=>({...s,state:e,stateCode:e,district:a||s.district,districtCode:a||s.districtCode,city:i||s.city,cityCode:i||s.cityCode})),Y({title:"Location Auto-filled ✓",description:`${s.city}, ${s.district}, ${s.state}`})}}catch(t){Y({title:"Auto-fill Warning",description:"Some location fields could not be auto-filled. Please verify manually.",variant:"default"})}},state:se.state,district:se.district,city:se.city,placeholder:"Enter or select 6-digit PIN code",className:"w-full text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Select state, district, and city above to see matching pincodes, or type to search"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"address",className:"text-sm md:text-base",children:"Complete Address"}),e.jsx(S,{id:"address",placeholder:"Enter complete address with landmark",rows:2,value:se.address,onChange:e=>te(s=>({...s,address:e.target.value})),className:"text-sm md:text-base resize-none"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This will be auto-filled from location details above"})]})]});case 3:return e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[se.propertyType?ye?e.jsx(W,{propertyTypeId:ye,values:Ce,onChange:(e,s)=>{we(t=>({...t,[e]:s})),Fe[e]&&Pe(s=>{const t={...s};return delete t[e],t})},errors:Fe,onValidationChange:(e,s)=>{Pe(s)}}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:"No custom fields configured for this property type."}),e.jsx("p",{className:"text-sm mt-2",children:"The property type may be using legacy hardcoded fields."})]}):e.jsx(U,{children:e.jsx(E,{children:"Please select a property type in the Basic Details step to see relevant property specifications."})}),!ye&&se.propertyType&&e.jsxs(e.Fragment,{children:[["apartment","villa","house","pg"].includes(se.propertyType)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"bedrooms",className:"text-sm md:text-base",children:["Bedrooms ","pg"!==se.propertyType&&"*"]}),e.jsxs(n,{value:se.bedrooms,onValueChange:e=>te(s=>({...s,bedrooms:e})),children:[e.jsx(o,{className:"text-sm md:text-base",children:e.jsx(m,{placeholder:"Select"})}),e.jsx(x,{children:"pg"===se.propertyType?e.jsxs(e.Fragment,{children:[e.jsx(h,{value:"1",className:"text-sm md:text-base",children:"Single Sharing"}),e.jsx(h,{value:"2",className:"text-sm md:text-base",children:"Double Sharing"}),e.jsx(h,{value:"3",className:"text-sm md:text-base",children:"Triple Sharing"}),e.jsx(h,{value:"4",className:"text-sm md:text-base",children:"4+ Sharing"})]}):e.jsxs(e.Fragment,{children:[e.jsx(h,{value:"1",className:"text-sm md:text-base",children:"1 BHK"}),e.jsx(h,{value:"2",className:"text-sm md:text-base",children:"2 BHK"}),e.jsx(h,{value:"3",className:"text-sm md:text-base",children:"3 BHK"}),e.jsx(h,{value:"4",className:"text-sm md:text-base",children:"4 BHK"}),e.jsx(h,{value:"5",className:"text-sm md:text-base",children:"5+ BHK"})]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"bathrooms",className:"text-sm md:text-base",children:"Bathrooms"}),e.jsxs(n,{value:se.bathrooms,onValueChange:e=>te(s=>({...s,bathrooms:e})),children:[e.jsx(o,{className:"text-sm md:text-base",children:e.jsx(m,{placeholder:"Select"})}),e.jsx(x,{children:"pg"===se.propertyType?e.jsxs(e.Fragment,{children:[e.jsx(h,{value:"1",className:"text-sm md:text-base",children:"Attached"}),e.jsx(h,{value:"0",className:"text-sm md:text-base",children:"Common"})]}):e.jsxs(e.Fragment,{children:[e.jsx(h,{value:"1",className:"text-sm md:text-base",children:"1"}),e.jsx(h,{value:"2",className:"text-sm md:text-base",children:"2"}),e.jsx(h,{value:"3",className:"text-sm md:text-base",children:"3"}),e.jsx(h,{value:"4",className:"text-sm md:text-base",children:"4+"})]})})]})]}),e.jsxs("div",{className:"space-y-2 sm:col-span-2 lg:col-span-1",children:[e.jsx(c,{htmlFor:"furnishing",className:"text-sm md:text-base",children:"Furnishing"}),e.jsxs(n,{value:se.furnishing,onValueChange:e=>te(s=>({...s,furnishing:e})),children:[e.jsx(o,{className:"text-sm md:text-base",children:e.jsx(m,{placeholder:"Select"})}),e.jsxs(x,{children:[e.jsx(h,{value:"fully-furnished",className:"text-sm md:text-base",children:"Fully Furnished"}),e.jsx(h,{value:"semi-furnished",className:"text-sm md:text-base",children:"Semi Furnished"}),e.jsx(h,{value:"unfurnished",className:"text-sm md:text-base",children:"Unfurnished"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"builtUpArea",className:"text-sm md:text-base",children:["pg"===se.propertyType?"Room Area (sq ft)":"Built-up Area (sq ft)"," *"]}),e.jsx(p,{id:"builtUpArea",placeholder:"pg"===se.propertyType?"e.g., 150":"e.g., 1200",value:se.builtUpArea,onChange:e=>te(s=>({...s,builtUpArea:e.target.value})),className:"text-sm md:text-base"})]}),"pg"!==se.propertyType&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"carpetArea",className:"text-sm md:text-base",children:"Carpet Area (sq ft)"}),e.jsx(p,{id:"carpetArea",placeholder:"e.g., 1000",value:se.carpetArea,onChange:e=>te(s=>({...s,carpetArea:e.target.value})),className:"text-sm md:text-base"})]}),e.jsxs("div",{className:"space-y-2 sm:col-span-2 lg:col-span-1",children:[e.jsx(c,{htmlFor:"age",className:"text-sm md:text-base",children:"Property Age"}),e.jsxs(n,{value:se.age,onValueChange:e=>te(s=>({...s,age:e})),children:[e.jsx(o,{className:"text-sm md:text-base",children:e.jsx(m,{placeholder:"Select"})}),e.jsxs(x,{children:[e.jsx(h,{value:"new",className:"text-sm md:text-base",children:"New/Under Construction"}),e.jsx(h,{value:"1-3",className:"text-sm md:text-base",children:"1-3 Years"}),e.jsx(h,{value:"3-5",className:"text-sm md:text-base",children:"3-5 Years"}),e.jsx(h,{value:"5-10",className:"text-sm md:text-base",children:"5-10 Years"}),e.jsx(h,{value:"10+",className:"text-sm md:text-base",children:"10+ Years"})]})]})]})]}),"pg"!==se.propertyType&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"floor",className:"text-sm md:text-base",children:"Floor"}),e.jsx(p,{id:"floor",placeholder:"e.g., 5th",value:se.floor,onChange:e=>te(s=>({...s,floor:e.target.value})),className:"text-sm md:text-base"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"totalFloors",className:"text-sm md:text-base",children:"Total Floors"}),e.jsx(p,{id:"totalFloors",placeholder:"e.g., 20",value:se.totalFloors,onChange:e=>te(s=>({...s,totalFloors:e.target.value})),className:"text-sm md:text-base"})]})]}),"pg"===se.propertyType&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"floor",className:"text-sm md:text-base",children:"Floor"}),e.jsx(p,{id:"floor",placeholder:"e.g., Ground, 1st, 2nd",value:se.floor,onChange:e=>te(s=>({...s,floor:e.target.value})),className:"text-sm md:text-base"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"availability",className:"text-sm md:text-base",children:"Food Availability"}),e.jsxs(n,{value:se.availability,onValueChange:e=>te(s=>({...s,availability:e})),children:[e.jsx(o,{className:"text-sm md:text-base",children:e.jsx(m,{placeholder:"Select"})}),e.jsxs(x,{children:[e.jsx(h,{value:"meals-included",className:"text-sm md:text-base",children:"Meals Included"}),e.jsx(h,{value:"kitchen-available",className:"text-sm md:text-base",children:"Kitchen Available"}),e.jsx(h,{value:"no-meals",className:"text-sm md:text-base",children:"No Meals"})]})]})]})]})]}),["commercial","office"].includes(se.propertyType)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"builtUpArea",className:"text-sm md:text-base",children:"Built-up Area (sq ft) *"}),e.jsx(p,{id:"builtUpArea",placeholder:"e.g., 2500",value:se.builtUpArea,onChange:e=>te(s=>({...s,builtUpArea:e.target.value})),className:"text-sm md:text-base"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"carpetArea",className:"text-sm md:text-base",children:"Carpet Area (sq ft)"}),e.jsx(p,{id:"carpetArea",placeholder:"e.g., 2000",value:se.carpetArea,onChange:e=>te(s=>({...s,carpetArea:e.target.value})),className:"text-sm md:text-base"})]}),e.jsxs("div",{className:"space-y-2 sm:col-span-2 lg:col-span-1",children:[e.jsx(c,{htmlFor:"furnishing",className:"text-sm md:text-base",children:"Furnishing"}),e.jsxs(n,{value:se.furnishing,onValueChange:e=>te(s=>({...s,furnishing:e})),children:[e.jsx(o,{className:"text-sm md:text-base",children:e.jsx(m,{placeholder:"Select"})}),e.jsxs(x,{children:[e.jsx(h,{value:"fully-furnished",className:"text-sm md:text-base",children:"Fully Furnished"}),e.jsx(h,{value:"semi-furnished",className:"text-sm md:text-base",children:"Semi Furnished"}),e.jsx(h,{value:"unfurnished",className:"text-sm md:text-base",children:"Bare Shell"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"floor",className:"text-sm md:text-base",children:"Floor"}),e.jsx(p,{id:"floor",placeholder:"e.g., 3rd, Ground",value:se.floor,onChange:e=>te(s=>({...s,floor:e.target.value})),className:"text-sm md:text-base"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"totalFloors",className:"text-sm md:text-base",children:"Total Floors in Building"}),e.jsx(p,{id:"totalFloors",placeholder:"e.g., 10",value:se.totalFloors,onChange:e=>te(s=>({...s,totalFloors:e.target.value})),className:"text-sm md:text-base"})]}),e.jsxs("div",{className:"space-y-2 sm:col-span-2 lg:col-span-1",children:[e.jsx(c,{htmlFor:"age",className:"text-sm md:text-base",children:"Property Age"}),e.jsxs(n,{value:se.age,onValueChange:e=>te(s=>({...s,age:e})),children:[e.jsx(o,{className:"text-sm md:text-base",children:e.jsx(m,{placeholder:"Select"})}),e.jsxs(x,{children:[e.jsx(h,{value:"new",className:"text-sm md:text-base",children:"New/Under Construction"}),e.jsx(h,{value:"1-3",className:"text-sm md:text-base",children:"1-3 Years"}),e.jsx(h,{value:"3-5",className:"text-sm md:text-base",children:"3-5 Years"}),e.jsx(h,{value:"5-10",className:"text-sm md:text-base",children:"5-10 Years"}),e.jsx(h,{value:"10+",className:"text-sm md:text-base",children:"10+ Years"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"bathrooms",className:"text-sm md:text-base",children:"Washrooms"}),e.jsxs(n,{value:se.bathrooms,onValueChange:e=>te(s=>({...s,bathrooms:e})),children:[e.jsx(o,{className:"text-sm md:text-base",children:e.jsx(m,{placeholder:"Select"})}),e.jsxs(x,{children:[e.jsx(h,{value:"1",className:"text-sm md:text-base",children:"1"}),e.jsx(h,{value:"2",className:"text-sm md:text-base",children:"2"}),e.jsx(h,{value:"3",className:"text-sm md:text-base",children:"3"}),e.jsx(h,{value:"4",className:"text-sm md:text-base",children:"4+"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"availability",className:"text-sm md:text-base",children:"Possession Status"}),e.jsxs(n,{value:se.availability,onValueChange:e=>te(s=>({...s,availability:e})),children:[e.jsx(o,{className:"text-sm md:text-base",children:e.jsx(m,{placeholder:"Select"})}),e.jsxs(x,{children:[e.jsx(h,{value:"immediate",className:"text-sm md:text-base",children:"Immediate"}),e.jsx(h,{value:"within-30-days",className:"text-sm md:text-base",children:"Within 30 Days"}),e.jsx(h,{value:"within-60-days",className:"text-sm md:text-base",children:"Within 60 Days"}),e.jsx(h,{value:"within-90-days",className:"text-sm md:text-base",children:"Within 90 Days"})]})]})]})]})]}),["plot","land"].includes(se.propertyType)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"plotArea",className:"text-sm md:text-base",children:"Plot Area (sq ft) *"}),e.jsx(p,{id:"plotArea",placeholder:"e.g., 5000",value:se.plotArea,onChange:e=>te(s=>({...s,plotArea:e.target.value})),className:"text-sm md:text-base"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"builtUpArea",className:"text-sm md:text-base",children:"Total Area (sq ft) *"}),e.jsx(p,{id:"builtUpArea",placeholder:"e.g., 5000",value:se.builtUpArea,onChange:e=>te(s=>({...s,builtUpArea:e.target.value})),className:"text-sm md:text-base"})]}),e.jsxs("div",{className:"space-y-2 sm:col-span-2 lg:col-span-1",children:[e.jsx(c,{htmlFor:"facing",className:"text-sm md:text-base",children:"Plot Facing"}),e.jsxs(n,{value:se.facing,onValueChange:e=>te(s=>({...s,facing:e})),disabled:Ee,children:[e.jsx(o,{className:"text-sm md:text-base",children:e.jsx(m,{placeholder:Ee?"Loading...":"Select"})}),e.jsx(x,{children:Ee?e.jsx(h,{value:"loading",disabled:!0,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{className:"h-4 w-4 animate-spin"}),"Loading..."]})}):0===ke.length?e.jsx(h,{value:"no-options",disabled:!0,children:"No options configured"}):ke.map(s=>e.jsx(h,{value:s.value,className:"text-sm md:text-base",children:s.label},s.value))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"availability",className:"text-sm md:text-base",children:"Land Type"}),e.jsxs(n,{value:se.availability,onValueChange:e=>te(s=>({...s,availability:e})),children:[e.jsx(o,{className:"text-sm md:text-base",children:e.jsx(m,{placeholder:"Select"})}),e.jsxs(x,{children:[e.jsx(h,{value:"residential",className:"text-sm md:text-base",children:"Residential"}),e.jsx(h,{value:"commercial",className:"text-sm md:text-base",children:"Commercial"}),e.jsx(h,{value:"agricultural",className:"text-sm md:text-base",children:"Agricultural"}),e.jsx(h,{value:"industrial",className:"text-sm md:text-base",children:"Industrial"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"possession",className:"text-sm md:text-base",children:"Boundary Wall"}),e.jsxs(n,{value:se.possession,onValueChange:e=>te(s=>({...s,possession:e})),children:[e.jsx(o,{className:"text-sm md:text-base",children:e.jsx(m,{placeholder:"Select"})}),e.jsxs(x,{children:[e.jsx(h,{value:"yes",className:"text-sm md:text-base",children:"Yes"}),e.jsx(h,{value:"no",className:"text-sm md:text-base",children:"No"}),e.jsx(h,{value:"partial",className:"text-sm md:text-base",children:"Partial"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"roadWidth",className:"text-sm md:text-base",children:"Road Width (ft)"}),e.jsx(p,{id:"roadWidth",placeholder:"e.g., 30",value:se.roadWidth,onChange:e=>te(s=>({...s,roadWidth:e.target.value})),className:"text-sm md:text-base"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"cornerPlot",className:"text-sm md:text-base",children:"Corner Plot"}),e.jsxs(n,{value:se.cornerPlot,onValueChange:e=>te(s=>({...s,cornerPlot:e})),children:[e.jsx(o,{className:"text-sm md:text-base",children:e.jsx(m,{placeholder:"Select"})}),e.jsxs(x,{children:[e.jsx(h,{value:"yes",className:"text-sm md:text-base",children:"Yes"}),e.jsx(h,{value:"no",className:"text-sm md:text-base",children:"No"})]})]})]})]})]})]})]});case 4:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"price",children:"Price *"}),e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(p,{id:"price",placeholder:"Enter price",className:"pl-10",value:se.price,onChange:e=>te(s=>({...s,price:e.target.value}))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"maintenanceCharges",children:"Maintenance Charges (Monthly)"}),e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(p,{id:"maintenanceCharges",placeholder:"Optional",className:"pl-10",value:se.maintenanceCharges,onChange:e=>te(s=>({...s,maintenanceCharges:e.target.value}))})]})]})]}),("rent"===se.listingType||"lease"===se.listingType)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"securityDeposit",children:"Security Deposit"}),e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(p,{id:"securityDeposit",placeholder:"Enter security deposit",className:"pl-10",value:se.securityDeposit,onChange:e=>te(s=>({...s,securityDeposit:e.target.value}))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{id:"priceNegotiable",checked:se.priceNegotiable,onCheckedChange:e=>te(s=>({...s,priceNegotiable:!0===e}))}),e.jsx(c,{htmlFor:"priceNegotiable",children:"Price is negotiable"})]})]});case 5:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(c,{className:"text-base font-medium",children:"Property Amenities"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Select all amenities available in your property"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:Te?e.jsxs("div",{className:"col-span-full flex items-center justify-center py-4",children:[e.jsx(l,{className:"h-5 w-5 animate-spin mr-2"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading amenities..."})]}):0===Se.length?e.jsx("div",{className:"col-span-full text-center py-4 text-muted-foreground",children:"No amenities configured. Please contact admin."}):Se.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{id:s,checked:se.amenities.includes(s),onCheckedChange:()=>(e=>{te(s=>({...s,amenities:s.amenities.includes(e)?s.amenities.filter(s=>s!==e):[...s.amenities,e]}))})(s)}),e.jsx(c,{htmlFor:s,className:"text-sm",children:s})]},s))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"facing",children:"Facing"}),e.jsxs(n,{value:se.facing,onValueChange:e=>te(s=>({...s,facing:e})),disabled:Ee,children:[e.jsx(o,{children:e.jsx(m,{placeholder:Ee?"Loading...":"Select"})}),e.jsx(x,{children:Ee?e.jsx(h,{value:"loading",disabled:!0,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{className:"h-4 w-4 animate-spin"}),"Loading..."]})}):0===ke.length?e.jsx(h,{value:"no-options",disabled:!0,children:"No options configured"}):ke.map(s=>e.jsx(h,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"parkingSpaces",children:"Parking Spaces"}),e.jsxs(n,{value:se.parkingSpaces,onValueChange:e=>te(s=>({...s,parkingSpaces:e})),disabled:Ve,children:[e.jsx(o,{children:e.jsx(m,{placeholder:Ve?"Loading...":"Select"})}),e.jsx(x,{children:Ve?e.jsx(h,{value:"loading",disabled:!0,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{className:"h-4 w-4 animate-spin"}),"Loading..."]})}):0===De.length?e.jsx(h,{value:"no-options",disabled:!0,children:"No options configured"}):De.map(s=>e.jsx(h,{value:s.value,children:s.label},s.value))})]})]})]})]});case 6:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(c,{className:"text-base font-medium",children:"Property Images"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Upload high-quality images of your property (up to ",Q.maxPropertyImages," images, max 10MB each)"]}),e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors "+(me?"border-primary bg-primary/5":"border-muted-foreground/25"),onDragOver:ss,onDragLeave:ts,onDrop:as,children:[e.jsx(O,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{type:"button",variant:"outline",onClick:e=>{e.preventDefault(),e.stopPropagation(),$e.current?.click()},disabled:de,children:de?e.jsxs(e.Fragment,{children:[e.jsx(l,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Choose Images"]})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"or drag and drop images here"})]}),e.jsx("input",{ref:$e,type:"file",multiple:!0,accept:"image/*",className:"hidden",onChange:es,disabled:de})]}),de&&e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4 p-4 bg-blue-50 dark:bg-blue-950 rounded-lg",children:[e.jsx(l,{className:"w-5 h-5 animate-spin text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Processing images..."})]}),ae.length>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4",children:ae.map(s=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s.url,alt:s.name,className:"w-full h-24 object-cover rounded-lg"}),e.jsx(g,{size:"icon",variant:"destructive",className:"absolute -top-2 -right-2 h-6 w-6",onClick:()=>(e=>{const s=ae.find(s=>s.id===e);s&&s.url.startsWith("blob:")&&URL.revokeObjectURL(s.url),ie(s=>s.filter(s=>s.id!==e))})(s.id),children:e.jsx(F,{className:"h-3 w-3"})})]},s.id))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"virtualTour",children:"Virtual Tour URL (Optional)"}),e.jsx(p,{id:"virtualTour",placeholder:"e.g., https://your-virtual-tour-link.com",value:se.virtualTour,onChange:e=>te(s=>({...s,virtualTour:e.target.value}))})]})]});case 7:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(C,{className:"mx-auto h-16 w-16 text-green-600 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Review Your Listing"}),e.jsx("p",{className:"text-muted-foreground",children:"Please review all the details before submitting your property listing"})]}),e.jsx(b,{children:e.jsxs(N,{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Basic Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Title:"})," ",se.title]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",se.propertyType]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Listing:"})," ",se.listingType]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Location"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Country:"})," India"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"State:"})," ",se.state||"Not selected"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"District:"})," ",se.district||"Not selected"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"City:"})," ",se.city||"Not selected"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Pincode:"})," ",se.pincode||"Not provided"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",se.address||"Not provided"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Property Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Bedrooms:"})," ",se.bedrooms]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Area:"})," ",se.builtUpArea," sq ft"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Furnishing:"})," ",se.furnishing]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Pricing"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Price:"})," ₹",se.price]}),se.maintenanceCharges&&e.jsxs("p",{children:[e.jsx("strong",{children:"Maintenance:"})," ₹",se.maintenanceCharges,"/month"]})]})]}),se.amenities.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Amenities"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:se.amenities.map(s=>e.jsx(y,{variant:"secondary",children:s},s))})]}),ae.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("h3",{className:"font-semibold mb-2",children:["Images (",ae.length,")"]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[ae.slice(0,4).map(s=>e.jsx("img",{src:s.url,alt:s.name,className:"w-full h-16 object-cover rounded"},s.id)),ae.length>4&&e.jsxs("div",{className:"w-full h-16 bg-muted rounded flex items-center justify-center text-sm",children:["+",ae.length-4," more"]})]})]})]})})]});default:return null}})()}),e.jsxs("div",{className:"flex justify-between mt-6 md:mt-8 gap-4",children:[e.jsx(g,{variant:"outline",onClick:()=>{_>1&&z(_-1)},disabled:1===_,className:"flex-1 sm:flex-none",children:"Previous"}),_===Qe.length?e.jsx(g,{onClick:async()=>{if(Z)return;J(!0);try{const e=await R.getSubscriptionLimits();if(X(e),H(e.canAddMore),!e.canAddMore){const s=e.isUnlimited||null===e.maxProperties||-1===e.maxProperties?"∞ (unlimited)":e.maxProperties;return Y({title:"Property Limit Reached",description:`You have reached your ${e.planName} plan limit of ${s} properties. Please upgrade to add more.`,variant:"destructive"}),void J(!1)}}catch(t){return Y({title:"Configuration Error",description:"Unable to verify subscription limits. Please contact administrator.",variant:"destructive"}),void J(!1)}J(!1);const e={title:se.title?.trim(),description:se.description?.trim(),propertyType:se.propertyType,listingType:se.listingType,price:se.price,pincode:se.pincode},s=Object.entries(e).filter(([e,s])=>!s).map(([e])=>e);if(s.length>0)Y({title:"Missing Required Fields",description:`Please fill in: ${s.join(", ")}`,variant:"destructive"});else if(se.state&&se.city)if(Object.keys(Fe).length>0)Y({title:"Validation Error",description:"Please fix the errors in property details",variant:"destructive"});else{ee(!0);try{const e=[];for(const a of ae)if(a.file){const s=await q(a.file,"property_images");e.push({url:s,caption:a.name,isPrimary:0===e.length})}const s=[];for(const a of le)if(a.file){const e=await q(a.file,"property_videos");s.push({url:e,caption:a.name})}const t={title:I(se.title.trim()),description:I(se.description.trim()),type:se.propertyType,listingType:se.listingType,price:V(se.price),address:{street:I(se.address.trim()),district:I(se.district||""),city:I(se.city||""),state:I(se.state||""),pincode:se.pincode},amenities:(se.amenities||[]).map(e=>I(e)),images:e||[],videos:s||[]};void 0!==se.priceNegotiable&&(t.priceNegotiable=se.priceNegotiable),se.maintenanceCharges?.trim()&&(t.maintenanceCharges=V(se.maintenanceCharges)),se.securityDeposit?.trim()&&(t.securityDeposit=V(se.securityDeposit)),se.virtualTour?.trim()&&(t.virtualTour=I(se.virtualTour.trim())),Object.keys(Ce).length>0&&(t.customFields=B(Ce),Ce.builtUpArea&&(t.area=t.area||{},t.area.builtUp=parseFloat(Ce.builtUpArea),t.area.unit="sqft"),Ce.carpetArea&&(t.area=t.area||{},t.area.carpet=parseFloat(Ce.carpetArea)),Ce.plotArea&&(t.area=t.area||{},t.area.plot=parseFloat(Ce.plotArea)),Ce.bedrooms&&(t.bedrooms=parseInt(Ce.bedrooms)),Ce.bathrooms&&(t.bathrooms=parseInt(Ce.bathrooms)));await A.createProperty(t);Y({title:"Success!",description:"Property submitted successfully. It will be live after admin verification."}),d("/vendor/properties")}catch(t){let e="Failed to submit property. Please try again.";t instanceof Error&&(e=t.message),Y({title:"Error",description:e,variant:"destructive"})}finally{ee(!1)}}else Y({title:"Location Required",description:"Please select state and city for your property",variant:"destructive"})},className:"px-6 md:px-8 flex-1 sm:flex-none",disabled:Z,children:Z?e.jsxs(e.Fragment,{children:[e.jsx(l,{className:"w-4 h-4 mr-2 animate-spin"}),"Submitting..."]}):"Submit Property"}):e.jsx(g,{onClick:()=>{_<Qe.length&&z(_+1)},className:"flex-1 sm:flex-none",children:"Next"})]})]})})})]})};export{Y as default};
