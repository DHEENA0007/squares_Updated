import{j as e}from"./ui-s1SEoZIF.js";import{d as r,u as a,r as t,L as s}from"./router-D8v2YSKU.js";import{u as o,t as n,N as i,L as l,I as d,E as c,f as m,F as u}from"./index-xsqbJ4m0.js";import{E as p}from"./eye-off-BBZ8CfVN.js";import"./vendor-BxThA0WO.js";const g=()=>{const g=r(),h=a(),{login:v,logout:x,clearAuthDataAndUser:f}=o(),[j,b]=t.useState(""),[y,N]=t.useState(""),[w,P]=t.useState(!1),[S,A]=t.useState(!1),E=h.state?.from?.pathname||h.state?.from||null;t.useEffect(()=>{h.state?.message&&(n({title:"Portal Access",description:h.state.message,variant:"default"}),g(h.pathname,{replace:!0,state:{}}))},[h.state?.message]);return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(i,{}),e.jsx("main",{className:"container mx-auto px-4 py-12",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs("div",{className:"bg-card border border-border rounded-2xl p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-center mb-2",children:"Welcome Back"}),e.jsx("p",{className:"text-center text-muted-foreground mb-8",children:"Sign in to your BuildHomeMart account"}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),j&&y){P(!0);try{const e=await v(j,y);if(e.success){const e=JSON.parse(localStorage.getItem("user")||"{}");if("agent"===e.role)return n({title:"Incorrect Portal",description:"Please login through the Vendor Portal to access your vendor account.",variant:"destructive"}),f(),void setTimeout(()=>{g("/vendor/login")},2e3);if(E)if(E.startsWith("/property/")){const e=E.replace("/property/","");g(`/customer/property/${e}`,{replace:!0})}else g(E,{replace:!0});else"superadmin"===e.role?g("/admin/dashboard"):"subadmin"===e.role?g("/subadmin/dashboard"):"admin"===e.role?g("/admin/dashboard"):"agent"===e.role?g("/vendor/login"):"customer"===e.role?g("/customer/dashboard"):g("/rolebased")}else e.isVendorPendingApproval||e.error?.includes("pending approval")||e.error?.includes("pending_approval")?(n({title:"Vendor Profile Pending Approval",description:"Your vendor profile is under review. You will be notified once approved by our admin team. Please login through the Vendor Portal.",variant:"default",duration:6e3}),setTimeout(()=>{g("/vendor/login")},3e3)):n({title:"Login Failed",description:e.error||"Invalid email or password",variant:"destructive"})}catch(r){r.message?.includes("pending approval")||r.message?.includes("pending_approval")?(n({title:"Vendor Profile Pending Approval",description:"Your vendor profile is under review. You will be notified once approved by our admin team. Please login through the Vendor Portal.",variant:"default",duration:6e3}),setTimeout(()=>{g("/vendor/login")},3e3)):n({title:"Login Error",description:r.message||"An unexpected error occurred. Please try again.",variant:"destructive"})}finally{P(!1)}}else n({title:"Validation Error",description:"Please enter both email and password",variant:"destructive"})},className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"email",children:"Email"}),e.jsx(d,{id:"email",type:"email",placeholder:"you@example.com",required:!0,value:j,onChange:e=>b(e.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{htmlFor:"password",children:"Password"}),e.jsx(s,{to:"/forgot-password",className:"text-sm text-primary hover:underline",children:"Forgot password?"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{id:"password",type:S?"text":"password",placeholder:"Enter your password",required:!0,value:y,onChange:e=>N(e.target.value),className:"pr-10"}),e.jsx("button",{type:"button",onClick:()=>A(!S),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground",children:S?e.jsx(p,{className:"h-5 w-5"}):e.jsx(c,{className:"h-5 w-5"})})]})]}),e.jsx(m,{type:"submit",className:"w-full",disabled:w,children:w?"Signing In...":"Sign In"})]}),e.jsxs("p",{className:"text-center text-sm text-muted-foreground mt-6",children:["Don't have an account?"," ",e.jsx(s,{to:"/signup",className:"text-primary hover:underline font-medium",children:"Sign up"})]})]})})}),e.jsx(u,{})]})};export{g as default};
