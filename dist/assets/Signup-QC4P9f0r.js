import{j as e}from"./ui-s1SEoZIF.js";import{d as s,r as a}from"./router-D8v2YSKU.js";import{N as t,L as r,I as i,E as l,f as n,F as c,t as o,v as d}from"./index-YrVmIx3a.js";import{I as m,a as h,b as u}from"./input-otp-DCg2__gX.js";import{v as x,a as p,b as g}from"./sanitize-BQqf2LN8.js";import{E as f}from"./eye-off-B-EbfY5m.js";import"./vendor-BxThA0WO.js";import"./purify.es-DKmS7_S0.js";const v=()=>e.jsx("div",{className:"w-full h-auto flex items-center justify-center",children:e.jsx("img",{src:"/v3/assets/reg-pg.2zN6ULKb.png",alt:"Signup Illustration",className:"w-full h-auto max-w-4xl"})}),j=()=>{const j=s();a.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"smooth"})},[]);const[N,b]=a.useState("form"),[w,y]=a.useState(""),[P,k]=a.useState(!1),[C,E]=a.useState(0),[S,T]=a.useState(!0),[F,L]=a.useState(!1),[A,O]=a.useState(!1),[q,R]=a.useState({firstName:"",lastName:"",email:"",phone:"",password:"",confirmPassword:""}),[z,D]=a.useState({checking:!1,available:null,message:""});return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(t,{}),e.jsx("main",{className:"flex-1 flex items-center justify-center px-4 py-12 bg-gradient-to-br from-background to-accent/10",children:e.jsxs("div",{className:"w-full max-w-6xl grid lg:grid-cols-2 gap-8 items-center",children:[e.jsx("div",{className:"hidden lg:block",children:e.jsx("div",{className:"w-full h-auto rounded-2xl shadow-2xl bg-gradient-to-br from-blue-50 to-indigo-100 overflow-hidden",children:e.jsx(v,{})})}),e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsxs("div",{className:"bg-card rounded-2xl shadow-xl p-8 border",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Create Account"}),e.jsx("p",{className:"text-muted-foreground",children:"form"===N?"Sign up to get started with BuildHomeMart":"Enter the OTP sent to your email"})]}),"form"===N?e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!(q.firstName?.trim()&&q.lastName?.trim()&&q.email&&q.phone&&q.password&&q.confirmPassword))return void o({title:"Error",description:"Please fill in all fields",variant:"destructive"});if(q.firstName.trim().length<2)return void o({title:"Error",description:"First name must be at least 2 characters",variant:"destructive"});if(!x(q.email))return void o({title:"Error",description:"Please enter a valid email address",variant:"destructive"});if(!p(q.phone))return void o({title:"Error",description:"Please enter a valid 10-digit phone number starting with 6-9",variant:"destructive"});if(q.password!==q.confirmPassword)return void o({title:"Error",description:"Passwords do not match",variant:"destructive"});const s=g(q.password);if(s.valid)if(!1!==z.available){k(!0);try{const e=await d.sendOTP(q.email,q.firstName,q.phone);e.success&&(b("otp"),E(e.expiryMinutes||10),window.scrollTo({top:0,left:0,behavior:"smooth"}))}catch(a){}finally{k(!1)}}else o({title:"Error",description:z.message||"Phone number is not available",variant:"destructive"});else o({title:"Error",description:s.message,variant:"destructive"})},className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"firstName",children:"First Name *"}),e.jsx(i,{id:"firstName",type:"text",placeholder:"First name",value:q.firstName,onChange:e=>R({...q,firstName:e.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"lastName",children:"Last Name *"}),e.jsx(i,{id:"lastName",type:"text",placeholder:"Last name",value:q.lastName,onChange:e=>R({...q,lastName:e.target.value}),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"email",children:"Email *"}),e.jsx(i,{id:"email",type:"email",placeholder:"Enter your email",value:q.email,onChange:e=>R({...q,email:e.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"phone",children:"Phone Number *"}),e.jsx(i,{id:"phone",type:"tel",placeholder:"10-digit phone number",value:q.phone,onChange:e=>{const s=e.target.value.replace(/\D/g,"").slice(0,10);R({...q,phone:s}),10===s.length?setTimeout(()=>(async e=>{if(10===e.length){D({checking:!0,available:null,message:""});try{const s=await d.checkPhoneAvailability(e);D({checking:!1,available:s.available,message:s.message})}catch(s){D({checking:!1,available:!1,message:"Unable to validate phone number"})}}else D({checking:!1,available:null,message:""})})(s),500):D({checking:!1,available:null,message:""})},required:!0,className:!1===z.available?"border-red-500":!0===z.available?"border-green-500":""}),z.checking&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Checking availability..."}),!1===z.available&&e.jsx("p",{className:"text-xs text-red-500",children:z.message}),!0===z.available&&e.jsx("p",{className:"text-xs text-green-600",children:z.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"password",children:"Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx(i,{id:"password",type:F?"text":"password",placeholder:"Create a password",value:q.password,onChange:e=>R({...q,password:e.target.value}),required:!0,className:"pr-10"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>L(!F),children:F?e.jsx(f,{className:"h-4 w-4 text-gray-400"}):e.jsx(l,{className:"h-4 w-4 text-gray-400"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Must be 8+ characters with uppercase, lowercase, number, and special character (!@#$%^&*)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"confirmPassword",children:"Confirm Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx(i,{id:"confirmPassword",type:A?"text":"password",placeholder:"Re-enter your password",value:q.confirmPassword,onChange:e=>R({...q,confirmPassword:e.target.value}),required:!0,className:"pr-10"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>O(!A),children:A?e.jsx(f,{className:"h-4 w-4 text-gray-400"}):e.jsx(l,{className:"h-4 w-4 text-gray-400"})})]})]}),e.jsx(n,{type:"submit",className:"w-full",size:"lg",disabled:P,children:P?"Creating Account...":"Create Account"}),e.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:["Already have an account?"," ",e.jsx("a",{href:"/login",className:"text-primary font-medium hover:underline",children:"Login here"})]})]}):"otp"===N?e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),6===w.length){k(!0);try{(await d.register({email:q.email,password:q.password,firstName:q.firstName,lastName:q.lastName,phone:q.phone,role:"customer",agreeToTerms:!0,otp:w})).success&&(b("success"),window.scrollTo({top:0,left:0,behavior:"smooth"}),o({title:"Registration Successful!",description:"Your account has been created successfully. Redirecting to login..."}),setTimeout(()=>{j("/login")},3e3))}catch(s){y("")}finally{k(!1)}}else o({title:"Error",description:"Please enter the 6-digit OTP",variant:"destructive"})},className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(r,{className:"text-center block",children:"Enter 6-Digit OTP"}),e.jsx("div",{className:"flex justify-center",children:e.jsx(m,{maxLength:6,value:w,onChange:e=>y(e),children:e.jsxs(h,{children:[e.jsx(u,{index:0}),e.jsx(u,{index:1}),e.jsx(u,{index:2}),e.jsx(u,{index:3}),e.jsx(u,{index:4}),e.jsx(u,{index:5})]})})}),e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["OTP sent to ",q.email]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{type:"submit",className:"w-full",size:"lg",disabled:P,children:P?"Verifying...":"Register"}),e.jsx(n,{type:"button",variant:"outline",className:"w-full",onClick:async()=>{try{k(!0),await d.sendOTP(q.email,q.firstName,q.phone),y("")}catch(e){}finally{k(!1)}},disabled:P,children:"Resend OTP"}),e.jsx(n,{type:"button",variant:"ghost",className:"w-full",onClick:()=>b("form"),children:"Back to Form"})]})]}):"success"===N?e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-green-600 mb-2",children:"Account Created Successfully!"}),e.jsx("p",{className:"text-muted-foreground",children:"Your account has been created and email verified. Redirecting to login page..."})]}),e.jsx(n,{onClick:()=>j("/login"),className:"w-full",children:"Continue to Login"})]}):null]})})]})}),e.jsx(c,{})]})};export{j as default};
