import{t as e}from"./index-CM8T-gRV.js";const t="https://app.buildhomemartsquares.com/api";const r=new class{async makeRequest(e,r={}){const a=`${t}${e}`,o={headers:{"Content-Type":"application/json",...r.headers},...r},s=localStorage.getItem("token");s&&(o.headers={...o.headers,Authorization:`Bearer ${s}`});try{const e=await fetch(a,o);if(!e.ok){const t=await e.json().catch(()=>({success:!1,message:`HTTP ${e.status}: ${e.statusText}`}));throw new Error(t.message||"An error occurred")}return await e.json()}catch(i){throw i}}async getReviews(e={}){try{const t=new URLSearchParams;Object.entries(e).forEach(([e,r])=>{null!=r&&""!==r&&t.append(e,r.toString())});const r="/vendors/reviews"+(t.toString()?`?${t.toString()}`:""),a=await this.makeRequest(r);return a.success&&a.data?a.data:{reviews:[],totalCount:0,totalPages:0,currentPage:1}}catch(t){return{reviews:[],totalCount:0,totalPages:0,currentPage:1}}}async getReviewStats(){try{const e=await this.makeRequest("/vendors/reviews/stats");return e.success&&e.data?e.data:{totalReviews:0,averageRating:0,ratingDistribution:{5:0,4:0,3:0,2:0,1:0},recentReviews:0,responseRate:0,averageResponseTime:0,verifiedReviews:0,publicReviews:0,helpfulVotes:0,pendingReplies:0,commonKeywords:[]}}catch(e){return{totalReviews:0,averageRating:0,ratingDistribution:{5:0,4:0,3:0,2:0,1:0},recentReviews:0,responseRate:0,averageResponseTime:0,verifiedReviews:0,publicReviews:0,helpfulVotes:0,pendingReplies:0,commonKeywords:[]}}}async getReviewAnalytics(){try{const e=await this.makeRequest("/vendors/reviews/analytics");return e.success&&e.data?e.data:{monthlyReviews:[],topKeywords:[],competitorComparison:{vendorRating:0,industryAverage:0,competitorRatings:[]},improvementAreas:[]}}catch(e){return{monthlyReviews:[],topKeywords:[],competitorComparison:{vendorRating:0,industryAverage:0,competitorRatings:[]},improvementAreas:[]}}}async respondToReview(t){try{const r=await this.makeRequest(`/vendors/reviews/${t.reviewId}/respond`,{method:"POST",body:JSON.stringify({message:t.message})});if(r.success)return e({title:"Success",description:r.message||"Response posted successfully!"}),r.data;throw new Error(r.message||"Failed to post response")}catch(r){const t=r instanceof Error?r.message:"Failed to post response";return e({title:"Error",description:t,variant:"destructive"}),null}}async updateReviewVisibility(t,r){try{const a=await this.makeRequest(`/vendors/reviews/${t}/visibility`,{method:"PATCH",body:JSON.stringify({isPublic:r})});if(a.success)return e({title:"Success",description:a.message||"Review visibility updated!"}),a.data;throw new Error(a.message||"Failed to update review visibility")}catch(a){const t=a instanceof Error?a.message:"Failed to update review visibility";return e({title:"Error",description:t,variant:"destructive"}),null}}async reportReview(t,r){try{const a=await this.makeRequest(`/vendors/reviews/${t}/report`,{method:"POST",body:JSON.stringify({reason:r})});if(a.success)return e({title:"Success",description:a.message||"Review reported successfully!"}),!0;throw new Error(a.message||"Failed to report review")}catch(a){const t=a instanceof Error?a.message:"Failed to report review";return e({title:"Error",description:t,variant:"destructive"}),!1}}async markReviewHelpful(e,t){try{const r=await this.makeRequest(`/vendors/reviews/${e}/helpful`,{method:"POST",body:JSON.stringify({isHelpful:t})});if(r.success)return!0;throw new Error(r.message||"Failed to mark review as helpful")}catch(r){return!1}}formatRating(e){return e.toFixed(1)}formatDate(e){return new Date(e).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"})}getRelativeTime(e){const t=new Date(e),r=new Date,a=Math.floor((r.getTime()-t.getTime())/1e3);return a<60?"Just now":a<3600?`${Math.floor(a/60)} minutes ago`:a<86400?`${Math.floor(a/3600)} hours ago`:a<2592e3?`${Math.floor(a/86400)} days ago`:a<31536e3?`${Math.floor(a/2592e3)} months ago`:`${Math.floor(a/31536e3)} years ago`}getRatingColor(e){return e>=4.5?"text-green-600":e>=3.5?"text-yellow-600":e>=2.5?"text-orange-600":"text-red-600"}getRatingStars(e){return"★".repeat(Math.floor(e))+"☆".repeat(5-Math.floor(e))}getReviewTypeLabel(e){return{property:"Property Review",service:"Service Review",general:"General Review"}[e]||e}getReviewTypeColor(e){return{property:"bg-blue-100 text-blue-800",service:"bg-green-100 text-green-800",general:"bg-purple-100 text-purple-800"}[e]||"bg-gray-100 text-gray-800"}getSentimentColor(e){return{positive:"text-green-600",negative:"text-red-600",neutral:"text-gray-600"}[e]||"text-gray-600"}getImpactColor(e){return{high:"bg-red-100 text-red-800",medium:"bg-yellow-100 text-yellow-800",low:"bg-green-100 text-green-800"}[e]||"bg-gray-100 text-gray-800"}calculateResponseRate(e,t){return 0===e?0:Math.round(t/e*100)}getRatingPercentage(e,t){return 0===t?0:Math.round(e/t*100)}async getAdminReviews(e){const r=localStorage.getItem("token"),a=new URLSearchParams;e?.page&&a.append("page",e.page.toString()),e?.limit&&a.append("limit",e.limit.toString()),e?.search&&a.append("search",e.search),e?.status&&a.append("status",e.status),e?.rating&&a.append("rating",e.rating.toString()),void 0!==e?.flagged&&a.append("flagged",e.flagged.toString());const o=await fetch(`${t}/admin/reviews?${a.toString()}`,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(!o.ok)throw new Error("Failed to fetch reviews");const s=await o.json();return s.data||s}async getAdminReviewStats(){const e=localStorage.getItem("token"),r=await fetch(`${t}/admin/reviews/stats`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!r.ok)throw new Error("Failed to fetch review stats");const a=await r.json();return a.data||a}async approveReview(e){const r=localStorage.getItem("token"),a=await fetch(`${t}/admin/reviews/${e}/approve`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(!a.ok)throw new Error("Failed to approve review");return a.json()}async rejectReview(e){const r=localStorage.getItem("token"),a=await fetch(`${t}/admin/reviews/${e}/reject`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(!a.ok)throw new Error("Failed to reject review");return a.json()}async deleteReview(e){const r=localStorage.getItem("token"),a=await fetch(`${t}/admin/reviews/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(!a.ok)throw new Error("Failed to delete review");return a.json()}async flagReview(e){const r=localStorage.getItem("token"),a=await fetch(`${t}/admin/reviews/${e}/flag`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(!a.ok)throw new Error("Failed to flag review");return a.json()}async replyToReview(e,r){const a=localStorage.getItem("token"),o=await fetch(`${t}/admin/reviews/${e}/reply`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({message:r})});if(!o.ok)throw new Error("Failed to post reply");return o.json()}};export{r};
