import{j as e}from"./ui-DYmpZ3pJ.js";import{r}from"./router-2SVJvIbS.js";import{f as n,a as C,e as y,C as w,B as I,E as $,a7 as z,z as B,Y as b}from"./index-BbgqWuYN.js";import{T as R}from"./textarea-Cl1lQCIh.js";import{D as x,f as h,a as p,b as u,c as g}from"./dialog-DsX3mE8Q.js";import{C as F}from"./calendar-BL1izdXI.js";import{T as M}from"./triangle-alert-C_v7lvm2.js";import{I as _}from"./image-7ul4Xu4U.js";import"./vendor-Dazix4UH.js";const G=()=>{const[o,S]=r.useState([]),[k,j]=r.useState(!0),[E,P]=r.useState(null),[d,m]=r.useState(""),[i,f]=r.useState("pending"),v=async()=>{j(!0);try{const s=await fetch(`/api/admin/content/reports?status=${i}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(s.ok){const t=await s.json();S(t.reports)}}catch(s){console.error("Failed to fetch content reports:",s)}finally{j(!1)}};r.useEffect(()=>{v()},[i]);const N=async(s,t)=>{try{(await fetch(`/api/admin/content/reports/${s}/${t}`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({notes:d})})).ok&&(m(""),v())}catch(c){console.error(`Failed to ${t} content:`,c)}},A=s=>{switch(s){case"image":return _;case"review":return b;case"property_description":return b;case"user_profile":return B;default:return M}},T=s=>{switch(s){case"image":return"Inappropriate Image";case"review":return"Inappropriate Review";case"property_description":return"Property Description";case"user_profile":return"User Profile";default:return"Other"}},D=s=>{const t={pending:{variant:"secondary",color:"bg-yellow-100 text-yellow-800"},approved:{variant:"default",color:"bg-green-100 text-green-800"},rejected:{variant:"destructive",color:"bg-red-100 text-red-800"}};return t[s]||t.pending};return k?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Content Moderation"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Review and moderate user-generated content reports"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{variant:i==="pending"?"default":"outline",onClick:()=>f("pending"),size:"sm",children:["Pending (",o.filter(s=>s.status==="pending").length,")"]}),e.jsx(n,{variant:i==="all"?"default":"outline",onClick:()=>f("all"),size:"sm",children:"All Reports"})]})]}),o.length===0?e.jsx(C,{children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(w,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Reports Found"}),e.jsx("p",{className:"text-muted-foreground",children:i==="pending"?"No content reports are currently pending review.":"No content reports match your criteria."})]})})}):e.jsx("div",{className:"space-y-4",children:o.map(s=>{const t=A(s.type),c=D(s.status);return e.jsx(C,{className:"hover:shadow-md transition-shadow",children:e.jsx(y,{className:"pt-6",children:e.jsx("div",{className:"flex flex-col lg:flex-row gap-6",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(t,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:T(s.type)}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Reported by ",s.reportedBy.name]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(F,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(s.createdAt).toLocaleDateString()})]})]})]}),e.jsx(I,{className:c.color,children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"Report Reason:"}),e.jsx("p",{className:"text-sm",children:s.reason})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"Description:"}),e.jsx("p",{className:"text-sm",children:s.description})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"Reported Content:"}),e.jsxs("div",{className:"mt-2 p-3 bg-gray-50 rounded-lg",children:[s.content.images&&s.content.images.length>0&&e.jsx("div",{className:"flex gap-2 mb-2",children:s.content.images.map((a,l)=>e.jsx("img",{src:a,alt:`Content ${l+1}`,className:"w-16 h-16 object-cover rounded"},l))}),s.content.title&&e.jsx("p",{className:"font-medium text-sm mb-1",children:s.content.title}),s.content.text&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.content.text.length>200?`${s.content.text.substring(0,200)}...`:s.content.text})]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs(x,{children:[e.jsx(h,{asChild:!0,children:e.jsxs(n,{variant:"outline",size:"sm",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"View Full Content"]})}),e.jsxs(p,{className:"max-w-4xl",children:[e.jsx(u,{children:e.jsx(g,{children:"Full Content Review"})}),e.jsxs("div",{className:"space-y-4",children:[s.content.images&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.content.images.map((a,l)=>e.jsx("img",{src:a,alt:`Content ${l+1}`,className:"w-full h-64 object-cover rounded-lg"},l))}),s.content.text&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Full Text:"}),e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.content.text})]})]})]})]}),s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(x,{children:[e.jsx(h,{asChild:!0,children:e.jsxs(n,{size:"sm",className:"bg-green-600 hover:bg-green-700",children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Approve Content"]})}),e.jsxs(p,{children:[e.jsx(u,{children:e.jsx(g,{children:"Approve Content"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{children:"Mark this content as appropriate and dismiss the report?"}),e.jsx(R,{placeholder:"Add moderation notes (optional)...",value:d,onChange:a=>m(a.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(n,{variant:"outline",children:"Cancel"}),e.jsx(n,{className:"bg-green-600 hover:bg-green-700",onClick:()=>N(s._id,"approve"),children:"Approve Content"})]})]})]})]}),e.jsxs(x,{children:[e.jsx(h,{asChild:!0,children:e.jsxs(n,{variant:"destructive",size:"sm",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Remove Content"]})}),e.jsxs(p,{children:[e.jsx(u,{children:e.jsx(g,{children:"Remove Content"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{children:"Remove this content and take action against the user?"}),e.jsx(R,{placeholder:"Moderation notes (required for content removal)...",value:d,onChange:a=>m(a.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(n,{variant:"outline",children:"Cancel"}),e.jsx(n,{variant:"destructive",onClick:()=>N(s._id,"reject"),children:"Remove Content"})]})]})]})]})]})]})]})})})},s._id)})})]})};export{G as default};
