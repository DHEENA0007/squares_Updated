import{j as e}from"./ui-BNZSgpjP.js";import{d as s,r as a}from"./router-D8v2YSKU.js";import{D as t,t as i,u as r,a2 as l,f as n,a9 as c,a as d,b as o,c as h,e as m,$ as p,I as u,q as x,r as g,s as v,v as y,w as j,B as N,aD as b,aE as f,aF as C,aG as w,aH as A,aI as S,ad as E,a4 as P,a5 as M,a6 as O,a7 as F,a8 as k,L as D,T,ac as R,ae as I,Z as $,U as _,W as U,X as q}from"./index-BUFRx16p.js";import{T as z,a as L,b as B,c as V,d as Y,e as H}from"./table-DP60n6HD.js";import{P as J}from"./PriceRangeFilter-FCh0pkhV.js";import{E as G}from"./ellipsis-BRhuSfy3.js";import{S as W}from"./square-pen-DXJmhBYD.js";import{L as X,M as Z}from"./megaphone-CyfOLAvu.js";import{C as K}from"./camera-CUT8KQMT.js";import"./vendor-BxThA0WO.js";const Q=t("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),ee=t("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);const se=new class{async makeRequest(e,s={}){const a=`https://app.buildhomemartsquares.com/api${e}`,t={headers:{"Content-Type":"application/json",...s.headers},...s},i=localStorage.getItem("token");i&&(t.headers={...t.headers,Authorization:`Bearer ${i}`});try{const e=await fetch(a,t);if(!e.ok){const s=await e.json().catch(()=>({success:!1,message:`HTTP ${e.status}: ${e.statusText}`}));throw new Error(s.message||"An error occurred")}return await e.json()}catch(r){throw r}}async getAddons(e={}){try{const s=new URLSearchParams;e.category&&s.append("category",e.category),void 0!==e.isActive&&s.append("isActive",e.isActive.toString()),e.search&&s.append("search",e.search),e.page&&s.append("page",e.page.toString()),e.limit&&s.append("limit",e.limit.toString()),void 0!==e.minPrice&&s.append("minPrice",e.minPrice.toString()),void 0!==e.maxPrice&&s.append("maxPrice",e.maxPrice.toString()),void 0!==e.billingCycleMonths&&s.append("billingCycleMonths",e.billingCycleMonths.toString());const a="/admin/addons"+(s.toString()?"?"+s.toString():""),t=await this.makeRequest(a);if(t.success&&t.data)return t.data;throw new Error("Failed to fetch addons")}catch(s){const e=s instanceof Error?s.message:"Failed to fetch addons";throw i({title:"Error",description:e,variant:"destructive"}),s}}async getAddonById(e){try{const s=await this.makeRequest(`/admin/addons/${e}`);if(s.success&&s.data)return s.data;throw new Error("Failed to fetch addon")}catch(s){const e=s instanceof Error?s.message:"Failed to fetch addon";throw i({title:"Error",description:e,variant:"destructive"}),s}}async createAddon(e){try{const s=await this.makeRequest("/admin/addons",{method:"POST",body:JSON.stringify(e)});if(s.success&&s.data)return i({title:"Success",description:"Addon service created successfully"}),s.data;throw new Error("Failed to create addon")}catch(s){const e=s instanceof Error?s.message:"Failed to create addon";throw i({title:"Error",description:e,variant:"destructive"}),s}}async updateAddon(e,s){try{const a=await this.makeRequest(`/admin/addons/${e}`,{method:"PUT",body:JSON.stringify(s)});if(a.success&&a.data)return i({title:"Success",description:"Addon service updated successfully"}),a.data;throw new Error("Failed to update addon")}catch(a){const e=a instanceof Error?a.message:"Failed to update addon";throw i({title:"Error",description:e,variant:"destructive"}),a}}async deleteAddon(e){try{if((await this.makeRequest(`/admin/addons/${e}`,{method:"DELETE"})).success)return void i({title:"Success",description:"Addon service deleted successfully"});throw new Error("Failed to delete addon")}catch(s){const e=s instanceof Error?s.message:"Failed to delete addon";throw i({title:"Error",description:e,variant:"destructive"}),s}}async toggleAddonStatus(e){try{const s=await this.makeRequest(`/admin/addons/${e}/toggle-status`,{method:"PATCH"});if(s.success&&s.data)return i({title:"Success",description:`Addon service ${s.data.isActive?"activated":"deactivated"} successfully`}),s.data;throw new Error("Failed to toggle addon status")}catch(s){const e=s instanceof Error?s.message:"Failed to toggle addon status";throw i({title:"Error",description:e,variant:"destructive"}),s}}async updateSortOrder(e){try{if((await this.makeRequest("/admin/addons/sort-order",{method:"PUT",body:JSON.stringify({addonIds:e})})).success)return void i({title:"Success",description:"Addon sort order updated successfully"});throw new Error("Failed to update sort order")}catch(s){const e=s instanceof Error?s.message:"Failed to update sort order";throw i({title:"Error",description:e,variant:"destructive"}),s}}getCategoryOptions(){return[{value:"photography",label:"Photography"},{value:"marketing",label:"Marketing"},{value:"technology",label:"Technology"},{value:"support",label:"Support"},{value:"crm",label:"CRM"},{value:"other",label:"Other"}]}getBillingTypeOptions(){return[{value:"per_property",label:"Per Property"},{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"},{value:"one_time",label:"One Time"},{value:"custom",label:"Custom Period"}]}getCurrencyOptions(){return[{value:"INR",label:"₹ INR"},{value:"USD",label:"$ USD"},{value:"EUR",label:"€ EUR"}]}},ae={photography:K,marketing:Z,technology:X,support:U,crm:_},te=()=>{const t=s(),{user:i}=r(),{toast:_}=l(),U=i?.rolePermissions||[],X="admin"===i?.role||"superadmin"===i?.role,Z=e=>U.includes(e),K=X||Z($.ADDONS_READ),te=X||Z($.ADDONS_CREATE),ie=X||Z($.ADDONS_EDIT),re=X||Z($.ADDONS_DEACTIVATE),le=X||Z($.ADDONS_DELETE),[ne,ce]=a.useState([]),[de,oe]=a.useState(!0),[he,me]=a.useState(1),[pe,ue]=a.useState(1),[xe,ge]=a.useState(0),[ve,ye]=a.useState({page:1,limit:10}),[je,Ne]=a.useState(""),[be,fe]=a.useState(""),[Ce,we]=a.useState(""),[Ae,Se]=a.useState(""),[Ee,Pe]=a.useState(1e5),[Me,Oe]=a.useState(!1),[Fe,ke]=a.useState(!1),[De,Te]=a.useState(!1),[Re,Ie]=a.useState(null),[$e,_e]=a.useState({name:"",description:"",price:0,currency:"INR",billingType:"recurring",billingPeriod:"monthly",billingCycleMonths:1,category:"marketing",icon:"",isActive:!0,sortOrder:0}),[Ue,qe]=a.useState(""),[ze,Le]=a.useState(!1);a.useEffect(()=>{K||(_({title:"Access Denied",description:"You don't have permission to view addons.",variant:"destructive"}),t("/rolebased"))},[K,t,_]),a.useEffect(()=>{Be()},[ve]),a.useEffect(()=>{const e=setTimeout(()=>{ye(e=>({...e,search:je,minPrice:be?parseFloat(be):void 0,maxPrice:Ce?parseFloat(Ce):void 0,billingCycleMonths:Ae?parseInt(Ae):void 0,page:1}))},300);return()=>clearTimeout(e)},[je,be,Ce,Ae]);const Be=async()=>{try{oe(!0);const e=await se.getAddons(ve);ce(e.addons),me(e.totalPages),ue(e.currentPage),ge(e.total);const s=e.maxAvailablePrice,a=Math.max(...e.addons.map(e=>e.price),0);Pe(s||a||1e5)}catch(e){}finally{oe(!1)}},Ve=()=>{_e({name:"",description:"",price:0,currency:"INR",billingType:"recurring",billingPeriod:"monthly",billingCycleMonths:1,category:"marketing",icon:"",isActive:!0,sortOrder:0}),qe("")},Ye=s=>{const a=ae[s]||q;return e.jsx(a,{className:"w-4 h-4"})};return e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"dashboard-header-responsive",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"dashboard-title-responsive",children:"Addon Management"}),e.jsx("p",{className:"text-muted-foreground mt-1 md:mt-2 text-sm md:text-base",children:"Manage vendor addon services and pricing"})]}),te&&e.jsxs(n,{onClick:()=>Oe(!0),className:"w-full sm:w-auto",children:[e.jsx(c,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Add Addon Service"}),e.jsx("span",{className:"sm:hidden",children:"Add Service"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",children:[e.jsxs(d,{className:"stats-card-responsive",children:[e.jsx(o,{className:"pb-1",children:e.jsx(h,{className:"stats-label-responsive",children:"Total Addons"})}),e.jsx(m,{className:"pt-1",children:e.jsx("div",{className:"stats-value-responsive",children:xe})})]}),e.jsxs(d,{className:"stats-card-responsive",children:[e.jsx(o,{className:"pb-1",children:e.jsx(h,{className:"stats-label-responsive",children:"Active Addons"})}),e.jsx(m,{className:"pt-1",children:e.jsx("div",{className:"stats-value-responsive text-green-600",children:ne.filter(e=>e.isActive).length})})]}),e.jsxs(d,{className:"stats-card-responsive",children:[e.jsx(o,{className:"pb-1",children:e.jsx(h,{className:"stats-label-responsive",children:"Categories"})}),e.jsx(m,{className:"pt-1",children:e.jsx("div",{className:"stats-value-responsive",children:new Set(ne.map(e=>e.category)).size})})]}),e.jsxs(d,{className:"stats-card-responsive",children:[e.jsx(o,{className:"pb-1",children:e.jsx(h,{className:"stats-label-responsive",children:"Average Price"})}),e.jsx(m,{className:"pt-1",children:e.jsxs("div",{className:"stats-value-responsive",children:["₹",ne.length>0?Math.round(ne.reduce((e,s)=>e+s.price,0)/ne.length).toLocaleString():0]})})]})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(h,{className:"text-base",children:"Filters"})}),e.jsx(m,{className:"pt-2",children:e.jsxs("div",{className:"search-container-responsive",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"relative",children:[e.jsx(p,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(u,{placeholder:"Search addons...",value:je,onChange:e=>Ne(e.target.value),className:"pl-10 h-9"})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx("div",{className:"w-48",children:e.jsx(J,{minPrice:be,maxPrice:Ce,onMinPriceChange:fe,onMaxPriceChange:we,maxPossiblePrice:Ee,currency:"INR"})}),e.jsx("div",{className:"w-36",children:e.jsx(u,{placeholder:"Billing months",type:"number",min:"0",value:Ae,onChange:e=>Se(e.target.value),className:"h-9"})}),e.jsxs(x,{value:ve.category||"all",onValueChange:e=>ye(s=>({...s,category:"all"===e?void 0:e,page:1})),children:[e.jsx(g,{className:"w-full sm:w-28 h-9",children:e.jsx(v,{placeholder:"Category"})}),e.jsxs(y,{children:[e.jsx(j,{value:"all",children:"All Categories"}),se.getCategoryOptions().map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))]})]}),e.jsxs(x,{value:void 0===ve.isActive?"all":ve.isActive.toString(),onValueChange:e=>ye(s=>({...s,isActive:"all"===e?void 0:"true"===e,page:1})),children:[e.jsx(g,{className:"w-full sm:w-28 h-9",children:e.jsx(v,{placeholder:"Status"})}),e.jsxs(y,{children:[e.jsx(j,{value:"all",children:"All Status"}),e.jsx(j,{value:"true",children:"Active"}),e.jsx(j,{value:"false",children:"Inactive"})]})]})]})]})})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(h,{className:"text-lg md:text-xl",children:"Addon Services"})}),e.jsx(m,{className:"p-0",children:de?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"table-responsive-wrapper",children:e.jsxs(z,{children:[e.jsx(L,{children:e.jsxs(B,{className:"h-10",children:[e.jsx(V,{className:"w-[50px] py-2",children:"S.no"}),e.jsx(V,{className:"min-w-[250px] py-2",children:"Name"}),e.jsx(V,{className:"min-w-[120px] py-2",children:"Category"}),e.jsx(V,{className:"min-w-[100px] py-2",children:"Price"}),e.jsx(V,{className:"min-w-[100px] py-2",children:"Billing"}),e.jsx(V,{className:"min-w-[80px] py-2",children:"Status"}),e.jsx(V,{className:"min-w-[80px] py-2",children:"Sort Order"}),(ie||re||le)&&e.jsx(V,{className:"text-right min-w-[80px] py-2",children:"Actions"})]})}),e.jsx(Y,{children:ne.map((s,a)=>{return e.jsxs(B,{className:"h-12",children:[e.jsx(H,{className:"py-2 text-center",children:10*(pe-1)+a+1}),e.jsx(H,{className:"py-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-gray-100 flex-shrink-0",children:Ye(s.category)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium truncate text-sm",children:s.name}),e.jsx("div",{className:"text-xs text-gray-500 truncate max-w-[200px]",children:s.description})]})]})}),e.jsx(H,{className:"py-2",children:e.jsx(N,{variant:"outline",className:"capitalize whitespace-nowrap text-xs",children:s.category})}),e.jsx(H,{className:"font-medium whitespace-nowrap py-2 text-sm",children:(t=s.price,i=s.currency,`${{INR:"₹",USD:"$",EUR:"€"}[i]||i} ${t.toLocaleString()}`)}),e.jsx(H,{className:"py-2",children:e.jsx(N,{variant:"secondary",className:"capitalize whitespace-nowrap text-xs",children:s.billingPeriod||`${s.billingCycleMonths||1} months`})}),e.jsx(H,{className:"py-2",children:e.jsx(N,{variant:s.isActive?"default":"secondary",className:"whitespace-nowrap text-xs",children:s.isActive?"Active":"Inactive"})}),e.jsx(H,{className:"text-center py-2 text-sm",children:s.sortOrder}),(ie||re||le)&&e.jsx(H,{className:"text-right py-2",children:e.jsxs(b,{children:[e.jsx(f,{asChild:!0,children:e.jsx(n,{variant:"ghost",size:"sm",children:e.jsx(G,{className:"w-4 h-4"})})}),e.jsxs(C,{align:"end",children:[e.jsx(w,{children:"Actions"}),e.jsx(A,{}),ie&&e.jsxs(S,{onClick:()=>(e=>{Ie(e);const s=!se.getCategoryOptions().some(s=>s.value===e.category);_e({name:e.name,description:e.description,price:e.price,currency:e.currency,billingType:e.billingType,billingPeriod:e.billingPeriod||"monthly",billingCycleMonths:e.billingCycleMonths||1,category:s?"other":e.category,icon:e.icon||"",isActive:e.isActive,sortOrder:e.sortOrder}),qe(s?e.category:""),ke(!0)})(s),children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Edit"]}),re&&e.jsx(S,{onClick:()=>(async e=>{if(re)try{const s=await se.toggleAddonStatus(e._id);ce(e=>e.map(e=>e._id===s._id?s:e)),_({title:"Success",description:`Addon ${s.isActive?"activated":"deactivated"} successfully.`})}catch(s){_({title:"Error",description:"Failed to toggle addon status. Please try again.",variant:"destructive"})}else _({title:"Permission Denied",description:"You don't have permission to toggle addon status.",variant:"destructive"})})(s),children:s.isActive?e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Activate"]})}),le&&e.jsxs(e.Fragment,{children:[e.jsx(A,{}),e.jsxs(S,{onClick:()=>(e=>{Ie(e),Te(!0)})(s),className:"text-red-600",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]})})]},s._id);var t,i})})]})}),he>1&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 p-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",10*(pe-1)+1," to ",Math.min(10*pe,xe)," of ",xe," results"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>ye(e=>({...e,page:pe-1})),disabled:pe<=1,children:"Previous"}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>ye(e=>({...e,page:pe+1})),disabled:pe>=he,children:"Next"})]})]})]})})]}),e.jsx(P,{open:Me,onOpenChange:Oe,children:e.jsxs(M,{className:"max-w-4xl max-h-[85vh] overflow-y-auto",children:[e.jsxs(O,{children:[e.jsx(F,{children:"Create New Addon Service"}),e.jsx(k,{children:"Add a new addon service that vendors can purchase to enhance their listings."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"name",children:"Name"}),e.jsx(u,{id:"name",value:$e.name,onChange:e=>_e(s=>({...s,name:e.target.value})),placeholder:"Enter addon name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"category",children:"Category"}),e.jsxs(x,{value:"other"!==$e.category&&se.getCategoryOptions().some(e=>e.value===$e.category)?$e.category:"other",onValueChange:e=>{"other"===e?(_e(e=>({...e,category:"other"})),qe("")):(_e(s=>({...s,category:e})),qe(""))},children:[e.jsx(g,{children:e.jsx(v,{})}),e.jsx(y,{children:se.getCategoryOptions().map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]}),("other"===$e.category||!se.getCategoryOptions().some(e=>e.value===$e.category))&&e.jsx(u,{id:"customCategory",placeholder:"Enter custom category",value:Ue||("other"!==$e.category?$e.category:""),onChange:e=>{const s=e.target.value;qe(s),_e(e=>({...e,category:s||"other"}))}})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"description",children:"Description"}),e.jsx(T,{id:"description",value:$e.description,onChange:e=>_e(s=>({...s,description:e.target.value})),placeholder:"Enter addon description",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"price",children:"Price"}),e.jsx(u,{id:"price",type:"number",value:$e.price,onChange:e=>_e(s=>({...s,price:Number(e.target.value)})),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"currency",children:"Currency"}),e.jsxs(x,{value:$e.currency,onValueChange:e=>_e(s=>({...s,currency:e})),children:[e.jsx(g,{children:e.jsx(v,{})}),e.jsx(y,{children:se.getCurrencyOptions().map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"billingCycleMonths",children:"Billing Period (Months) *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{id:"billingCycleMonths",type:"number",min:"1",max:"120",value:0===$e.billingCycleMonths?"":$e.billingCycleMonths,onChange:e=>{const s=parseInt(e.target.value)||1;let a="custom";a=1===s?"monthly":12===s?"yearly":`${s} months`,_e(e=>({...e,billingPeriod:a,billingCycleMonths:s}))},placeholder:0===$e.billingCycleMonths?"∞ Infinity":"Enter months",disabled:0===$e.billingCycleMonths}),e.jsx(n,{type:"button",variant:0===$e.billingCycleMonths?"default":"outline",size:"icon",onClick:()=>{const e=0===$e.billingCycleMonths?1:0;let s="custom";0===e?s="lifetime":1===e&&(s="monthly"),_e(a=>({...a,billingPeriod:s,billingCycleMonths:e}))},title:0===$e.billingCycleMonths?"Set limited":"Set infinity",children:"∞"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"sortOrder",children:"Sort Order"}),e.jsx(u,{id:"sortOrder",type:"number",value:$e.sortOrder,onChange:e=>_e(s=>({...s,sortOrder:Number(e.target.value)})),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"icon",children:"Icon (optional)"}),e.jsx(u,{id:"icon",value:$e.icon,onChange:e=>_e(s=>({...s,icon:e.target.value})),placeholder:"Icon name or URL"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{id:"isActive",checked:$e.isActive,onCheckedChange:e=>_e(s=>({...s,isActive:e}))}),e.jsx(D,{htmlFor:"isActive",children:"Active"})]})]}),e.jsxs(I,{className:"flex-col sm:flex-row gap-2",children:[e.jsx(n,{variant:"outline",onClick:()=>Oe(!1),className:"w-full sm:w-auto order-2 sm:order-1",children:"Cancel"}),e.jsx(n,{onClick:async()=>{if(te)try{Le(!0);const e=await se.createAddon($e);Oe(!1),Ve(),ce(s=>[e,...s]),ge(e=>e+1),_({title:"Success",description:"Addon created successfully."})}catch(e){_({title:"Error",description:"Failed to create addon. Please try again.",variant:"destructive"})}finally{Le(!1)}else _({title:"Permission Denied",description:"You don't have permission to create addons.",variant:"destructive"})},disabled:ze,className:"w-full sm:w-auto order-1 sm:order-2",children:ze?"Creating...":"Create Addon"})]})]})}),e.jsx(P,{open:Fe,onOpenChange:ke,children:e.jsxs(M,{className:"max-w-4xl max-h-[85vh] overflow-y-auto",children:[e.jsxs(O,{children:[e.jsx(F,{children:"Edit Addon Service"}),e.jsx(k,{children:"Update the addon service details."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"edit-name",children:"Name"}),e.jsx(u,{id:"edit-name",value:$e.name,onChange:e=>_e(s=>({...s,name:e.target.value})),placeholder:"Enter addon name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"edit-category",children:"Category"}),e.jsxs(x,{value:"other"!==$e.category&&se.getCategoryOptions().some(e=>e.value===$e.category)?$e.category:"other",onValueChange:e=>{"other"===e?(_e(e=>({...e,category:"other"})),qe("")):(_e(s=>({...s,category:e})),qe(""))},children:[e.jsx(g,{children:e.jsx(v,{})}),e.jsx(y,{children:se.getCategoryOptions().map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]}),("other"===$e.category||!se.getCategoryOptions().some(e=>e.value===$e.category))&&e.jsx(u,{id:"editCustomCategory",placeholder:"Enter custom category",value:Ue||("other"!==$e.category?$e.category:""),onChange:e=>{const s=e.target.value;qe(s),_e(e=>({...e,category:s||"other"}))}})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"edit-description",children:"Description"}),e.jsx(T,{id:"edit-description",value:$e.description,onChange:e=>_e(s=>({...s,description:e.target.value})),placeholder:"Enter addon description",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"edit-price",children:"Price"}),e.jsx(u,{id:"edit-price",type:"number",value:$e.price,onChange:e=>_e(s=>({...s,price:Number(e.target.value)})),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"edit-currency",children:"Currency"}),e.jsxs(x,{value:$e.currency,onValueChange:e=>_e(s=>({...s,currency:e})),children:[e.jsx(g,{children:e.jsx(v,{})}),e.jsx(y,{children:se.getCurrencyOptions().map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"edit-billingCycleMonths",children:"Billing Period (Months) *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{id:"edit-billingCycleMonths",type:"number",min:"1",max:"120",value:0===$e.billingCycleMonths?"":$e.billingCycleMonths,onChange:e=>{const s=parseInt(e.target.value)||1;let a="custom";a=1===s?"monthly":12===s?"yearly":`${s} months`,_e(e=>({...e,billingPeriod:a,billingCycleMonths:s}))},placeholder:0===$e.billingCycleMonths?"∞ Infinity":"Enter months",disabled:0===$e.billingCycleMonths}),e.jsx(n,{type:"button",variant:0===$e.billingCycleMonths?"default":"outline",size:"icon",onClick:()=>{const e=0===$e.billingCycleMonths?1:0;let s="custom";0===e?s="lifetime":1===e&&(s="monthly"),_e(a=>({...a,billingPeriod:s,billingCycleMonths:e}))},title:0===$e.billingCycleMonths?"Set limited":"Set infinity",children:"∞"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"edit-sortOrder",children:"Sort Order"}),e.jsx(u,{id:"edit-sortOrder",type:"number",value:$e.sortOrder,onChange:e=>_e(s=>({...s,sortOrder:Number(e.target.value)})),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"edit-icon",children:"Icon (optional)"}),e.jsx(u,{id:"edit-icon",value:$e.icon,onChange:e=>_e(s=>({...s,icon:e.target.value})),placeholder:"Icon name or URL"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{id:"edit-isActive",checked:$e.isActive,onCheckedChange:e=>_e(s=>({...s,isActive:e}))}),e.jsx(D,{htmlFor:"edit-isActive",children:"Active"})]})]}),e.jsxs(I,{className:"flex-col sm:flex-row gap-2",children:[e.jsx(n,{variant:"outline",onClick:()=>ke(!1),className:"w-full sm:w-auto order-2 sm:order-1",children:"Cancel"}),e.jsx(n,{onClick:async()=>{if(Re)if(ie)try{Le(!0);const e=await se.updateAddon(Re._id,$e);ke(!1),Ie(null),Ve(),ce(s=>s.map(s=>s._id===e._id?e:s)),_({title:"Success",description:"Addon updated successfully."})}catch(e){_({title:"Error",description:"Failed to update addon. Please try again.",variant:"destructive"})}finally{Le(!1)}else _({title:"Permission Denied",description:"You don't have permission to edit addons.",variant:"destructive"})},disabled:ze,className:"w-full sm:w-auto order-1 sm:order-2",children:ze?"Updating...":"Update Addon"})]})]})}),e.jsx(P,{open:De,onOpenChange:Te,children:e.jsxs(M,{children:[e.jsxs(O,{children:[e.jsx(F,{children:"Delete Addon Service"}),e.jsxs(k,{children:['Are you sure you want to delete "',Re?.name,'"? This action cannot be undone.']})]}),e.jsxs(I,{children:[e.jsx(n,{variant:"outline",onClick:()=>Te(!1),children:"Cancel"}),e.jsx(n,{variant:"destructive",onClick:async()=>{if(Re)if(le)try{Le(!0),await se.deleteAddon(Re._id),Te(!1);const e=Re._id;Ie(null),ce(s=>s.filter(s=>s._id!==e)),ge(e=>e-1),_({title:"Success",description:"Addon deleted successfully."})}catch(e){_({title:"Error",description:"Failed to delete addon. Please try again.",variant:"destructive"})}finally{Le(!1)}else _({title:"Permission Denied",description:"You don't have permission to delete addons.",variant:"destructive"})},disabled:ze,children:ze?"Deleting...":"Delete"})]})]})})]})};export{te as default};
