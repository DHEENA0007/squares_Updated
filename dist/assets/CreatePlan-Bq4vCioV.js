import{j as e}from"./ui-DYmpZ3pJ.js";import{d as w,r as g}from"./router-2SVJvIbS.js";import{D as B,f as o,a as f,b as N,c as y,e as C,I as l,p as m,q as h,r as p,s as x,v as t,A as S,X as M}from"./index-BbgqWuYN.js";import{L as r}from"./label-DRahLfWI.js";import{T as A}from"./textarea-Cl1lQCIh.js";import{C as d}from"./checkbox-BWX4lU0d.js";import{p as R}from"./planService-nsbzt5Yw.js";import{A as T}from"./arrow-left-T_MLY8cb.js";import{L as D}from"./loader-circle-DtIJ61xE.js";import"./vendor-Dazix4UH.js";const Y=()=>{const u=w(),{toast:b}=B(),[F,P]=g.useState(!1),[n,j]=g.useState({name:"",description:""}),[s,a]=g.useState({identifier:"",name:"",description:"",price:0,currency:"INR",billingPeriod:"monthly",features:[],limits:{properties:5,featuredListings:0,photos:10,videoTours:0,videos:0,leads:0,posters:0,topRated:!1,verifiedBadge:!1,messages:100,marketingManager:!1,commissionBased:!1,support:"email",leadManagement:"basic"},isActive:!0,isPopular:!1,sortOrder:0}),k=async i=>{if(i.preventDefault(),!s.identifier.trim()){b({title:"Error",description:"Plan identifier is required",variant:"destructive"});return}if(s.features.length===0){b({title:"Error",description:"Please add at least one feature",variant:"destructive"});return}try{P(!0),await R.createPlan(s),u("/admin/plans")}catch(c){console.error("Failed to create plan:",c)}finally{P(!1)}},v=()=>{n.name.trim()&&(a({...s,features:[...s.features,{...n,enabled:!0}]}),j({name:"",description:""}))},L=i=>{a({...s,features:s.features.filter((c,I)=>I!==i)})};return e.jsxs("div",{className:"space-y-6 relative top-[60px]",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(o,{variant:"ghost",size:"icon",onClick:()=>u("/admin/plans"),children:e.jsx(T,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Create New Plan"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Add a new subscription plan"})]})]}),e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsxs(f,{children:[e.jsx(N,{children:e.jsx(y,{children:"Basic Information"})}),e.jsxs(C,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"identifier",children:"Plan Identifier *"}),e.jsx(l,{id:"identifier",placeholder:"e.g., free, basic, premium",value:s.identifier,onChange:i=>a({...s,identifier:i.target.value.toLowerCase().replace(/\s+/g,"-")}),required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Unique identifier for the plan (lowercase, no spaces)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"name",children:"Plan Name *"}),e.jsx(l,{id:"name",placeholder:"e.g., Free Listing, Premium",value:s.name,onChange:i=>a({...s,name:i.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(r,{htmlFor:"description",children:"Description *"}),e.jsx(A,{id:"description",placeholder:"Describe the plan benefits...",value:s.description,onChange:i=>a({...s,description:i.target.value}),required:!0,rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"price",children:"Price *"}),e.jsx(l,{id:"price",type:"number",step:"0.01",min:"0",value:s.price,onChange:i=>a({...s,price:parseFloat(i.target.value)||0}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"currency",children:"Currency"}),e.jsxs(m,{value:s.currency,onValueChange:i=>a({...s,currency:i}),children:[e.jsx(h,{children:e.jsx(p,{})}),e.jsxs(x,{children:[e.jsx(t,{value:"INR",children:"INR (₹)"}),e.jsx(t,{value:"USD",children:"USD ($)"}),e.jsx(t,{value:"EUR",children:"EUR (€)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"billing",children:"Billing Period *"}),e.jsxs(m,{value:s.billingPeriod,onValueChange:i=>a({...s,billingPeriod:i}),children:[e.jsx(h,{children:e.jsx(p,{})}),e.jsxs(x,{children:[e.jsx(t,{value:"monthly",children:"Monthly"}),e.jsx(t,{value:"yearly",children:"Yearly"}),e.jsx(t,{value:"lifetime",children:"Lifetime"}),e.jsx(t,{value:"one-time",children:"One-time"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"sortOrder",children:"Sort Order"}),e.jsx(l,{id:"sortOrder",type:"number",min:"0",value:s.sortOrder,onChange:i=>a({...s,sortOrder:parseInt(i.target.value)||0})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Lower numbers appear first"})]})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(d,{id:"isActive",checked:s.isActive,onCheckedChange:i=>a({...s,isActive:i})}),e.jsx(r,{htmlFor:"isActive",className:"cursor-pointer",children:"Active"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(d,{id:"isPopular",checked:s.isPopular,onCheckedChange:i=>a({...s,isPopular:i})}),e.jsx(r,{htmlFor:"isPopular",className:"cursor-pointer",children:"Mark as Popular"})]})]})]})]}),e.jsxs(f,{children:[e.jsx(N,{children:e.jsx(y,{children:"Limits & Benefits"})}),e.jsxs(C,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"properties",children:"Properties Limit"}),e.jsx(l,{id:"properties",type:"number",min:"-1",value:s.limits.properties,onChange:i=>a({...s,limits:{...s.limits,properties:parseInt(i.target.value)||0}})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"0 = unlimited, -1 = no properties"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"leads",children:"Leads Limit"}),e.jsx(l,{id:"leads",type:"number",min:"0",value:s.limits.leads,onChange:i=>a({...s,limits:{...s.limits,leads:parseInt(i.target.value)||0}})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Monthly limit, 0 = unlimited"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"posters",children:"Promotional Posters"}),e.jsx(l,{id:"posters",type:"number",min:"0",value:s.limits.posters,onChange:i=>a({...s,limits:{...s.limits,posters:parseInt(i.target.value)||0}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"featuredListings",children:"Featured Listings"}),e.jsx(l,{id:"featuredListings",type:"number",min:"0",value:s.limits.featuredListings,onChange:i=>a({...s,limits:{...s.limits,featuredListings:parseInt(i.target.value)||0}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"photos",children:"Photos per Property"}),e.jsx(l,{id:"photos",type:"number",min:"0",value:s.limits.photos,onChange:i=>a({...s,limits:{...s.limits,photos:parseInt(i.target.value)||0}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"videoTours",children:"Video Tours"}),e.jsx(l,{id:"videoTours",type:"number",min:"0",value:s.limits.videoTours,onChange:i=>a({...s,limits:{...s.limits,videoTours:parseInt(i.target.value)||0}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"videos",children:"Videos"}),e.jsx(l,{id:"videos",type:"number",min:"0",value:s.limits.videos,onChange:i=>a({...s,limits:{...s.limits,videos:parseInt(i.target.value)||0}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"messages",children:"Monthly Messages"}),e.jsx(l,{id:"messages",type:"number",min:"0",value:s.limits.messages,onChange:i=>a({...s,limits:{...s.limits,messages:parseInt(i.target.value)||0}})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"0 = unlimited"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"support",children:"Support Level"}),e.jsxs(m,{value:s.limits.support,onValueChange:i=>a({...s,limits:{...s.limits,support:i}}),children:[e.jsx(h,{children:e.jsx(p,{})}),e.jsxs(x,{children:[e.jsx(t,{value:"none",children:"None"}),e.jsx(t,{value:"email",children:"Email"}),e.jsx(t,{value:"priority",children:"Priority"}),e.jsx(t,{value:"phone",children:"Phone"}),e.jsx(t,{value:"dedicated",children:"Dedicated"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"leadManagement",children:"Lead Management"}),e.jsxs(m,{value:s.limits.leadManagement,onValueChange:i=>a({...s,limits:{...s.limits,leadManagement:i}}),children:[e.jsx(h,{children:e.jsx(p,{})}),e.jsxs(x,{children:[e.jsx(t,{value:"none",children:"None"}),e.jsx(t,{value:"basic",children:"Basic"}),e.jsx(t,{value:"advanced",children:"Advanced"}),e.jsx(t,{value:"premium",children:"Premium"}),e.jsx(t,{value:"enterprise",children:"Enterprise"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold",children:"Benefits"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(d,{id:"topRated",checked:s.limits.topRated,onCheckedChange:i=>a({...s,limits:{...s.limits,topRated:i}})}),e.jsx(r,{htmlFor:"topRated",className:"cursor-pointer",children:"Top Rated in Website"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(d,{id:"verifiedBadge",checked:s.limits.verifiedBadge,onCheckedChange:i=>a({...s,limits:{...s.limits,verifiedBadge:i}})}),e.jsx(r,{htmlFor:"verifiedBadge",className:"cursor-pointer",children:"Verified Owner Badge"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(d,{id:"marketing",checked:s.limits.marketingManager,onCheckedChange:i=>a({...s,limits:{...s.limits,marketingManager:i}})}),e.jsx(r,{htmlFor:"marketing",className:"cursor-pointer",children:"Marketing Manager Access"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(d,{id:"commission",checked:s.limits.commissionBased,onCheckedChange:i=>a({...s,limits:{...s.limits,commissionBased:i}})}),e.jsx(r,{htmlFor:"commission",className:"cursor-pointer",children:"Commission Based"})]})]})]})]})]}),e.jsxs(f,{children:[e.jsx(N,{children:e.jsx(y,{children:"Features"})}),e.jsxs(C,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{placeholder:"Feature name...",value:n.name,onChange:i=>j({...n,name:i.target.value}),onKeyPress:i=>i.key==="Enter"&&(i.preventDefault(),v()),className:"flex-1"}),e.jsx(l,{placeholder:"Description (optional)",value:n.description,onChange:i=>j({...n,description:i.target.value}),onKeyPress:i=>i.key==="Enter"&&(i.preventDefault(),v()),className:"flex-1"}),e.jsx(o,{type:"button",onClick:v,size:"icon",children:e.jsx(S,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-2",children:[s.features.map((i,c)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:i.name}),i.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:i.description})]}),e.jsx(o,{type:"button",variant:"ghost",size:"icon",onClick:()=>L(c),children:e.jsx(M,{className:"w-4 h-4"})})]},c)),s.features.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No features added yet. Add at least one feature."})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(o,{type:"submit",disabled:F,children:[F&&e.jsx(D,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Plan"]}),e.jsx(o,{type:"button",variant:"outline",onClick:()=>u("/admin/plans"),children:"Cancel"})]})]})]})};export{Y as default};
