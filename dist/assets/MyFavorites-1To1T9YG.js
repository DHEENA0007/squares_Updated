import{j as e}from"./ui-CEt46o3G.js";import{d as U,r as l,L as k}from"./router-2SVJvIbS.js";import{C as v,d as j}from"./card-YvDMUmzt.js";import{c as O,O as Q,t as u,R as F,a as c,$ as y,I as W,L as P,S as G,M as L,B as w}from"./index-CiYV0Sy0.js";import{C as H}from"./checkbox-6USSAlb1.js";import{S as J,a as K,b as X,c as Y,d as g}from"./select-BHWxeluH.js";import{f as x}from"./favoriteService-DXlS-i7P.js";import{a as Z}from"./propertyUtils-B_5yebUt.js";import{T as $}from"./trash-2-Dj_If1Zn.js";import{F as ee}from"./filter-pPW3lLKU.js";import{C as se}from"./calendar-DWj9NFdt.js";import{S as te}from"./share-CNllRTD6.js";import"./vendor-Dazix4UH.js";import"./index-DHzxUTm5.js";import"./index-BdQq_4o_.js";import"./chevron-down-DeDu0PPf.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=O("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]),Ne=()=>{const{isConnected:S}=Q(),C=U(),[A,E]=l.useState([]),[f,M]=l.useState(null),[_,R]=l.useState(!0),[h,D]=l.useState(""),[i,T]=l.useState("all"),[r,N]=l.useState([]),n=l.useCallback(async()=>{try{const t=await x.getFavorites();E(t.data.favorites)}catch(t){console.error("Error loading favorites:",t),u({title:"Error",description:"Failed to load favorites",variant:"destructive"})}finally{R(!1)}},[]),o=l.useCallback(async()=>{try{const t=await x.getFavoriteStats();M(t.data)}catch(t){console.error("Error loading stats:",t)}},[]);F("favorite_added",l.useCallback(t=>{console.log("Favorite added:",t),n(),o()},[n,o])),F("favorite_removed",l.useCallback(t=>{console.log("Favorite removed:",t),n(),o()},[n,o])),l.useEffect(()=>{n(),o()},[]);const V=async t=>{try{await x.removeFromFavorites(t),await n(),await o(),u({title:"Success",description:"Property removed from favorites"})}catch(s){console.error("Error removing favorite:",s),u({title:"Error",description:"Failed to remove from favorites",variant:"destructive"})}},q=t=>{N(s=>s.includes(t)?s.filter(p=>p!==t):[...s,t])},z=async()=>{try{await Promise.all(r.map(t=>x.removeFromFavorites(t))),N([]),await n(),await o(),u({title:"Success",description:`${r.length} properties removed from favorites`})}catch(t){console.error("Error removing selected favorites:",t),u({title:"Error",description:"Failed to remove selected favorites",variant:"destructive"})}},B=()=>{if(r.length<1){u({title:"Select Properties",description:"Please select at least 1 property to compare",variant:"destructive"});return}C(`/customer/compare?properties=${r.join(",")}`)},d=A.filter(t=>{const s=t.property;if(!s)return!1;const p=typeof s.address=="string"?s.address:`${s.address.street||""} ${s.address.city||""} ${s.address.state||""}`.trim(),b=typeof s.city=="string"?s.city:s.address?.city||"",a=!h||s.title.toLowerCase().includes(h.toLowerCase())||p.toLowerCase().includes(h.toLowerCase())||b.toLowerCase().includes(h.toLowerCase()),m=!i||i==="all"||i==="available"&&(s.status==="available"||s.status==="active")||i==="sold"&&s.status==="sold"||i==="rented"&&s.status==="rented"||i==="recent"&&new Date(t.createdAt)>new Date(Date.now()-10080*60*1e3);return a&&m});return _?e.jsx("div",{className:"min-h-screen bg-background p-6 pt-24",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-lg",children:"Loading favorites..."})})})}):e.jsx("div",{className:"min-h-screen bg-background p-6 pt-24",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"My Favorites"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your saved properties and track your preferences"})]}),r.length>0&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:"outline",onClick:B,disabled:r.length<1,className:"w-fit",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Compare (",r.length,")"]}),e.jsxs(c,{variant:"destructive",onClick:z,className:"w-fit",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Remove Selected (",r.length,")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-muted/50 p-3 rounded-lg",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${S?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-sm text-muted-foreground",children:S?"Real-time favorite updates active":"Offline mode"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(W,{placeholder:"Search favorites...",value:h,onChange:t=>D(t.target.value),className:"w-full"})}),e.jsxs("div",{className:"flex gap-2",children:[d.length>0&&e.jsx(c,{variant:"outline",size:"sm",onClick:()=>{r.length===d.length?N([]):N(d.map(t=>t.property._id))},children:r.length===d.length?"Deselect All":"Select All"}),e.jsxs(J,{value:i,onValueChange:T,children:[e.jsx(K,{className:"w-full md:w-48",children:e.jsx(X,{placeholder:"Filter by status"})}),e.jsxs(Y,{children:[e.jsx(g,{value:"all",children:"All Properties"}),e.jsx(g,{value:"available",children:"Available"}),e.jsx(g,{value:"sold",children:"Sold"}),e.jsx(g,{value:"rented",children:"Rented"}),e.jsx(g,{value:"recent",children:"Recently Added"})]})]})]})]}),f&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(v,{children:e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-500/10 rounded-lg",children:e.jsx(P,{className:"w-5 h-5 text-red-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:f.totalFavorites}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Favorites"})]})]})})}),e.jsx(v,{children:e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(ae,{className:"w-5 h-5 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:f?.avgPrice?x.formatPrice(f.avgPrice):"₹0"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Price"})]})]})})}),e.jsx(v,{children:e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(ee,{className:"w-5 h-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:f?.availableProperties||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Still Available"})]})]})})})]}),d.length>0&&r.length===0&&e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5 text-blue-600"}),e.jsxs("span",{className:"text-sm text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Tip:"})," Select properties using the checkboxes to compare them side-by-side (unlimited selection)"]})]})}),e.jsx("div",{className:"space-y-4",children:d.length===0?e.jsx(v,{children:e.jsxs(j,{className:"p-12 text-center",children:[e.jsx(P,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No favorites found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:h||i&&i!=="all"?"No properties match your search criteria":"Start adding properties to your favorites to see them here"}),e.jsx(k,{to:"/customer/search",children:e.jsxs(c,{children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Search Properties"]})})]})}):d.map(t=>{const s=t.property;if(!s)return null;const p=x.getPropertyStatusBadge(s),b=s.images&&s.images.length>0?typeof s.images[0]=="string"?s.images[0]:s.images[0].url:null;return e.jsx(v,{className:`hover:shadow-lg transition-all ${r.includes(s._id)?"ring-2 ring-primary bg-primary/5":""}`,children:e.jsx(j,{className:"p-0",children:e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsxs("div",{className:"md:w-80 h-64 md:h-48 bg-muted flex items-center justify-center relative",children:[b?e.jsx("img",{src:b,alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-12 h-12 bg-primary/20 rounded-lg flex items-center justify-center",children:e.jsx(L,{className:"w-6 h-6 text-primary"})}),e.jsx("div",{className:"absolute top-2 left-2 flex flex-col gap-1",children:e.jsx(w,{variant:p.variant,children:p.label})}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(H,{checked:r.includes(s._id),onCheckedChange:()=>q(s._id),className:"bg-white"})})]}),e.jsxs("div",{className:"flex-1 p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:s.title}),e.jsxs("div",{className:"flex items-center text-muted-foreground mb-2",children:[e.jsx(L,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"text-sm",children:typeof s.address=="string"?s.address:`${s.address.street||""}, ${s.address.city||""}, ${s.address.state||""}`})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:x.formatPrice(s.price)}),(()=>{const a=s?.area;if(!a)return null;if(typeof a=="object"&&a!==null){const m=a.builtUp||a.carpet||a.plot||1;return e.jsxs("p",{className:"text-sm text-muted-foreground",children:["₹",Math.round(s.price/m),"/sq ft"]})}return typeof a=="number"?e.jsxs("p",{className:"text-sm text-muted-foreground",children:["₹",Math.round(s.price/a),"/sq ft"]}):null})()]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 text-sm text-muted-foreground",children:[(()=>{const a=s?.area;if(!a)return null;if(typeof a=="object"&&a!==null){const m=a.builtUp||a.carpet||a.plot||0,I=a.unit||"sq ft";return e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:[m," ",I]})})}return typeof a=="number"?e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:[a," sq ft"]})}):null})(),s.bedrooms&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:[s.bedrooms," bed"]})}),s.bathrooms&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:[s.bathrooms," bath"]})})]}),s.amenities&&s.amenities.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-4",children:[s.amenities.slice(0,3).map((a,m)=>e.jsx(w,{variant:"outline",className:"text-xs",children:a},m)),s.amenities.length>3&&e.jsxs(w,{variant:"outline",className:"text-xs",children:["+",s.amenities.length-3," more"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground mb-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"w-3 h-3"}),e.jsxs("span",{children:["Added ",new Date(t.createdAt).toLocaleDateString()]})]}),s.owner&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("span",{children:Z(s)})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{size:"sm",variant:"outline",onClick:()=>{navigator.share&&navigator.share({title:s.title,text:`Check out this property: ${s.title}`,url:window.location.href})},children:e.jsx(te,{className:"w-4 h-4"})}),e.jsxs(c,{size:"sm",variant:"outline",onClick:()=>{const a=[s._id];C(`/customer/compare?properties=${a.join(",")}`)},children:[e.jsx(y,{className:"w-4 h-4 mr-1"}),"Compare"]}),e.jsx(k,{to:`/customer/property/${s._id}`,children:e.jsx(c,{size:"sm",variant:"outline",children:"View Details"})})]}),e.jsxs(c,{size:"sm",variant:"destructive",onClick:()=>V(s._id),children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Remove"]})]})]})]})})},t._id)})})]})})};export{Ne as default};
