import{j as e}from"./ui-DHQhougw.js";import{r as s,d as a}from"./router-Bi51YGN-.js";import{z as l,u as i,K as t,O as r,B as d,f as c,E as n,Q as m,R as o,V as x,W as h,Y as j,a as u,b as p,c as f,w as N,e as g,h as v,S as y,q as b,r as w,s as C,v as S,Z as U,I as A}from"./index-BXXWUbfo.js";import{u as k}from"./use-mobile-WsBtvUz6.js";import{T as P,a as V,b as D,c as E,d as _,e as z}from"./table-BBRox6go.js";import{P as F,a as R,b as T,c as I,d as M,e as Q}from"./pagination-4Yeq-L1v.js";import{A as B,a as L,b as O,c as W,d as q,e as K,f as Y,g as Z,h as G}from"./alert-dialog-Du5m8ixH.js";import{T as H}from"./trash-2-Vx1507RH.js";import{S as J}from"./shield-CHxDQaVC.js";import{A as X}from"./activity-CrVuUd4h.js";import{C as $}from"./calendar-DvgVTGqB.js";import"./vendor-eVk5PToZ.js";import"./ellipsis-Cwu7I5jj.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=l("CircleArrowUp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]),se=({searchQuery:a})=>{const{isSuperAdmin:l}=i(),U=k(),[A,se]=s.useState(1),[ae,le]=s.useState([]),[ie,te]=s.useState(!0),[re,de]=s.useState(0),[ce,ne]=s.useState(0),[me,oe]=s.useState(null),[xe,he]=s.useState(null),[je,ue]=s.useState(!1),[pe,fe]=s.useState(!1),[Ne,ge]=s.useState(null),[ve,ye]=s.useState("");s.useEffect(()=>{(async()=>{te(!0);try{const e=await r.getUsers({page:A,limit:10,search:a||void 0});e.success&&(le(e.data.users),de(e.data.pagination.totalPages),ne(e.data.pagination.totalUsers))}catch(e){}finally{te(!1)}})()},[A,a]);return ie?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(t,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2 text-lg",children:"Loading users..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md border overflow-x-auto",children:e.jsxs(P,{className:U?"min-w-[450px]":"",children:[e.jsx(V,{children:e.jsxs(D,{children:[e.jsx(E,{className:U?"text-xs":"",children:"Name"}),e.jsx(E,{className:U?"text-xs":"",children:"Email"}),e.jsx(E,{className:"hidden md:table-cell "+(U?"text-xs":""),children:"Phone"}),e.jsx(E,{className:"hidden sm:table-cell "+(U?"text-xs":""),children:"Role"}),e.jsx(E,{className:"hidden lg:table-cell "+(U?"text-xs":""),children:"Status"}),e.jsx(E,{className:"hidden lg:table-cell "+(U?"text-xs":""),children:"Created"}),e.jsx(E,{className:"text-right "+(U?"text-xs":""),children:"Actions"})]})}),e.jsx(_,{children:0===ae.length?e.jsx(D,{children:e.jsx(z,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No users found."})}):ae.map(s=>e.jsxs(D,{children:[e.jsx(z,{className:"font-medium "+(U?"text-xs":""),children:r.getFullName(s)}),e.jsx(z,{className:U?"text-xs":"",children:s.email}),e.jsx(z,{className:"hidden md:table-cell "+(U?"text-xs":""),children:s.profile.phone||"-"}),e.jsx(z,{className:"hidden sm:table-cell "+(U?"text-xs":""),children:e.jsx(d,{variant:"admin"===s.role?"default":"secondary",className:U?"text-xs px-1 py-0":"",children:s.role})}),e.jsx(z,{className:"hidden lg:table-cell "+(U?"text-xs":""),children:e.jsx(d,{variant:"active"===s.status?"default":"pending"===s.status?"secondary":"destructive",className:U?"text-xs px-1 py-0":"",children:s.status})}),e.jsx(z,{className:"hidden lg:table-cell "+(U?"text-xs":""),children:r.formatCreationDate(s.createdAt)}),e.jsx(z,{className:"text-right "+(U?"text-xs":""),children:e.jsxs("div",{className:"flex justify-end gap-1 "+(U?"gap-0.5":"gap-2"),children:[e.jsx(c,{variant:"ghost",size:U?"sm":"icon",onClick:()=>(e=>{he(e),ue(!0)})(s),title:"View User Details",className:U?"h-6 w-6 p-1":"",children:e.jsx(n,{className:U?"h-3 w-3":"h-4 w-4"})}),l&&e.jsx(c,{variant:"ghost",size:U?"sm":"icon",onClick:()=>(e=>{he(e),ye(e.role),fe(!0)})(s),title:"Promote User",className:U?"h-6 w-6 p-1":"",children:e.jsx(ee,{className:U?"h-3 w-3":"h-4 w-4"})}),e.jsxs(B,{children:[e.jsx(L,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:U?"sm":"icon",className:U?"h-6 w-6 p-1":"",children:e.jsx(H,{className:U?"h-3 w-3":"h-4 w-4"})})}),e.jsxs(O,{children:[e.jsxs(W,{children:[e.jsx(q,{children:"Are you absolutely sure?"}),e.jsx(K,{children:"This action cannot be undone. This will permanently delete the user account and remove their data from our servers."})]}),e.jsxs(Y,{children:[e.jsx(Z,{children:"Cancel"}),e.jsxs(G,{onClick:()=>(async e=>{oe(e);try{await r.deleteUser(e);const s=await r.getUsers({page:A,limit:10,search:a||void 0});s.success&&(le(s.data.users),de(s.data.pagination.totalPages),ne(s.data.pagination.totalUsers))}catch(s){}finally{oe(null)}})(s._id),disabled:me===s._id,children:[me===s._id?e.jsx(t,{className:"h-4 w-4 animate-spin mr-2"}):null,"Delete"]})]})]})]})]})})]},s._id))})]})}),re>1&&e.jsx(F,{className:"mt-4",children:e.jsxs(R,{children:[e.jsx(T,{children:e.jsx(I,{onClick:()=>se(e=>Math.max(1,e-1)),className:1===A?"pointer-events-none opacity-50":"cursor-pointer"})}),[...Array(re)].map((s,a)=>{const l=a+1;return 1===l||l===re||l>=A-1&&l<=A+1?e.jsx(T,{children:e.jsx(M,{onClick:()=>se(l),isActive:A===l,className:"cursor-pointer",children:l})},l):l===A-2||l===A+2?e.jsx(T,{children:"..."},l):null}),e.jsx(T,{children:e.jsx(Q,{onClick:()=>se(e=>Math.min(re,e+1)),className:A===re?"pointer-events-none opacity-50":"cursor-pointer"})})]})}),e.jsx(m,{open:je,onOpenChange:ue,children:e.jsxs(o,{className:(U?"max-w-[95vw] max-h-[95vh]":"max-w-4xl max-h-[90vh]")+" overflow-y-auto",children:[e.jsxs(x,{children:[e.jsx(h,{children:"User Details"}),e.jsxs(j,{children:["Complete information about ",xe?r.getFullName(xe):"user"]})]}),xe&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(u,{children:[e.jsx(p,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5"}),"Basic Information"]})}),e.jsx(g,{className:"space-y-3",children:e.jsxs("div",{className:"grid gap-4 "+(U?"grid-cols-1":"grid-cols-1 md:grid-cols-2"),children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Full Name"}),e.jsx("p",{className:"text-base",children:r.getFullName(xe)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),e.jsx("p",{className:"text-base",children:xe.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Phone"}),e.jsx("p",{className:"text-base",children:xe.profile?.phone||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"User ID"}),e.jsx("p",{className:"text-base font-mono text-sm",children:xe._id})]})]})})]}),e.jsxs(u,{children:[e.jsx(p,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5"}),"Account Status"]})}),e.jsx(g,{className:"space-y-3",children:e.jsxs("div",{className:"grid gap-4 "+(U?"grid-cols-1":"grid-cols-1 md:grid-cols-2"),children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Role"}),e.jsx(d,{variant:"admin"===xe.role?"default":"secondary",className:"mt-1",children:xe.role})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsx(d,{variant:"active"===xe.status?"default":"pending"===xe.status?"secondary":"destructive",className:"mt-1",children:xe.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Email Verified"}),e.jsx(d,{variant:xe.profile?.emailVerified?"default":"destructive",className:"mt-1",children:xe.profile?.emailVerified?"Verified":"Not Verified"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Phone Verified"}),e.jsx(d,{variant:xe.profile?.phoneVerified?"default":"destructive",className:"mt-1",children:xe.profile?.phoneVerified?"Verified":"Not Verified"})]})]})})]}),xe.profile?.address&&e.jsxs(u,{children:[e.jsx(p,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-5 h-5"}),"Address Information"]})}),e.jsx(g,{className:"space-y-3",children:e.jsxs("div",{className:"grid gap-4 "+(U?"grid-cols-1":"grid-cols-1 md:grid-cols-2"),children:[xe.profile?.address?.street&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Street"}),e.jsx("p",{className:"text-base",children:xe.profile.address.street})]}),xe.profile?.address?.city&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"City"}),e.jsx("p",{className:"text-base",children:xe.profile.address.city})]}),xe.profile?.address?.state&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"State"}),e.jsx("p",{className:"text-base",children:xe.profile.address.state})]}),xe.profile?.address?.zipCode&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Pincode"}),e.jsx("p",{className:"text-base",children:xe.profile.address.zipCode})]})]})})]}),e.jsxs(u,{children:[e.jsx(p,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5"}),"User Preferences"]})}),e.jsxs(g,{className:"space-y-3",children:[e.jsxs("div",{className:"grid gap-4 "+(U?"grid-cols-1":"grid-cols-1 md:grid-cols-2"),children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Language"}),e.jsx("p",{className:"text-base",children:"Not available"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Currency"}),e.jsx("p",{className:"text-base",children:"Not available"})]})]}),xe.profile?.preferences?.notifications&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Notification Preferences"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(d,{variant:xe.profile.preferences.notifications.email?"default":"secondary",children:["Email: ",xe.profile.preferences.notifications.email?"Enabled":"Disabled"]}),e.jsxs(d,{variant:xe.profile.preferences.notifications.sms?"default":"secondary",children:["SMS: ",xe.profile.preferences.notifications.sms?"Enabled":"Disabled"]}),e.jsxs(d,{variant:xe.profile.preferences.notifications.push?"default":"secondary",children:["Push: ",xe.profile.preferences.notifications.push?"Enabled":"Disabled"]})]})]})]})]}),e.jsxs(u,{children:[e.jsx(p,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5"}),"Account Timeline"]})}),e.jsx(g,{className:"space-y-3",children:e.jsxs("div",{className:"grid gap-4 "+(U?"grid-cols-1":"grid-cols-1 md:grid-cols-2"),children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Created At"}),e.jsx("p",{className:"text-base",children:r.formatCreationDate(xe.createdAt)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Last Updated"}),e.jsx("p",{className:"text-base",children:r.formatCreationDate(xe.updatedAt)})]})]})})]}),e.jsxs(u,{children:[e.jsx(p,{children:e.jsx(f,{children:"Quick Actions"})}),e.jsx(g,{children:e.jsx("div",{className:"flex gap-2 flex-wrap",children:e.jsx(c,{variant:"outline",size:"sm",onClick:()=>ue(!1),children:"Close"})})})]})]})]})}),e.jsx(m,{open:pe,onOpenChange:fe,children:e.jsxs(o,{children:[e.jsxs(x,{children:[e.jsx(h,{children:"Promote User"}),e.jsxs(j,{children:["Change the role of ",xe?r.getFullName(xe):"user"]})]}),xe&&e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Current Role"}),e.jsx(d,{variant:"secondary",children:xe.role})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"New Role"}),e.jsxs(y,{value:ve,onValueChange:ye,children:[e.jsx(b,{children:e.jsx(w,{placeholder:"Select a role"})}),e.jsx(C,{children:["customer","agent","subadmin","superadmin"].map(s=>e.jsx(S,{value:s,children:s},s))})]})]}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-950/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[e.jsx("strong",{children:"Warning:"})," Changing a user's role will affect their permissions and access to features."]})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(c,{variant:"outline",onClick:()=>{fe(!1),he(null),ye("")},children:"Cancel"}),e.jsx(c,{onClick:async()=>{if(xe&&ve){ge(xe._id);try{await r.promoteUser(xe._id,ve);const e=await r.getUsers({page:A,limit:10,search:a||void 0});e.success&&(le(e.data.users),de(e.data.pagination.totalPages),ne(e.data.pagination.totalUsers)),fe(!1),he(null),ye("")}catch(e){}finally{ge(null)}}},disabled:!ve||ve===xe.role||Ne===xe._id,children:Ne===xe._id?e.jsxs(e.Fragment,{children:[e.jsx(t,{className:"h-4 w-4 animate-spin mr-2"}),"Promoting..."]}):"Promote User"})]})]})]})})]})},ae=()=>{const l=a(),i=k(),[t,r]=s.useState("");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex "+(i?"flex-col gap-4":"flex-row justify-between items-start sm:items-center gap-4"),children:[e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold "+(i?"text-2xl":"text-3xl"),children:"Users"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"View and manage system users"})]}),e.jsxs(c,{onClick:()=>l("/admin/users/add"),className:i?"w-full":"",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Add User"]})]}),e.jsxs("div",{className:"bg-card rounded-lg border p-4 md:p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx(A,{placeholder:"Search users...",value:t,onChange:e=>r(e.target.value),className:""+(i?"w-full":"max-w-md")})}),e.jsx(se,{searchQuery:t})]})]})};export{ae as default};
