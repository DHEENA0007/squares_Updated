import{b as e,j as s,c as t,a as r,e as a,P as n,u as i,G as l,$ as o}from"./ui-DHQhougw.js";import{r as d,d as c,h as m}from"./router-Bi51YGN-.js";import{aD as u,aC as x,g as f,a0 as h,ax as p,a as v,e as j,H as g,I as b,S as y,r as w,s as N,v as S,w as P,f as C,O as k,az as D,K as E,B as R,h as _,av as F,aw as M}from"./index-D7KzNfIb.js";import{C as A}from"./checkbox-BfDnM2ZP.js";import{f as K}from"./favoriteService-Bg-5lSHI.js";import{S as T}from"./square-CR2wOjyr.js";import"./vendor-eVk5PToZ.js";var H=["PageUp","PageDown"],B=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],I={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},L="Slider",[z,V,$]=r(L),[U]=t(L,[$]),[O,G]=U(L),q=d.forwardRef((t,r)=>{const{name:n,min:i=0,max:l=100,step:o=1,orientation:c="horizontal",disabled:m=!1,minStepsBetweenThumbs:x=0,defaultValue:f=[i],value:h,onValueChange:p=()=>{},onValueCommit:v=()=>{},inverted:j=!1,form:g,...b}=t,y=d.useRef(new Set),w=d.useRef(0),N="horizontal"===c?W:J,[S=[],P]=e({prop:h,defaultProp:f,onChange:e=>{const s=[...y.current];s[w.current]?.focus(),p(e)}}),C=d.useRef(S);function k(e,s,{commit:t}={commit:!1}){const r=function(e){return(String(e).split(".")[1]||"").length}(o),a=function(e,s){const t=Math.pow(10,s);return Math.round(e*t)/t}(Math.round((e-i)/o)*o+i,r),n=u(a,[i,l]);P((e=[])=>{const r=function(e=[],s,t){const r=[...e];return r[t]=s,r.sort((e,s)=>e-s)}(e,n,s);if(function(e,s){if(s>0){const t=function(e){return e.slice(0,-1).map((s,t)=>e[t+1]-s)}(e);return Math.min(...t)>=s}return!0}(r,x*o)){w.current=r.indexOf(n);const s=String(r)!==String(e);return s&&t&&v(r),s?r:e}return e})}return s.jsx(O,{scope:t.__scopeSlider,name:n,disabled:m,min:i,max:l,valueIndexToChangeRef:w,thumbs:y.current,values:S,orientation:c,form:g,children:s.jsx(z.Provider,{scope:t.__scopeSlider,children:s.jsx(z.Slot,{scope:t.__scopeSlider,children:s.jsx(N,{"aria-disabled":m,"data-disabled":m?"":void 0,...b,ref:r,onPointerDown:a(b.onPointerDown,()=>{m||(C.current=S)}),min:i,max:l,inverted:j,onSlideStart:m?void 0:function(e){const s=function(e,s){if(1===e.length)return 0;const t=e.map(e=>Math.abs(e-s)),r=Math.min(...t);return t.indexOf(r)}(S,e);k(e,s)},onSlideMove:m?void 0:function(e){k(e,w.current)},onSlideEnd:m?void 0:function(){const e=C.current[w.current];S[w.current]!==e&&v(S)},onHomeKeyDown:()=>!m&&k(i,0,{commit:!0}),onEndKeyDown:()=>!m&&k(l,S.length-1,{commit:!0}),onStepKeyDown:({event:e,direction:s})=>{if(!m){const t=H.includes(e.key)||e.shiftKey&&B.includes(e.key)?10:1,r=w.current;k(S[r]+o*t*s,r,{commit:!0})}}})})})})});q.displayName=L;var[X,Y]=U(L,{startEdge:"left",endEdge:"right",size:"width",direction:1}),W=d.forwardRef((e,t)=>{const{min:r,max:a,dir:n,inverted:o,onSlideStart:c,onSlideMove:m,onSlideEnd:u,onStepKeyDown:x,...f}=e,[h,p]=d.useState(null),v=i(t,e=>p(e)),j=d.useRef(void 0),g=l(n),b="ltr"===g,y=b&&!o||!b&&o;function w(e){const s=j.current||h.getBoundingClientRect(),t=oe([0,s.width],y?[r,a]:[a,r]);return j.current=s,t(e-s.left)}return s.jsx(X,{scope:e.__scopeSlider,startEdge:y?"left":"right",endEdge:y?"right":"left",direction:y?1:-1,size:"width",children:s.jsx(Q,{dir:g,"data-orientation":"horizontal",...f,ref:v,style:{...f.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:e=>{const s=w(e.clientX);c?.(s)},onSlideMove:e=>{const s=w(e.clientX);m?.(s)},onSlideEnd:()=>{j.current=void 0,u?.()},onStepKeyDown:e=>{const s=I[y?"from-left":"from-right"].includes(e.key);x?.({event:e,direction:s?-1:1})}})})}),J=d.forwardRef((e,t)=>{const{min:r,max:a,inverted:n,onSlideStart:l,onSlideMove:o,onSlideEnd:c,onStepKeyDown:m,...u}=e,x=d.useRef(null),f=i(t,x),h=d.useRef(void 0),p=!n;function v(e){const s=h.current||x.current.getBoundingClientRect(),t=oe([0,s.height],p?[a,r]:[r,a]);return h.current=s,t(e-s.top)}return s.jsx(X,{scope:e.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1,children:s.jsx(Q,{"data-orientation":"vertical",...u,ref:f,style:{...u.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:e=>{const s=v(e.clientY);l?.(s)},onSlideMove:e=>{const s=v(e.clientY);o?.(s)},onSlideEnd:()=>{h.current=void 0,c?.()},onStepKeyDown:e=>{const s=I[p?"from-bottom":"from-top"].includes(e.key);m?.({event:e,direction:s?-1:1})}})})}),Q=d.forwardRef((e,t)=>{const{__scopeSlider:r,onSlideStart:i,onSlideMove:l,onSlideEnd:o,onHomeKeyDown:d,onEndKeyDown:c,onStepKeyDown:m,...u}=e,x=G(L,r);return s.jsx(n.span,{...u,ref:t,onKeyDown:a(e.onKeyDown,e=>{"Home"===e.key?(d(e),e.preventDefault()):"End"===e.key?(c(e),e.preventDefault()):H.concat(B).includes(e.key)&&(m(e),e.preventDefault())}),onPointerDown:a(e.onPointerDown,e=>{const s=e.target;s.setPointerCapture(e.pointerId),e.preventDefault(),x.thumbs.has(s)?s.focus():i(e)}),onPointerMove:a(e.onPointerMove,e=>{e.target.hasPointerCapture(e.pointerId)&&l(e)}),onPointerUp:a(e.onPointerUp,e=>{const s=e.target;s.hasPointerCapture(e.pointerId)&&(s.releasePointerCapture(e.pointerId),o(e))})})}),Z="SliderTrack",ee=d.forwardRef((e,t)=>{const{__scopeSlider:r,...a}=e,i=G(Z,r);return s.jsx(n.span,{"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation,...a,ref:t})});ee.displayName=Z;var se="SliderRange",te=d.forwardRef((e,t)=>{const{__scopeSlider:r,...a}=e,l=G(se,r),o=Y(se,r),c=d.useRef(null),m=i(t,c),u=l.values.length,x=l.values.map(e=>le(e,l.min,l.max)),f=u>1?Math.min(...x):0,h=100-Math.max(...x);return s.jsx(n.span,{"data-orientation":l.orientation,"data-disabled":l.disabled?"":void 0,...a,ref:m,style:{...e.style,[o.startEdge]:f+"%",[o.endEdge]:h+"%"}})});te.displayName=se;var re="SliderThumb",ae=d.forwardRef((e,t)=>{const r=V(e.__scopeSlider),[a,n]=d.useState(null),l=i(t,e=>n(e)),o=d.useMemo(()=>a?r().findIndex(e=>e.ref.current===a):-1,[r,a]);return s.jsx(ne,{...e,ref:l,index:o})}),ne=d.forwardRef((e,t)=>{const{__scopeSlider:r,index:l,name:c,...m}=e,u=G(re,r),x=Y(re,r),[f,h]=d.useState(null),p=i(t,e=>h(e)),v=!f||(u.form||!!f.closest("form")),j=o(f),g=u.values[l],b=void 0===g?0:le(g,u.min,u.max),y=function(e,s){return s>2?`Value ${e+1} of ${s}`:2===s?["Minimum","Maximum"][e]:void 0}(l,u.values.length),w=j?.[x.size],N=w?function(e,s,t){const r=e/2,a=oe([0,50],[0,r]);return(r-a(s)*t)*t}(w,b,x.direction):0;return d.useEffect(()=>{if(f)return u.thumbs.add(f),()=>{u.thumbs.delete(f)}},[f,u.thumbs]),s.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[x.startEdge]:`calc(${b}% + ${N}px)`},children:[s.jsx(z.ItemSlot,{scope:e.__scopeSlider,children:s.jsx(n.span,{role:"slider","aria-label":e["aria-label"]||y,"aria-valuemin":u.min,"aria-valuenow":g,"aria-valuemax":u.max,"aria-orientation":u.orientation,"data-orientation":u.orientation,"data-disabled":u.disabled?"":void 0,tabIndex:u.disabled?void 0:0,...m,ref:p,style:void 0===g?{display:"none"}:e.style,onFocus:a(e.onFocus,()=>{u.valueIndexToChangeRef.current=l})})}),v&&s.jsx(ie,{name:c??(u.name?u.name+(u.values.length>1?"[]":""):void 0),form:u.form,value:g},l)]})});ae.displayName=re;var ie=d.forwardRef(({__scopeSlider:e,value:t,...r},a)=>{const l=d.useRef(null),o=i(l,a),c=x(t);return d.useEffect(()=>{const e=l.current;if(!e)return;const s=window.HTMLInputElement.prototype,r=Object.getOwnPropertyDescriptor(s,"value").set;if(c!==t&&r){const s=new Event("input",{bubbles:!0});r.call(e,t),e.dispatchEvent(s)}},[c,t]),s.jsx(n.input,{style:{display:"none"},...r,ref:o,defaultValue:t})});function le(e,s,t){return u(100/(t-s)*(e-s),[0,100])}function oe(e,s){return t=>{if(e[0]===e[1]||s[0]===s[1])return s[0];const r=(s[1]-s[0])/(e[1]-e[0]);return s[0]+r*(t-e[0])}}ie.displayName="RadioBubbleInput";var de=q,ce=ee,me=te,ue=ae;const xe=d.forwardRef(({className:e,...t},r)=>s.jsxs(de,{ref:r,className:f("relative flex w-full touch-none select-none items-center",e),...t,children:[s.jsx(ce,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:s.jsx(me,{className:"absolute h-full bg-primary"})}),s.jsx(ue,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));xe.displayName=de.displayName;const fe=()=>{const e=c(),{toast:t}=h(),[r]=m(),[a,n]=d.useState([]),[i,l]=d.useState(!0),[o,u]=d.useState(""),[x,f]=d.useState("all"),[H,B]=d.useState("all"),[I,L]=d.useState("any"),[z,V]=d.useState([0,2e7]),[$,U]=d.useState([]),[O,G]=d.useState(1),[q,X]=d.useState(1),[Y,W]=d.useState(new Set);d.useEffect(()=>{const e=r.get("q"),s=r.get("listingType"),t=r.get("propertyType");e&&u(e),s&&"all"!==s&&f(s),t&&"all"!==t&&B(t),G(1)},[r]),d.useEffect(()=>{J()},[o,x,H,I,z,$,O]);const J=async()=>{l(!0);try{const e={page:O,limit:12};o.trim()&&(e.search=o),"all"!==x&&(e.listingType=x),"all"!==H&&(e.propertyType=H),"any"!==I&&(e.bedrooms=I),z[0]>0&&(e.minPrice=z[0]),z[1]<2e7&&(e.maxPrice=z[1]),$.length>0&&(e.amenities=$);const s=await p.getProperties(e);s.success&&(n(s.data.properties),X(s.data.pagination.totalPages))}catch(e){t({title:"Error",description:"Failed to load properties",variant:"destructive"})}finally{l(!1)}};d.useEffect(()=>{Q()},[]);const Q=async()=>{try{const e=await K.getFavorites();if(e.success){const s=new Set(e.data.favorites.map(e=>e.property?._id).filter(Boolean));W(s)}}catch(e){}},Z=()=>{u(""),f("all"),B("all"),L("any"),V([0,2e7]),U([]),G(1)},ee=e=>e>=1e7?`₹${(e/1e7).toFixed(2)} Cr`:e>=1e5?`₹${(e/1e5).toFixed(2)} L`:`₹${e.toLocaleString()}`;return s.jsxs("div",{className:"min-h-screen",children:[s.jsx("div",{className:"bg-gradient-to-r from-primary/10 to-primary/5 border-b",children:s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Search Properties"}),s.jsx("p",{className:"text-muted-foreground",children:"Find your dream property from our verified listings"})]})}),s.jsx("div",{className:"container mx-auto px-4 py-6",children:s.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[s.jsx("aside",{className:"lg:w-80 flex-shrink-0",children:s.jsx(v,{className:"sticky top-20",children:s.jsxs(j,{className:"p-6",children:[s.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Filters"}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Search"}),s.jsxs("div",{className:"relative",children:[s.jsx(g,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),s.jsx(b,{placeholder:"Location, property name...",value:o,onChange:e=>u(e.target.value),className:"pl-10"})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Listing Type"}),s.jsxs(y,{value:x,onValueChange:f,children:[s.jsx(w,{children:s.jsx(N,{placeholder:"Type"})}),s.jsxs(S,{children:[s.jsx(P,{value:"all",children:"All Types"}),s.jsx(P,{value:"sale",children:"For Sale"}),s.jsx(P,{value:"rent",children:"For Rent"}),s.jsx(P,{value:"lease",children:"For Lease"})]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Property Type"}),s.jsxs(y,{value:H,onValueChange:B,children:[s.jsx(w,{children:s.jsx(N,{placeholder:"Property"})}),s.jsxs(S,{children:[s.jsx(P,{value:"all",children:"All Properties"}),s.jsx(P,{value:"apartment",children:"Apartment"}),s.jsx(P,{value:"villa",children:"Villa"}),s.jsx(P,{value:"house",children:"House"}),s.jsx(P,{value:"plot",children:"Plot"}),s.jsx(P,{value:"land",children:"Land"}),s.jsx(P,{value:"commercial",children:"Commercial"}),s.jsx(P,{value:"office",children:"Office"}),s.jsx(P,{value:"pg",children:"PG"})]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Bedrooms"}),s.jsxs(y,{value:I,onValueChange:L,children:[s.jsx(w,{children:s.jsx(N,{placeholder:"BHK"})}),s.jsxs(S,{children:[s.jsx(P,{value:"any",children:"Any BHK"}),s.jsx(P,{value:"1",children:"1 BHK"}),s.jsx(P,{value:"2",children:"2 BHK"}),s.jsx(P,{value:"3",children:"3 BHK"}),s.jsx(P,{value:"4",children:"4+ BHK"})]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Price Range"}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(xe,{value:z,onValueChange:V,min:0,max:2e7,step:1e5,className:"w-full"}),s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-muted-foreground text-xs",children:"Min Price"}),s.jsx("span",{className:"font-semibold text-primary",children:ee(z[0])})]}),s.jsxs("div",{className:"flex flex-col items-end",children:[s.jsx("span",{className:"text-muted-foreground text-xs",children:"Max Price"}),s.jsx("span",{className:"font-semibold text-primary",children:ee(z[1])})]})]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Amenities"}),s.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2 border rounded-md p-3",children:["Swimming Pool","Gym/Fitness Center","Parking","Security","Garden/Park","Playground","Clubhouse","Power Backup","Elevator","WiFi","CCTV Surveillance","Water Supply","Fire Safety"].map(e=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(A,{id:e,checked:$.includes(e),onCheckedChange:s=>{U(s?[...$,e]:$.filter(s=>s!==e))}}),s.jsx("label",{htmlFor:e,className:"text-sm font-normal cursor-pointer leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e})]},e))}),$.length>0&&s.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[$.length," selected"]})]}),s.jsx(C,{variant:"outline",onClick:Z,className:"w-full",children:"Reset Filters"})]})})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Available Properties"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:i?"Loading...":`${a.length} properties found`})]}),i?s.jsx("div",{className:"flex items-center justify-center py-20",children:s.jsx(k,{className:"h-8 w-8 animate-spin text-primary"})}):0===a.length?s.jsx(v,{children:s.jsxs(j,{className:"p-12 text-center",children:[s.jsx(D,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No properties found"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"Try adjusting your filters or search criteria"}),s.jsx(C,{onClick:Z,children:"Clear Filters"})]})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:a.map(r=>s.jsxs(v,{className:"overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",children:[s.jsxs("div",{className:"relative h-48 bg-muted",onClick:()=>e(`/property/${r._id}`),children:[r.images&&r.images.length>0?s.jsx("img",{src:"string"==typeof r.images[0]?r.images[0]:r.images[0]?.url,alt:r.title,className:"w-full h-full object-cover",onError:e=>{e.target.src="/placeholder-property.jpg"}}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx(D,{className:"h-12 w-12 text-muted-foreground"})}),s.jsx(C,{size:"icon",variant:"secondary",className:"absolute top-2 right-2",onClick:e=>{e.stopPropagation(),(async e=>{try{Y.has(e)?(await K.removeFromFavorites(e),W(s=>{const t=new Set(s);return t.delete(e),t}),t({title:"Removed from favorites",description:"Property removed from your favorites"})):(await K.addToFavorites(e),W(s=>new Set(s).add(e)),t({title:"Added to favorites",description:"Property added to your favorites"}))}catch(s){t({title:"Error",description:"Failed to update favorite",variant:"destructive"})}})(r._id)},children:s.jsx(E,{className:"h-4 w-4 "+(Y.has(r._id)?"fill-red-500 text-red-500":"")})}),s.jsx(R,{className:"absolute top-2 left-2 capitalize",children:r.listingType})]}),s.jsxs(j,{className:"p-4",onClick:()=>e(`/customer/property/${r._id}`),children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("h3",{className:"font-semibold text-lg line-clamp-1",children:r.title}),s.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mt-1",children:[s.jsx(_,{className:"h-3 w-3 mr-1"}),s.jsxs("span",{className:"line-clamp-1",children:[r.address.city,", ",r.address.state]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"text-2xl font-bold text-primary",children:ee(r.price)}),"rent"===r.listingType&&s.jsx("span",{className:"text-xs text-muted-foreground",children:"/month"})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[r.bedrooms>0&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(F,{className:"h-4 w-4"}),s.jsx("span",{children:r.bedrooms})]}),r.bathrooms>0&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(M,{className:"h-4 w-4"}),s.jsx("span",{children:r.bathrooms})]}),r.area?.builtUp&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(T,{className:"h-4 w-4"}),s.jsxs("span",{children:[r.area.builtUp," sqft"]})]})]}),s.jsx("div",{className:"mt-3 pt-3 border-t",children:s.jsx(R,{variant:"outline",className:"capitalize",children:r.type})})]})]},r._id))}),q>1&&s.jsxs("div",{className:"flex justify-center gap-2 mt-8",children:[s.jsx(C,{variant:"outline",disabled:1===O,onClick:()=>G(e=>e-1),children:"Previous"}),s.jsx("div",{className:"flex items-center gap-2",children:Array.from({length:q},(e,s)=>s+1).map(e=>s.jsx(C,{variant:O===e?"default":"outline",onClick:()=>G(e),className:"w-10",children:e},e))}),s.jsx(C,{variant:"outline",disabled:O===q,onClick:()=>G(e=>e+1),children:"Next"})]})]})]})]})})]})};export{fe as default};
